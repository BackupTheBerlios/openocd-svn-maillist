<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-svn] r2357 - in trunk/src: flash helper jtag jtag/rlink	jtag/zy1000 server target xsvf
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2357%20-%20in%20trunk/src%3A%20flash%20helper%20jtag%20jtag/rlink%0A%09jtag/zy1000%20server%20target%20xsvf&In-Reply-To=%3C200906232236.n5NMa4fm011277%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001140.html">
   <LINK REL="Next"  HREF="001142.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-svn] r2357 - in trunk/src: flash helper jtag jtag/rlink	jtag/zy1000 server target xsvf</H1>
    <B>zwelch at mail.berlios.de</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2357%20-%20in%20trunk/src%3A%20flash%20helper%20jtag%20jtag/rlink%0A%09jtag/zy1000%20server%20target%20xsvf&In-Reply-To=%3C200906232236.n5NMa4fm011277%40sheep.berlios.de%3E"
       TITLE="[Openocd-svn] r2357 - in trunk/src: flash helper jtag jtag/rlink	jtag/zy1000 server target xsvf">zwelch at mail.berlios.de
       </A><BR>
    <I>Wed Jun 24 00:36:04 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001140.html">[Openocd-svn] r2356 - trunk/src/helper
</A></li>
        <LI>Next message: <A HREF="001142.html">[Openocd-svn] r2358 - in trunk: src/flash src/helper src/jtag	src/jtag/rlink src/server src/target src/xsvf	testing/examples/PIC32 testing/examples/ledtest-imx27ads	testing/examples/ledtest-imx31pdk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1141">[ date ]</a>
              <a href="thread.html#1141">[ thread ]</a>
              <a href="subject.html#1141">[ subject ]</a>
              <a href="author.html#1141">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zwelch
Date: 2009-06-24 00:35:09 +0200 (Wed, 24 Jun 2009)
New Revision: 2357

Modified:
   trunk/src/flash/at91sam7.c
   trunk/src/flash/cfi.c
   trunk/src/flash/ecos.c
   trunk/src/flash/flash.c
   trunk/src/flash/lpc2000.c
   trunk/src/flash/lpc288x.c
   trunk/src/flash/mflash.c
   trunk/src/flash/pic32mx.c
   trunk/src/flash/stellaris.c
   trunk/src/flash/stm32x.c
   trunk/src/flash/str9x.c
   trunk/src/flash/str9xpec.c
   trunk/src/helper/command.c
   trunk/src/helper/fileio.c
   trunk/src/helper/ioutil.c
   trunk/src/helper/jim.c
   trunk/src/helper/jim.h
   trunk/src/helper/log.c
   trunk/src/helper/options.c
   trunk/src/jtag/arm-jtag-ew.c
   trunk/src/jtag/bitbang.c
   trunk/src/jtag/core.c
   trunk/src/jtag/dummy.c
   trunk/src/jtag/interface.c
   trunk/src/jtag/rlink/rlink.c
   trunk/src/jtag/tcl.c
   trunk/src/jtag/usbprog.c
   trunk/src/jtag/vsllink.c
   trunk/src/jtag/zy1000/zy1000.c
   trunk/src/server/gdb_server.c
   trunk/src/target/arm720t.c
   trunk/src/target/arm7_9_common.c
   trunk/src/target/arm7tdmi.c
   trunk/src/target/arm_jtag.c
   trunk/src/target/arm_simulator.c
   trunk/src/target/armv7m.c
   trunk/src/target/cortex_m3.c
   trunk/src/target/feroceon.c
   trunk/src/target/image.c
   trunk/src/target/mips32_pracc.c
   trunk/src/target/mips_ejtag.c
   trunk/src/target/mips_m4k.c
   trunk/src/target/oocd_trace.c
   trunk/src/target/target.c
   trunk/src/target/xscale.c
   trunk/src/xsvf/xsvf.c
Log:
- Replace 'if(' with 'if ('.


Modified: trunk/src/flash/at91sam7.c
===================================================================
--- trunk/src/flash/at91sam7.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/at91sam7.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -890,7 +890,7 @@
 	at91sam7_read_clock_info(bank);
 	at91sam7_set_flash_mode(bank, FMR_TIMING_FLASH);
 
-	if(erase_all)
+	if (erase_all)
 	{
 		if (at91sam7_flash_command(bank, EA, 0) != ERROR_OK) 
 		{
@@ -1027,7 +1027,7 @@
 		/* Write one block to the PageWriteBuffer */
 		buffer_pos = (pagen-first_page)*dst_min_alignment;
 		wcount = CEIL(count,4);
-		if((retval = target_write_memory(target, bank-&gt;base+pagen*dst_min_alignment, 4, wcount, buffer+buffer_pos)) != ERROR_OK)
+		if ((retval = target_write_memory(target, bank-&gt;base+pagen*dst_min_alignment, 4, wcount, buffer+buffer_pos)) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/flash/cfi.c
===================================================================
--- trunk/src/flash/cfi.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/cfi.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -114,7 +114,7 @@
 {
 	cfi_flash_bank_t *cfi_info = bank-&gt;driver_priv;
 
-	if(cfi_info-&gt;x16_as_x8) offset*=2;
+	if (cfi_info-&gt;x16_as_x8) offset*=2;
 
 	/* while the sector list isn't built, only accesses to sector 0 work */
 	if (sector == 0)
@@ -209,7 +209,7 @@
 	cfi_flash_bank_t *cfi_info = bank-&gt;driver_priv;
 	uint8_t data[CFI_MAX_BUS_WIDTH * 2];
 
-	if(cfi_info-&gt;x16_as_x8)
+	if (cfi_info-&gt;x16_as_x8)
 	{
 		uint8_t i;
 		for(i=0;i&lt;2;i++)
@@ -231,7 +231,7 @@
 	cfi_flash_bank_t *cfi_info = bank-&gt;driver_priv;
 	uint8_t data[CFI_MAX_BUS_WIDTH * 4];
 
-	if(cfi_info-&gt;x16_as_x8)
+	if (cfi_info-&gt;x16_as_x8)
 	{
 		uint8_t i;
 		for(i=0;i&lt;4;i++)
@@ -356,12 +356,12 @@
 	if ((pri_ext-&gt;pri[0] != 'P') || (pri_ext-&gt;pri[1] != 'R') || (pri_ext-&gt;pri[2] != 'I'))
 	{
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 		cfi_command(bank, 0xff, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -422,7 +422,7 @@
 	if ((pri_ext-&gt;pri[0] != 'P') || (pri_ext-&gt;pri[1] != 'R') || (pri_ext-&gt;pri[2] != 'I'))
 	{
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -495,7 +495,7 @@
 	if ((atmel_pri_ext.pri[0] != 'P') || (atmel_pri_ext.pri[1] != 'R') || (atmel_pri_ext.pri[2] != 'I'))
 	{
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -691,13 +691,13 @@
 	for (i = first; i &lt;= last; i++)
 	{
 		cfi_command(bank, 0x20, command);
-		if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0xd0, command);
-		if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -707,7 +707,7 @@
 		else
 		{
 			cfi_command(bank, 0xff, command);
-			if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -734,37 +734,37 @@
 	for (i = first; i &lt;= last; i++)
 	{
 		cfi_command(bank, 0xaa, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0x55, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0x80, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0xaa, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0x55, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 
 		cfi_command(bank, 0x30, command);
-		if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -774,7 +774,7 @@
 		else
 		{
 			cfi_command(bank, 0xf0, command);
-			if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -845,7 +845,7 @@
 	{
 		cfi_command(bank, 0x60, command);
 		LOG_DEBUG(&quot;address: 0x%4.4&quot; PRIx32 &quot;, command: 0x%4.4&quot; PRIx32, flash_address(bank, i, 0x0), target_buffer_get_u32(target, command));
-		if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -853,7 +853,7 @@
 		{
 			cfi_command(bank, 0x01, command);
 			LOG_DEBUG(&quot;address: 0x%4.4&quot; PRIx32 &quot;, command: 0x%4.4&quot; PRIx32 , flash_address(bank, i, 0x0), target_buffer_get_u32(target, command));
-			if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -863,7 +863,7 @@
 		{
 			cfi_command(bank, 0xd0, command);
 			LOG_DEBUG(&quot;address: 0x%4.4&quot; PRIx32 &quot;, command: 0x%4.4&quot; PRIx32, flash_address(bank, i, 0x0), target_buffer_get_u32(target, command));
-			if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -881,7 +881,7 @@
 			uint8_t block_status;
 			/* read block lock bit, to verify status */
 			cfi_command(bank, 0x90, command);
-			if((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -891,7 +891,7 @@
 			{
 				LOG_ERROR(&quot;couldn't change block lock status (set = %i, block_status = 0x%2.2x)&quot;, set, block_status);
 				cfi_command(bank, 0x70, command);
-				if((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+				if ((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 				{
 					return retval;
 				}
@@ -920,13 +920,13 @@
 				cfi_intel_clear_status_register(bank);
 
 				cfi_command(bank, 0x60, command);
-				if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+				if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 				{
 					return retval;
 				}
 
 				cfi_command(bank, 0x01, command);
-				if((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+				if ((retval = target_write_memory(target, flash_address(bank, i, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 				{
 					return retval;
 				}
@@ -1214,7 +1214,7 @@
 		uint32_t thisrun_count = (count &gt; buffer_size) ? buffer_size : count;
 		uint32_t wsm_error;
 
-		if((retval = target_write_buffer(target, source-&gt;address, thisrun_count, buffer)) != ERROR_OK)
+		if ((retval = target_write_buffer(target, source-&gt;address, thisrun_count, buffer)) != ERROR_OK)
 		{
 			goto cleanup;
 		}
@@ -1461,7 +1461,7 @@
 		}
 
 		/* write algorithm code to working area */
-		if((retval = target_write_buffer(target, cfi_info-&gt;write_algorithm-&gt;address,
+		if ((retval = target_write_buffer(target, cfi_info-&gt;write_algorithm-&gt;address,
 		                    target_code_size, target_code)) != ERROR_OK)
 		{
 			free(target_code);
@@ -1557,12 +1557,12 @@
 
 	cfi_intel_clear_status_register(bank);
 	cfi_command(bank, 0x40, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, word)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -1570,7 +1570,7 @@
 	if (cfi_intel_wait_status_busy(bank, 1000 * (1 &lt;&lt; cfi_info-&gt;word_write_timeout_max)) != 0x80)
 	{
 		cfi_command(bank, 0xff, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1626,14 +1626,14 @@
 
 	/* Initiate buffer operation _*/
 	cfi_command(bank, 0xE8, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 	if (cfi_intel_wait_status_busy(bank, 1000 * (1 &lt;&lt; cfi_info-&gt;buf_write_timeout_max)) != 0x80)
 	{
 		cfi_command(bank, 0xff, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1644,26 +1644,26 @@
 
 	/* Write buffer wordcount-1 and data words */
 	cfi_command(bank, bufferwsize-1, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, bufferwsize, word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, bufferwsize, word)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	/* Commit write operation */
 	cfi_command(bank, 0xd0, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 	if (cfi_intel_wait_status_busy(bank, 1000 * (1 &lt;&lt; cfi_info-&gt;buf_write_timeout_max)) != 0x80)
 	{
 		cfi_command(bank, 0xff, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1684,24 +1684,24 @@
 	uint8_t command[8];
 
 	cfi_command(bank, 0xaa, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	cfi_command(bank, 0x55, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	cfi_command(bank, 0xa0, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, word)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -1709,7 +1709,7 @@
 	if (cfi_spansion_wait_status_busy(bank, 1000 * (1 &lt;&lt; cfi_info-&gt;word_write_timeout_max)) != ERROR_OK)
 	{
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1761,39 +1761,39 @@
 
 	// Unlock
 	cfi_command(bank, 0xaa, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	cfi_command(bank, 0x55, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	// Buffer load command
 	cfi_command(bank, 0x25, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	/* Write buffer wordcount-1 and data words */
 	cfi_command(bank, bufferwsize-1, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, bufferwsize, word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, bufferwsize, word)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	/* Commit write operation */
 	cfi_command(bank, 0x29, command);
-	if((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, address, bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -1801,7 +1801,7 @@
 	if (cfi_spansion_wait_status_busy(bank, 1000 * (1 &lt;&lt; cfi_info-&gt;word_write_timeout_max)) != ERROR_OK)
 	{
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1893,7 +1893,7 @@
 		for (i = 0; i &lt; align; ++i, ++copy_p)
 		{
 			uint8_t byte;
-			if((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
+			if ((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -1912,7 +1912,7 @@
 		for (; (count == 0) &amp;&amp; (i &lt; bank-&gt;bus_width); ++i, ++copy_p)
 		{
 			uint8_t byte;
-			if((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
+			if ((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -2016,12 +2016,12 @@
 
 	/* return to read array mode, so we can read from flash again for padding */
 	cfi_command(bank, 0xf0, current_word);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
 	{
 		return retval;
 	}
 	cfi_command(bank, 0xff, current_word);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -2043,7 +2043,7 @@
 		for (; i &lt; bank-&gt;bus_width; ++i, ++copy_p)
 		{
 			uint8_t byte;
-			if((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
+			if ((retval = target_read_memory(target, copy_p, 1, 1, &amp;byte)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -2056,7 +2056,7 @@
 
 	/* return to read array mode */
 	cfi_command(bank, 0xf0, current_word);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, current_word)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -2137,17 +2137,17 @@
 
 	/* switch to read identifier codes mode (&quot;AUTOSELECT&quot;) */
 	cfi_command(bank, 0xaa, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 	cfi_command(bank, 0x55, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 	cfi_command(bank, 0x90, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -2155,11 +2155,11 @@
 	if (bank-&gt;chip_width == 1)
 	{
 		uint8_t manufacturer, device_id;
-		if((retval = target_read_u8(target, flash_address(bank, 0, 0x00), &amp;manufacturer)) != ERROR_OK)
+		if ((retval = target_read_u8(target, flash_address(bank, 0, 0x00), &amp;manufacturer)) != ERROR_OK)
 		{
 			return retval;
 		}
-		if((retval = target_read_u8(target, flash_address(bank, 0, 0x01), &amp;device_id)) != ERROR_OK)
+		if ((retval = target_read_u8(target, flash_address(bank, 0, 0x01), &amp;device_id)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -2168,11 +2168,11 @@
 	}
 	else if (bank-&gt;chip_width == 2)
 	{
-		if((retval = target_read_u16(target, flash_address(bank, 0, 0x00), &amp;cfi_info-&gt;manufacturer)) != ERROR_OK)
+		if ((retval = target_read_u16(target, flash_address(bank, 0, 0x00), &amp;cfi_info-&gt;manufacturer)) != ERROR_OK)
 		{
 			return retval;
 		}
-		if((retval = target_read_u16(target, flash_address(bank, 0, 0x02), &amp;cfi_info-&gt;device_id)) != ERROR_OK)
+		if ((retval = target_read_u16(target, flash_address(bank, 0, 0x02), &amp;cfi_info-&gt;device_id)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -2181,12 +2181,12 @@
 	LOG_INFO(&quot;Flash Manufacturer/Device: 0x%04x 0x%04x&quot;, cfi_info-&gt;manufacturer, cfi_info-&gt;device_id);
 	/* switch back to read array mode */
 	cfi_command(bank, 0xf0, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x00), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x00), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 	cfi_command(bank, 0xff, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x00), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x00), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -2207,7 +2207,7 @@
 		 * SST flashes clearly violate this, and we will consider them incompatbile for now
 		 */
 		cfi_command(bank, 0x98, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -2221,12 +2221,12 @@
 		if ((cfi_info-&gt;qry[0] != 'Q') || (cfi_info-&gt;qry[1] != 'R') || (cfi_info-&gt;qry[2] != 'Y'))
 		{
 			cfi_command(bank, 0xf0, command);
-			if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
 			cfi_command(bank, 0xff, command);
-			if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+			if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -2314,12 +2314,12 @@
 		 * we use both reset commands, as some Intel flashes fail to recognize the 0xF0 command
 		 */
 		cfi_command(bank, 0xf0, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
 		cfi_command(bank, 0xff, command);
-		if((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+		if ((retval = target_write_memory(target, flash_address(bank, 0, 0x0), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -2417,7 +2417,7 @@
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	cfi_command(bank, 0x90, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, 0x55), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -2446,19 +2446,19 @@
 	int i;
 
 	cfi_command(bank, 0xaa, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	cfi_command(bank, 0x55, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock2), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}
 
 	cfi_command(bank, 0x90, command);
-	if((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
+	if ((retval = target_write_memory(target, flash_address(bank, 0, pri_ext-&gt;_unlock1), bank-&gt;bus_width, 1, command)) != ERROR_OK)
 	{
 		return retval;
 	}

Modified: trunk/src/flash/ecos.c
===================================================================
--- trunk/src/flash/ecos.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/ecos.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -139,7 +139,7 @@
 	}
 
 	info = malloc(sizeof(ecosflash_flash_bank_t));
-	if(info == NULL)
+	if (info == NULL)
 	{
 		LOG_ERROR(&quot;no memory for flash bank info&quot;);
 		exit(-1);

Modified: trunk/src/flash/flash.c
===================================================================
--- trunk/src/flash/flash.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/flash.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -748,7 +748,7 @@
 	pattern	= strtoul(args[1], NULL, 0);
 	count 	= strtoul(args[2], NULL, 0);
 
-	if(count == 0)
+	if (count == 0)
 		return ERROR_OK;
 
 	switch(cmd[4])
@@ -796,7 +796,7 @@
 		cur_size = MIN( (count*wordsize - wrote), sizeof(chunk) );
 		flash_bank_t *bank;
 		bank = get_flash_bank_by_addr(target, address);
-		if(bank == NULL)
+		if (bank == NULL)
 		{
 			return ERROR_FAIL;
 		}
@@ -826,7 +826,7 @@
 		return retval;
 	}
 
-	if(err == ERROR_OK)
+	if (err == ERROR_OK)
 	{
 		float speed;
 		speed=wrote / 1024.0;
@@ -994,7 +994,7 @@
 		}
 	}
 
-	if( first == -1 || last == -1 )
+	if ( first == -1 || last == -1 )
 		return ERROR_OK;
 
 	return flash_driver_erase(c, first, last);

Modified: trunk/src/flash/lpc2000.c
===================================================================
--- trunk/src/flash/lpc2000.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/lpc2000.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -258,7 +258,7 @@
 		/* write IAP code to working area */
 		target_buffer_set_u32(target, jump_gate, ARMV4_5_BX(12));
 		target_buffer_set_u32(target, jump_gate + 4, ARMV4_5_B(0xfffffe, 0));
-		if((retval = target_write_memory(target, lpc2000_info-&gt;iap_working_area-&gt;address, 4, 2, jump_gate)) != ERROR_OK)
+		if ((retval = target_write_memory(target, lpc2000_info-&gt;iap_working_area-&gt;address, 4, 2, jump_gate)) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/flash/lpc288x.c
===================================================================
--- trunk/src/flash/lpc288x.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/lpc288x.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -129,7 +129,7 @@
 		target_read_u32(target, F_STAT, &amp;status);
 	}while (((status &amp; FS_DONE) == 0) &amp;&amp; timeout);
 
-	if(timeout == 0)
+	if (timeout == 0)
 	{
 		LOG_DEBUG(&quot;Timedout!&quot;);
 		return ERROR_FLASH_OPERATION_FAILED;

Modified: trunk/src/flash/mflash.c
===================================================================
--- trunk/src/flash/mflash.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/mflash.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -298,7 +298,7 @@
 	if ((ret = target_read_u8(target, mg_task_reg + MG_REG_DRV_CTRL, &amp;value)) != ERROR_OK)
 		return ret;
 
-	if(on) {
+	if (on) {
 		value |= (mg_io_rbit_devc_srst);
 	} else {
 		value &amp;= ~mg_io_rbit_devc_srst;
@@ -892,7 +892,7 @@
 	int i, NO;
 
 	for (i = 0, NO = 1; i &lt; 2; ++i, output_div &gt;&gt;= 1)
-		if(output_div &amp; 1)
+		if (output_div &amp; 1)
 			NO = NO &lt;&lt; 1;
 
 	return NO;

Modified: trunk/src/flash/pic32mx.c
===================================================================
--- trunk/src/flash/pic32mx.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/pic32mx.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -151,7 +151,7 @@
 		LOG_DEBUG(&quot;status: 0x%&quot; PRIx32, status );
 		alive_sleep(1);
 	}
-	if(timeout &lt;= 0)
+	if (timeout &lt;= 0)
 		LOG_DEBUG(&quot;timeout: status: 0x%&quot; PRIx32, status );
 
 	return status;
@@ -194,11 +194,11 @@
 	}
 
 	target_read_u32(target, PIC32MX_DEVCFG0, &amp;devcfg0);
-	if((devcfg0 &amp; (1&lt;&lt;28)) == 0) /* code protect bit */
+	if ((devcfg0 &amp; (1&lt;&lt;28)) == 0) /* code protect bit */
 		num_pages = 0xffff;  /* All pages protected */
-	else if(bank-&gt;base == PIC32MX_KSEG1_BOOT_FLASH)
+	else if (bank-&gt;base == PIC32MX_KSEG1_BOOT_FLASH)
 	{
-		if(devcfg0 &amp; (1&lt;&lt;24))
+		if (devcfg0 &amp; (1&lt;&lt;24))
 			num_pages = 0;       /* All pages unprotected */
 		else
 			num_pages = 0xffff;  /* All pages protected */
@@ -229,25 +229,25 @@
 	{
 		LOG_DEBUG(&quot;Erasing entire program flash&quot;);
 		status = pic32mx_nvm_exec(bank, NVMCON_OP_PFM_ERASE, 50);
-		if( status &amp; NVMCON_NVMERR )
+		if ( status &amp; NVMCON_NVMERR )
 			return ERROR_FLASH_OPERATION_FAILED;
-		if( status &amp; NVMCON_LVDERR )
+		if ( status &amp; NVMCON_LVDERR )
 			return ERROR_FLASH_OPERATION_FAILED;
 		return ERROR_OK;
 	}
 
 	for (i = first; i &lt;= last; i++)
 	{
-		if(bank-&gt;base &gt;= PIC32MX_KSEG1_PGM_FLASH)
+		if (bank-&gt;base &gt;= PIC32MX_KSEG1_PGM_FLASH)
 			target_write_u32(target, PIC32MX_NVMADDR, KS1Virt2Phys(bank-&gt;base + bank-&gt;sectors[i].offset));
 		else
 			target_write_u32(target, PIC32MX_NVMADDR, KS0Virt2Phys(bank-&gt;base + bank-&gt;sectors[i].offset));
 
 		status = pic32mx_nvm_exec(bank, NVMCON_OP_PAGE_ERASE, 10);
 
-		if( status &amp; NVMCON_NVMERR )
+		if ( status &amp; NVMCON_NVMERR )
 			return ERROR_FLASH_OPERATION_FAILED;
-		if( status &amp; NVMCON_LVDERR )
+		if ( status &amp; NVMCON_LVDERR )
 			return ERROR_FLASH_OPERATION_FAILED;
 		bank-&gt;sectors[i].is_erased = 1;
 	}
@@ -313,7 +313,7 @@
 			reg = (i / pic32mx_info-&gt;ppage_size) / 8;
 			bit = (i / pic32mx_info-&gt;ppage_size) - (reg * 8);
 
-			if( set )
+			if ( set )
 				prot_reg[reg] &amp;= ~(1 &lt;&lt; bit);
 			else
 				prot_reg[reg] |= (1 &lt;&lt; bit);
@@ -327,7 +327,7 @@
 			reg = (i / pic32mx_info-&gt;ppage_size) / 8;
 			bit = (i / pic32mx_info-&gt;ppage_size) - (reg * 8);
 
-			if( set )
+			if ( set )
 				prot_reg[reg] &amp;= ~(1 &lt;&lt; bit);
 			else
 				prot_reg[reg] |= (1 &lt;&lt; bit);
@@ -434,12 +434,12 @@
 		}
 #endif
 		status = pic32mx_write_row(bank, address, source-&gt;address);
-		if( status &amp; NVMCON_NVMERR ) {
+		if ( status &amp; NVMCON_NVMERR ) {
 			LOG_ERROR(&quot;Flash write error NVMERR (status=0x%08&quot; PRIx32 &quot;)&quot;, status);
 			retval = ERROR_FLASH_OPERATION_FAILED;
 			break;
 		}
-		if( status &amp; NVMCON_LVDERR ) {
+		if ( status &amp; NVMCON_LVDERR ) {
 			LOG_ERROR(&quot;Flash write error LVDERR (status=0x%08&quot; PRIx32 &quot;)&quot;, status);
 			retval = ERROR_FLASH_OPERATION_FAILED;
 			break;
@@ -458,12 +458,12 @@
 		memcpy(&amp;value, buffer, sizeof(uint32_t));
 
 		uint32_t status = pic32mx_write_word(bank, address, value);
-		if( status &amp; NVMCON_NVMERR ) {
+		if ( status &amp; NVMCON_NVMERR ) {
 			LOG_ERROR(&quot;Flash write error NVMERR (status=0x%08&quot; PRIx32 &quot;)&quot;, status);
 			retval = ERROR_FLASH_OPERATION_FAILED;
 			break;
 		}
-		if( status &amp; NVMCON_LVDERR ) {
+		if ( status &amp; NVMCON_LVDERR ) {
 			LOG_ERROR(&quot;Flash write error LVDERR (status=0x%08&quot; PRIx32 &quot;)&quot;, status);
 			retval = ERROR_FLASH_OPERATION_FAILED;
 			break;
@@ -481,7 +481,7 @@
 {
 	target_t *target = bank-&gt;target;
 
-	if(bank-&gt;base &gt;= PIC32MX_KSEG1_PGM_FLASH)
+	if (bank-&gt;base &gt;= PIC32MX_KSEG1_PGM_FLASH)
 		target_write_u32(target, PIC32MX_NVMADDR, KS1Virt2Phys(address));
 	else
 		target_write_u32(target, PIC32MX_NVMADDR, KS0Virt2Phys(address));
@@ -499,11 +499,11 @@
 
 	LOG_DEBUG(&quot;addr: 0x%08&quot; PRIx32 &quot; srcaddr: 0x%08&quot; PRIx32 &quot;&quot;, address, srcaddr);
 
-	if(address &gt;= PIC32MX_KSEG1_PGM_FLASH)
+	if (address &gt;= PIC32MX_KSEG1_PGM_FLASH)
 		target_write_u32(target, PIC32MX_NVMADDR,    KS1Virt2Phys(address));
 	else
 		target_write_u32(target, PIC32MX_NVMADDR,    KS0Virt2Phys(address));
-	if(srcaddr &gt;= PIC32MX_KSEG1_RAM)
+	if (srcaddr &gt;= PIC32MX_KSEG1_RAM)
 		target_write_u32(target, PIC32MX_NVMSRCADDR, KS1Virt2Phys(srcaddr));
 	else
 		target_write_u32(target, PIC32MX_NVMSRCADDR, KS0Virt2Phys(srcaddr));
@@ -564,9 +564,9 @@
 		memcpy(&amp;value, buffer + bytes_written, sizeof(uint32_t));
 
 		status = pic32mx_write_word(bank, address, value);
-		if( status &amp; NVMCON_NVMERR )
+		if ( status &amp; NVMCON_NVMERR )
 			return ERROR_FLASH_OPERATION_FAILED;
-		if( status &amp; NVMCON_LVDERR )
+		if ( status &amp; NVMCON_LVDERR )
 			return ERROR_FLASH_OPERATION_FAILED;
 
 		bytes_written += 4;
@@ -580,9 +580,9 @@
 		memcpy(&amp;value, buffer + bytes_written, bytes_remaining);
 
 		status = pic32mx_write_word(bank, address, value);
-		if( status &amp; NVMCON_NVMERR )
+		if ( status &amp; NVMCON_NVMERR )
 			return ERROR_FLASH_OPERATION_FAILED;
-		if( status &amp; NVMCON_LVDERR )
+		if ( status &amp; NVMCON_LVDERR )
 			return ERROR_FLASH_OPERATION_FAILED;
 	}
 
@@ -609,23 +609,23 @@
 			  (unsigned)((device_id&gt;&gt;12)&amp;0xff), 
 			  (unsigned)((device_id&gt;&gt;20)&amp;0xfff) );
 
-	if(((device_id&gt;&gt;1)&amp;0x7ff) != PIC32MX_MANUF_ID) {
+	if (((device_id&gt;&gt;1)&amp;0x7ff) != PIC32MX_MANUF_ID) {
 		LOG_WARNING( &quot;Cannot identify target as a PIC32MX family.&quot; );
 		return ERROR_FLASH_OPERATION_FAILED;
 	}
 
 	page_size = 4096;
-	if(bank-&gt;base == PIC32MX_KSEG1_BOOT_FLASH || bank-&gt;base == 1) {
+	if (bank-&gt;base == PIC32MX_KSEG1_BOOT_FLASH || bank-&gt;base == 1) {
 		/* 0xBFC00000: Boot flash size fixed at 12k */
 		num_pages = 12;
 	} else {
 		/* 0xBD000000: Program flash size varies with device */
 		for(i=0; pic32mx_devs[i].name != NULL; i++)
-			if(pic32mx_devs[i].devid == ((device_id &gt;&gt; 12) &amp; 0xff)) {
+			if (pic32mx_devs[i].devid == ((device_id &gt;&gt; 12) &amp; 0xff)) {
 				num_pages = pic32mx_devs[i].pfm_size;
 				break;
 			}
-		if(pic32mx_devs[i].name == NULL) {
+		if (pic32mx_devs[i].name == NULL) {
 			LOG_WARNING( &quot;Cannot identify target as a PIC32MX family.&quot; );
 			return ERROR_FLASH_OPERATION_FAILED;
 		}
@@ -651,8 +651,8 @@
 	/* calculate numbers of pages */
 	num_pages /= (page_size / 1024);
 
-	if(bank-&gt;base == 0) bank-&gt;base = PIC32MX_KSEG1_PGM_FLASH;
-	if(bank-&gt;base == 1) bank-&gt;base = PIC32MX_KSEG1_BOOT_FLASH;
+	if (bank-&gt;base == 0) bank-&gt;base = PIC32MX_KSEG1_PGM_FLASH;
+	if (bank-&gt;base == 1) bank-&gt;base = PIC32MX_KSEG1_BOOT_FLASH;
 	bank-&gt;size = (num_pages * page_size);
 	bank-&gt;num_sectors = num_pages;
 	bank-&gt;chip_width = 4;
@@ -697,7 +697,7 @@
 
 	device_id = ejtag_info-&gt;idcode;
 
-	if(((device_id&gt;&gt;1)&amp;0x7ff) != PIC32MX_MANUF_ID) {
+	if (((device_id&gt;&gt;1)&amp;0x7ff) != PIC32MX_MANUF_ID) {
 		snprintf(buf, buf_size, 
 				 &quot;Cannot identify target as a PIC32MX family (manufacturer 0x%03d != 0x%03d)\n&quot;, 
 				 (unsigned)((device_id&gt;&gt;1)&amp;0x7ff), 
@@ -705,11 +705,11 @@
 		return ERROR_FLASH_OPERATION_FAILED;
 	}
 	for(i=0; pic32mx_devs[i].name != NULL; i++)
-		if(pic32mx_devs[i].devid == ((device_id &gt;&gt; 12) &amp; 0xff)) {
+		if (pic32mx_devs[i].devid == ((device_id &gt;&gt; 12) &amp; 0xff)) {
 			printed = snprintf(buf, buf_size, &quot;PIC32MX%s&quot;, pic32mx_devs[i].name);
 			break;
 		}
-	if(pic32mx_devs[i].name == NULL) {
+	if (pic32mx_devs[i].name == NULL) {
 		snprintf(buf, buf_size, &quot;Cannot identify target as a PIC32MX family\n&quot;);
 		return ERROR_FLASH_OPERATION_FAILED;
 	}
@@ -847,13 +847,13 @@
 
 	target_write_u32(target, PIC32MX_FLASH_CR, FLASH_LOCK);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 	{
 		LOG_ERROR(&quot;pic32mx device protected&quot;);
 		return ERROR_OK;
 	}
 
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 	{
 		LOG_ERROR(&quot;pic32mx device programming failed&quot;);
 		return ERROR_OK;
@@ -931,9 +931,9 @@
 
 	res = ERROR_OK;
 	status = pic32mx_write_word(bank, address, value);
-	if( status &amp; NVMCON_NVMERR )
+	if ( status &amp; NVMCON_NVMERR )
 		res = ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; NVMCON_LVDERR )
+	if ( status &amp; NVMCON_LVDERR )
 		res = ERROR_FLASH_OPERATION_FAILED;
 
 	if (res == ERROR_OK)

Modified: trunk/src/flash/stellaris.c
===================================================================
--- trunk/src/flash/stellaris.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/stellaris.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -468,7 +468,7 @@
 		  did0, did1, stellaris_info-&gt;dc0, stellaris_info-&gt;dc1);
 
 	ver = did0 &gt;&gt; 28;
-	if((ver != 0) &amp;&amp; (ver != 1))
+	if ((ver != 0) &amp;&amp; (ver != 1))
 	{
 		LOG_WARNING(&quot;Unknown did0 version, cannot identify target&quot;);
 		return ERROR_FLASH_OPERATION_FAILED;
@@ -482,7 +482,7 @@
 
 	ver = did1 &gt;&gt; 28;
 	fam = (did1 &gt;&gt; 24) &amp; 0xF;
-	if(((ver != 0) &amp;&amp; (ver != 1)) || (fam != 0))
+	if (((ver != 0) &amp;&amp; (ver != 1)) || (fam != 0))
 	{
 		LOG_WARNING(&quot;Unknown did1 version/family, cannot positively identify target as a Stellaris&quot;);
 	}
@@ -614,7 +614,7 @@
 
 		/* Check acess violations */
 		target_read_u32(target, FLASH_CRIS, &amp;flash_cris);
-		if(flash_cris &amp; (AMASK))
+		if (flash_cris &amp; (AMASK))
 		{
 			LOG_WARNING(&quot;Error erasing flash page %i,  flash_cris 0x%&quot; PRIx32 &quot;&quot;, banknr, flash_cris);
 			target_write_u32(target, FLASH_CRIS, 0);
@@ -691,7 +691,7 @@
 
 	/* Check acess violations */
 	target_read_u32(target, FLASH_CRIS, &amp;flash_cris);
-	if(flash_cris &amp; (AMASK))
+	if (flash_cris &amp; (AMASK))
 	{
 		LOG_WARNING(&quot;Error setting flash page protection,  flash_cris 0x%&quot; PRIx32 &quot;&quot;, flash_cris);
 		target_write_u32(target, FLASH_CRIS, 0);

Modified: trunk/src/flash/stm32x.c
===================================================================
--- trunk/src/flash/stm32x.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/stm32x.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -182,9 +182,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* clear readout protection and complementary option bytes
@@ -218,9 +218,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* write protection byte 1 */
@@ -228,9 +228,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* write protection byte 2 */
@@ -238,9 +238,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* write protection byte 3 */
@@ -248,9 +248,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* write protection byte 4 */
@@ -258,9 +258,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	/* write readout protection bit */
@@ -268,9 +268,9 @@
 
 	status = stm32x_wait_status_busy(bank, 10);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 		return ERROR_FLASH_OPERATION_FAILED;
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 		return ERROR_FLASH_OPERATION_FAILED;
 
 	target_write_u32(target, STM32_FLASH_CR, FLASH_LOCK);
@@ -338,7 +338,7 @@
 		{
 			set = 1;
 
-			if( protection &amp; (1 &lt;&lt; i))
+			if ( protection &amp; (1 &lt;&lt; i))
 				set = 0;
 
 			for (s = 0; s &lt; stm32x_info-&gt;ppage_size; s++)
@@ -378,9 +378,9 @@
 
 		status = stm32x_wait_status_busy(bank, 10);
 
-		if( status &amp; FLASH_WRPRTERR )
+		if ( status &amp; FLASH_WRPRTERR )
 			return ERROR_FLASH_OPERATION_FAILED;
-		if( status &amp; FLASH_PGERR )
+		if ( status &amp; FLASH_PGERR )
 			return ERROR_FLASH_OPERATION_FAILED;
 		bank-&gt;sectors[i].is_erased = 1;
 	}
@@ -445,7 +445,7 @@
 			reg = (i / stm32x_info-&gt;ppage_size) / 8;
 			bit = (i / stm32x_info-&gt;ppage_size) - (reg * 8);
 
-			if( set )
+			if ( set )
 				prot_reg[reg] &amp;= ~(1 &lt;&lt; bit);
 			else
 				prot_reg[reg] |= (1 &lt;&lt; bit);
@@ -459,7 +459,7 @@
 			reg = (i / stm32x_info-&gt;ppage_size) / 8;
 			bit = (i / stm32x_info-&gt;ppage_size) - (reg * 8);
 
-			if( set )
+			if ( set )
 				prot_reg[reg] &amp;= ~(1 &lt;&lt; bit);
 			else
 				prot_reg[reg] |= (1 &lt;&lt; bit);
@@ -658,12 +658,12 @@
 
 		status = stm32x_wait_status_busy(bank, 5);
 
-		if( status &amp; FLASH_WRPRTERR )
+		if ( status &amp; FLASH_WRPRTERR )
 		{
 			LOG_ERROR(&quot;flash memory not erased before writing&quot;);
 			return ERROR_FLASH_OPERATION_FAILED;
 		}
-		if( status &amp; FLASH_PGERR )
+		if ( status &amp; FLASH_PGERR )
 		{
 			LOG_ERROR(&quot;flash memory write protected&quot;);
 			return ERROR_FLASH_OPERATION_FAILED;
@@ -684,12 +684,12 @@
 
 		status = stm32x_wait_status_busy(bank, 5);
 
-		if( status &amp; FLASH_WRPRTERR )
+		if ( status &amp; FLASH_WRPRTERR )
 		{
 			LOG_ERROR(&quot;flash memory not erased before writing&quot;);
 			return ERROR_FLASH_OPERATION_FAILED;
 		}
-		if( status &amp; FLASH_PGERR )
+		if ( status &amp; FLASH_PGERR )
 		{
 			LOG_ERROR(&quot;flash memory write protected&quot;);
 			return ERROR_FLASH_OPERATION_FAILED;
@@ -1188,13 +1188,13 @@
 
 	target_write_u32(target, STM32_FLASH_CR, FLASH_LOCK);
 
-	if( status &amp; FLASH_WRPRTERR )
+	if ( status &amp; FLASH_WRPRTERR )
 	{
 		LOG_ERROR(&quot;stm32x device protected&quot;);
 		return ERROR_OK;
 	}
 
-	if( status &amp; FLASH_PGERR )
+	if ( status &amp; FLASH_PGERR )
 	{
 		LOG_ERROR(&quot;stm32x device programming failed&quot;);
 		return ERROR_OK;

Modified: trunk/src/flash/str9x.c
===================================================================
--- trunk/src/flash/str9x.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/str9x.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -305,7 +305,7 @@
 			{
 				return retval;
 			}
-			if( status &amp; 0x80 )
+			if ( status &amp; 0x80 )
 				break;
 			alive_sleep(1);
 		}
@@ -327,7 +327,7 @@
 			return retval;
 		}
 
-		if( status &amp; 0x22 )
+		if ( status &amp; 0x22 )
 		{
 			LOG_ERROR(&quot;error erasing flash bank, status: 0x%x&quot;, status);
 			return ERROR_FLASH_OPERATION_FAILED;
@@ -365,7 +365,7 @@
 		adr = bank-&gt;base + bank-&gt;sectors[i].offset;
 
 		target_write_u16(target, adr, 0x60);
-		if( set )
+		if ( set )
 			target_write_u16(target, adr, 0x01);
 		else
 			target_write_u16(target, adr, 0xD0);
@@ -578,7 +578,7 @@
 		for (timeout=0; timeout&lt;1000; timeout++)
 		{
 			target_read_u8(target, bank_adr, &amp;status);
-			if( status &amp; 0x80 )
+			if ( status &amp; 0x80 )
 				break;
 			alive_sleep(1);
 		}
@@ -627,7 +627,7 @@
 		for (timeout=0; timeout&lt;1000; timeout++)
 		{
 			target_read_u8(target, bank_adr, &amp;status);
-			if( status &amp; 0x80 )
+			if ( status &amp; 0x80 )
 				break;
 			alive_sleep(1);
 		}

Modified: trunk/src/flash/str9xpec.c
===================================================================
--- trunk/src/flash/str9xpec.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/flash/str9xpec.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -101,7 +101,7 @@
 
 int str9xpec_set_instr(jtag_tap_t *tap, uint32_t new_instr, tap_state_t end_state)
 {
-	if( tap == NULL ){
+	if ( tap == NULL ){
 		return ERROR_TARGET_INVALID;
 	}
 
@@ -575,7 +575,7 @@
 	/* last bank: 0xFF signals a full device protect */
 	if (last == 0xFF)
 	{
-		if( set )
+		if ( set )
 		{
 			status = str9xpec_lock_device(bank);
 		}
@@ -589,7 +589,7 @@
 	{
 		for (i = first; i &lt;= last; i++)
 		{
-			if( set )
+			if ( set )
 				buf_set_u32(str9xpec_info-&gt;options, str9xpec_info-&gt;sector_bits[i], 1, 1);
 			else
 				buf_set_u32(str9xpec_info-&gt;options, str9xpec_info-&gt;sector_bits[i], 1, 0);

Modified: trunk/src/helper/command.c
===================================================================
--- trunk/src/helper/command.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/command.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -348,7 +348,7 @@
 
 void command_output_text(command_context_t *context, const char *data)
 {
-	if( context &amp;&amp; context-&gt;output_handler &amp;&amp; data  ){
+	if ( context &amp;&amp; context-&gt;output_handler &amp;&amp; data  ){
 		context-&gt;output_handler( context, data );
 	}
 }

Modified: trunk/src/helper/fileio.c
===================================================================
--- trunk/src/helper/fileio.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/fileio.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -182,7 +182,7 @@
 
 static inline int fileio_local_fgets(fileio_t *fileio, uint32_t size, char *buffer)
 {
-	if( fgets(buffer, size, fileio-&gt;file) == NULL)
+	if ( fgets(buffer, size, fileio-&gt;file) == NULL)
 		return ERROR_FILEIO_OPERATION_FAILED;
 	
 	return ERROR_OK;

Modified: trunk/src/helper/ioutil.c
===================================================================
--- trunk/src/helper/ioutil.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/ioutil.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -340,19 +340,19 @@
 			break;
 		}
 
-        if( done == 0 ) break;
+        if ( done == 0 ) break;
 
 		wrote = write(fd1, buf, done);
-        if( wrote != done ) SHOW_RESULT( write, wrote );
+        if ( wrote != done ) SHOW_RESULT( write, wrote );
 
-        if( wrote != done ) break;
+        if ( wrote != done ) break;
 	}
 
 	err = close(fd1);
-    if( err &lt; 0 ) SHOW_RESULT( close, err );
+    if ( err &lt; 0 ) SHOW_RESULT( close, err );
 
 	err = close(fd2);
-    if( err &lt; 0 ) SHOW_RESULT( close, err );
+    if ( err &lt; 0 ) SHOW_RESULT( close, err );
 
 }
 
@@ -372,7 +372,7 @@
 	}
 
 	dirp = opendir(name);
-    if( dirp == NULL ) SHOW_RESULT( opendir, -1 );
+    if ( dirp == NULL ) SHOW_RESULT( opendir, -1 );
 
 	for (;;)
 	{
@@ -421,7 +421,7 @@
 	}
 
 	err = closedir(dirp);
-    if( err &lt; 0 ) SHOW_RESULT( stat, err );
+    if ( err &lt; 0 ) SHOW_RESULT( stat, err );
 }
 
 

Modified: trunk/src/helper/jim.c
===================================================================
--- trunk/src/helper/jim.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/jim.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -544,7 +544,7 @@
 #endif
 	
 	/* This may actually crash... we do it last */
-	if( interp &amp;&amp; interp-&gt;cookie_stderr ){
+	if ( interp &amp;&amp; interp-&gt;cookie_stderr ){
 		Jim_fprintf(  interp, interp-&gt;cookie_stderr, JIM_NL &quot;JIM INTERPRETER PANIC: &quot;);
 		Jim_vfprintf( interp, interp-&gt;cookie_stderr, fmt, ap );
 		Jim_fprintf(  interp, interp-&gt;cookie_stderr, JIM_NL JIM_NL );
@@ -2064,7 +2064,7 @@
 	buf = jim_vasprintf( fmt, ap );
 	va_end(ap);
 
-	if( buf ){
+	if ( buf ){
 		Jim_AppendString( interp, objPtr, buf, -1 );
 		jim_vasprintf_done(buf);
 	}
@@ -2283,7 +2283,7 @@
 		haveprec = 0;
 		prec = -1; /* not found yet */
     next_fmt:
-		if( fmtLen &lt;= 0 ){
+		if ( fmtLen &lt;= 0 ){
 			break;
 		}
 		switch( *fmt ){
@@ -2345,7 +2345,7 @@
 				accum = (accum * 10) + (*fmt - '0');
 				fmt++;  fmtLen--;
 			}
-			if( inprec ){
+			if ( inprec ){
 				haveprec = 1;
 				prec = accum;
 			} else {
@@ -2356,24 +2356,24 @@
 			/* suck up the next item as an integer */
 			fmt++;  fmtLen--;
 			objc--;
-			if( objc &lt;= 0 ){
+			if ( objc &lt;= 0 ){
 				goto not_enough_args;
 			}
-			if( Jim_GetWide(interp,objv[0],&amp;wideValue )== JIM_ERR ){
+			if ( Jim_GetWide(interp,objv[0],&amp;wideValue )== JIM_ERR ){
 				Jim_FreeNewObj(interp, resObjPtr );
 				return NULL;
 			}
-			if( inprec ){
+			if ( inprec ){
 				haveprec = 1;
 				prec = wideValue;
-				if( prec &lt; 0 ){
+				if ( prec &lt; 0 ){
 					/* man 3 printf says */
 					/* if prec is negative, it is zero */
 					prec = 0;
 				}
 			} else {
 			width = wideValue;
-			if( width &lt; 0 ){
+			if ( width &lt; 0 ){
 				ljust = 1;
 				width = -width;
 			}
@@ -2402,32 +2402,32 @@
 		 */
 		cp = fmt_str;
 		*cp++ = '%';
-		if( altfm ){
+		if ( altfm ){
 			*cp++ = '#';
 		}
-		if( forceplus ){
+		if ( forceplus ){
 			*cp++ = '+';
-		} else if( spad ){
+		} else if ( spad ){
 			/* PLUS overrides */
 			*cp++ = ' ';
 		}
-		if( ljust ){
+		if ( ljust ){
 			*cp++ = '-';
 		}
-		if( zpad  ){
+		if ( zpad  ){
 			*cp++ = '0';
 		}
-		if( width &gt; 0 ){
+		if ( width &gt; 0 ){
 			sprintf( cp, &quot;%d&quot;, width );
 			/* skip ahead */
 			cp = strchr(cp,0);
 		}
 		/* did we find a period? */
-		if( inprec ){
+		if ( inprec ){
 			/* then add it */
 			*cp++ = '.';
 			/* did something occur after the period? */
-			if( haveprec ){
+			if ( haveprec ){
 				sprintf( cp, &quot;%d&quot;, prec );
 			}
 			cp = strchr(cp,0);
@@ -2461,7 +2461,7 @@
 		case 'E':
 			*cp++ = *fmt;
 			*cp   = 0;
-			if( Jim_GetDouble( interp, objv[0], &amp;doubleValue ) == JIM_ERR ){
+			if ( Jim_GetDouble( interp, objv[0], &amp;doubleValue ) == JIM_ERR ){
 				Jim_FreeNewObj( interp, resObjPtr );
 				return NULL;
 			}
@@ -2475,7 +2475,7 @@
 		case 'x':
 		case 'X':
 			/* jim widevaluse are 64bit */
-			if( sizeof(jim_wide) == sizeof(long long) ){
+			if ( sizeof(jim_wide) == sizeof(long long) ){
 				*cp++ = 'l'; 
 				*cp++ = 'l';
 			} else {
@@ -2627,12 +2627,12 @@
 	int e;
 
 	e = Jim_Nvp_name2value_obj( interp, nvp_table, objPtr, &amp;n );
-	if( e == JIM_ERR ){
+	if ( e == JIM_ERR ){
 		return e;
 	}
 
 	/* Success? found? */
-	if( n-&gt;name ){
+	if ( n-&gt;name ){
 		/* remove const */
 		*result = (Jim_Nvp *)n;
 		return JIM_OK;
@@ -8104,17 +8104,17 @@
 {
     DIR *dir = 0;
 
-    if(name &amp;&amp; name[0]) {
+    if (name &amp;&amp; name[0]) {
         size_t base_length = strlen(name);
         const char *all = /* search pattern must end with suitable wildcard */
             strchr(&quot;/\\&quot;, name[base_length - 1]) ? &quot;*&quot; : &quot;/*&quot;;
 
-        if((dir = (DIR *) Jim_Alloc(sizeof *dir)) != 0 &amp;&amp;
+        if ((dir = (DIR *) Jim_Alloc(sizeof *dir)) != 0 &amp;&amp;
            (dir-&gt;name = (char *) Jim_Alloc(base_length + strlen(all) + 1)) != 0)
         {
             strcat(strcpy(dir-&gt;name, name), all);
 
-            if((dir-&gt;handle = (long) _findfirst(dir-&gt;name, &amp;dir-&gt;info)) != -1)
+            if ((dir-&gt;handle = (long) _findfirst(dir-&gt;name, &amp;dir-&gt;info)) != -1)
                 dir-&gt;result.d_name = 0;
             else { /* rollback */
                 Jim_Free(dir-&gt;name);
@@ -8136,13 +8136,13 @@
 {
     int result = -1;
 
-    if(dir) {
-        if(dir-&gt;handle != -1)
+    if (dir) {
+        if (dir-&gt;handle != -1)
             result = _findclose(dir-&gt;handle);
         Jim_Free(dir-&gt;name);
         Jim_Free(dir);
     }
-    if(result == -1) /* map all errors to EBADF */
+    if (result == -1) /* map all errors to EBADF */
         errno = EBADF;
     return result;
 }
@@ -8151,8 +8151,8 @@
 {
     struct dirent *result = 0;
 
-    if(dir &amp;&amp; dir-&gt;handle != -1) {
-        if(!dir-&gt;result.d_name || _findnext(dir-&gt;handle, &amp;dir-&gt;info) != -1) {
+    if (dir &amp;&amp; dir-&gt;handle != -1) {
+        if (!dir-&gt;result.d_name || _findnext(dir-&gt;handle, &amp;dir-&gt;info) != -1) {
             result         = &amp;dir-&gt;result;
             result-&gt;d_name = dir-&gt;info.name;
         }
@@ -8894,7 +8894,7 @@
     Jim_IncrRefCount(scriptObjPtr);
 
 
-	if( filename ){
+	if ( filename ){
 		JimSetSourceInfo( interp, scriptObjPtr, filename, lineno );
 	}
 
@@ -12412,7 +12412,7 @@
 
 int Jim_vfprintf( Jim_Interp *interp, void *cookie, const char *fmt, va_list ap )
 {
-	if( (interp == NULL) || (interp-&gt;cb_vfprintf == NULL) ){
+	if ( (interp == NULL) || (interp-&gt;cb_vfprintf == NULL) ){
 		errno = ENOTSUP;
 		return -1;
 	}
@@ -12421,7 +12421,7 @@
 
 size_t Jim_fwrite( Jim_Interp *interp, const void *ptr, size_t size, size_t n, void *cookie )
 {
-	if( (interp == NULL) || (interp-&gt;cb_fwrite == NULL) ){
+	if ( (interp == NULL) || (interp-&gt;cb_fwrite == NULL) ){
 		errno = ENOTSUP;
 		return 0;
 	}
@@ -12430,7 +12430,7 @@
 
 size_t Jim_fread( Jim_Interp *interp, void *ptr, size_t size, size_t n, void *cookie )
 {
-	if( (interp == NULL) || (interp-&gt;cb_fread == NULL) ){
+	if ( (interp == NULL) || (interp-&gt;cb_fread == NULL) ){
 		errno = ENOTSUP;
 		return 0;
 	}
@@ -12439,7 +12439,7 @@
 
 int Jim_fflush( Jim_Interp *interp, void *cookie )
 {
-	if( (interp == NULL) || (interp-&gt;cb_fflush == NULL) ){
+	if ( (interp == NULL) || (interp-&gt;cb_fflush == NULL) ){
 		/* pretend all is well */
 		return 0;
 	}
@@ -12448,7 +12448,7 @@
 
 char* Jim_fgets( Jim_Interp *interp, char *s, int size, void *cookie )
 {
-	if( (interp == NULL) || (interp-&gt;cb_fgets == NULL) ){
+	if ( (interp == NULL) || (interp-&gt;cb_fgets == NULL) ){
 		errno = ENOTSUP;
 		return NULL;
 	}
@@ -12458,7 +12458,7 @@
 Jim_Nvp_name2value_simple( const Jim_Nvp *p, const char *name )
 {
 	while( p-&gt;name ){
-		if( 0 == strcmp( name, p-&gt;name ) ){
+		if ( 0 == strcmp( name, p-&gt;name ) ){
 			break;
 		}
 		p++;
@@ -12470,7 +12470,7 @@
 Jim_Nvp_name2value_nocase_simple( const Jim_Nvp *p, const char *name )
 {
 	while( p-&gt;name ){
-		if( 0 == strcasecmp( name, p-&gt;name ) ){
+		if ( 0 == strcasecmp( name, p-&gt;name ) ){
 			break;
 		}
 		p++;
@@ -12499,12 +12499,12 @@
 	p = Jim_Nvp_name2value_simple( _p, name );
 
 	/* result */
-	if( result ){
+	if ( result ){
 		*result = (Jim_Nvp *)(p);
 	}
 	
 	/* found? */
-	if( p-&gt;name ){
+	if ( p-&gt;name ){
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12524,11 +12524,11 @@
 
 	p = Jim_Nvp_name2value_nocase_simple( _p, name );
 
-	if( puthere ){
+	if ( puthere ){
 		*puthere = (Jim_Nvp *)(p);
 	}
 	/* found */
-	if( p-&gt;name ){
+	if ( p-&gt;name ){
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12543,7 +12543,7 @@
 	jim_wide w;
 
 	e = Jim_GetWide( interp, o, &amp;w );
-	if( e != JIM_OK ){
+	if ( e != JIM_OK ){
 		return e;
 	}
 
@@ -12554,7 +12554,7 @@
 Jim_Nvp_value2name_simple( const Jim_Nvp *p, int value )
 {
 	while( p-&gt;name ){
-		if( value == p-&gt;value ){
+		if ( value == p-&gt;value ){
 			break;
 		}
 		p++;
@@ -12570,11 +12570,11 @@
 
 	p = Jim_Nvp_value2name_simple( _p, value );
 
-	if( result ){
+	if ( result ){
 		*result = (Jim_Nvp *)(p);
 	}
 
-	if( p-&gt;name ){
+	if ( p-&gt;name ){
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12615,16 +12615,16 @@
 	Jim_Obj *o;
 	
 	o = NULL; // failure 
-	if( goi-&gt;argc ){
+	if ( goi-&gt;argc ){
 		// success 
 		o = goi-&gt;argv[0];
 		goi-&gt;argc -= 1;
 		goi-&gt;argv += 1;
 	}
-	if( puthere ){
+	if ( puthere ){
 		*puthere = o;
 	}
-	if( o != NULL ){
+	if ( o != NULL ){
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12640,9 +12640,9 @@
 
 
 	r = Jim_GetOpt_Obj( goi, &amp;o );
-	if( r == JIM_OK ){
+	if ( r == JIM_OK ){
 		cp = Jim_GetString( o, len );
-		if( puthere ){
+		if ( puthere ){
 			/* remove const */
 			*puthere = (char *)(cp);
 		}
@@ -12657,14 +12657,14 @@
 	Jim_Obj *o;
 	double _safe;
 	
-	if( puthere == NULL ){
+	if ( puthere == NULL ){
 		puthere = &amp;_safe;
 	}
 
 	r = Jim_GetOpt_Obj( goi, &amp;o );
-	if( r == JIM_OK ){
+	if ( r == JIM_OK ){
 		r = Jim_GetDouble( goi-&gt;interp, o, puthere );
-		if( r != JIM_OK ){
+		if ( r != JIM_OK ){
 			Jim_SetResult_sprintf( goi-&gt;interp,
 								   &quot;not a number: %s&quot;, 
 								   Jim_GetString( o, NULL ) );
@@ -12680,12 +12680,12 @@
 	Jim_Obj *o;
 	jim_wide _safe;
 
-	if( puthere == NULL ){
+	if ( puthere == NULL ){
 		puthere = &amp;_safe;
 	}
 
 	r = Jim_GetOpt_Obj( goi, &amp;o );
-	if( r == JIM_OK ){
+	if ( r == JIM_OK ){
 		r = Jim_GetWide( goi-&gt;interp, o, puthere );
 	}
 	return r;
@@ -12699,12 +12699,12 @@
 	Jim_Obj *o;
 	int e;
 
-	if( puthere == NULL ){
+	if ( puthere == NULL ){
 		puthere = &amp;_safe;
 	}
 
 	e = Jim_GetOpt_Obj( goi, &amp;o );
-	if( e == JIM_OK ){
+	if ( e == JIM_OK ){
 		e = Jim_Nvp_name2value_obj( goi-&gt;interp,
 									nvp, 
 									o,
@@ -12719,7 +12719,7 @@
 					   const Jim_Nvp *nvptable,
 					   int hadprefix )
 {
-	if( hadprefix ){
+	if ( hadprefix ){
 		Jim_SetResult_NvpUnknown( goi-&gt;interp,
 								  goi-&gt;argv[-2],
 								  goi-&gt;argv[-1],
@@ -12742,11 +12742,11 @@
 	Jim_Obj *o;
 	int e;
 
-	if( puthere == NULL ){
+	if ( puthere == NULL ){
 		puthere = &amp;_safe;
 	}
 	e = Jim_GetOpt_Obj( goi, &amp;o );
-	if( e == JIM_OK ){
+	if ( e == JIM_OK ){
 		e = Jim_GetEnum( goi-&gt;interp,
 						 o,
 						 lookup,
@@ -12768,7 +12768,7 @@
 	va_start(ap,fmt);
 	buf = jim_vasprintf( fmt, ap );
 	va_end(ap);
-	if( buf ){
+	if ( buf ){
 		Jim_SetResultString( interp, buf, -1 );
 		jim_vasprintf_done(buf);
 	}
@@ -12782,7 +12782,7 @@
 						  Jim_Obj *param_value,
 						  const Jim_Nvp *nvp )
 {
-	if( param_name ){
+	if ( param_name ){
 		Jim_SetResult_sprintf( interp,
 							   &quot;%s: Unknown: %s, try one of: &quot;,
 							   Jim_GetString( param_name, NULL ),
@@ -12796,7 +12796,7 @@
 		const char *a;
 		const char *b;
 
-		if( (nvp+1)-&gt;name ){
+		if ( (nvp+1)-&gt;name ){
 			a = nvp-&gt;name;
 			b = &quot;, &quot;;
 		} else {
@@ -12818,7 +12818,7 @@
 {
 	int x;
 
-	if( debug_string_obj ){
+	if ( debug_string_obj ){
 		Jim_FreeObj( interp, debug_string_obj );
 	}
 

Modified: trunk/src/helper/jim.h
===================================================================
--- trunk/src/helper/jim.h	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/jim.h	2009-06-23 22:35:09 UTC (rev 2357)
@@ -987,7 +987,7 @@
  *
  *   while( goi.argc ){
  *         e = Jim_GetOpt_Nvp( &amp;goi, nvp_options, &amp;n );
- *         if( e != JIM_OK ){
+ *         if ( e != JIM_OK ){
  *               Jim_GetOpt_NvpUnknown( &amp;goi, nvp_options, 0 );
  *               return e;
  *         }
@@ -997,7 +997,7 @@
  *             printf(&quot;Option ALIVE specified\n&quot;);
  *             break;
  *         case FIRST:
- *             if( goi.argc &lt; 1 ){
+ *             if ( goi.argc &lt; 1 ){
  *                     .. not enough args error ..
  *             }
  *             Jim_GetOpt_String( &amp;goi, &amp;cp, NULL );
@@ -1008,7 +1008,7 @@
  *             break;
  *         case POLITICS:
  *             e = Jim_GetOpt_Nvp( &amp;goi, nvp_politics, &amp;n );
- *             if( e != JIM_OK ){
+ *             if ( e != JIM_OK ){
  *                 Jim_GetOpt_NvpUnknown( &amp;goi, nvp_politics, 1 );
  *                 return e;
  *             }
@@ -1105,7 +1105,7 @@
  *  while( goi.argc ){
  *     // Get the next option 
  *     e = Jim_GetOpt_Nvp( &amp;goi, cmd_options, &amp;n );
- *     if( e != JIM_OK ){
+ *     if ( e != JIM_OK ){
  *          // option was not recognized
  *          // pass 'hadprefix=0' because there is no prefix
  *          Jim_GetOpt_NvpUnknown( &amp;goi, cmd_options, 0 );
@@ -1116,7 +1116,7 @@
  *     case OPT_SEX:
  *          // handle:  --sex male|female|lots|needmore
  *          e = Jim_GetOpt_Nvp( &amp;goi, &amp;nvp_sex, &amp;n );
- *          if( e != JIM_OK ){
+ *          if ( e != JIM_OK ){
  *               Jim_GetOpt_NvpUnknown( &amp;ogi, nvp_sex, 1 );
  *               return e;
  *          }

Modified: trunk/src/helper/log.c
===================================================================
--- trunk/src/helper/log.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/log.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -109,7 +109,7 @@
 #endif
 					string);
 		}
-		else if(server_use_pipes == 0)
+		else if (server_use_pipes == 0)
 		{
 			/* if we are using gdb through pipes then we do not want any output
 			 * to the pipe otherwise we get repeated strings */

Modified: trunk/src/helper/options.c
===================================================================
--- trunk/src/helper/options.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/helper/options.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -91,7 +91,7 @@
 		*strrchr(strExePath, '\\')=0;
 		strcat(strExePath, &quot;/../lib/&quot;PACKAGE);
 		for(p=strExePath; *p; p++) {
-			if(*p == '\\')
+			if (*p == '\\')
 				*p = '/';
 		}
 		add_script_search_dir(strExePath);

Modified: trunk/src/jtag/arm-jtag-ew.c
===================================================================
--- trunk/src/jtag/arm-jtag-ew.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/arm-jtag-ew.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -220,7 +220,7 @@
 	usb_out_buffer[0] = CMD_GET_TCK_FREQUENCY;
     result = armjtagew_usb_message(armjtagew_jtag_handle, 1, 4);
 	speed_real = (int)buf_get_u32(usb_in_buffer,0,32);
-	if(result &lt; 0)
+	if (result &lt; 0)
 	{
         LOG_ERROR(&quot;ARM-JTAG-EW getting speed failed (%d)&quot;, result);
         return ERROR_JTAG_DEVICE_ERROR;
@@ -672,7 +672,7 @@
 			int stat;
 
 			stat = (int)buf_get_u32(usb_in_buffer + byte_length, 0, 32);
-			if(stat) {
+			if (stat) {
 				LOG_ERROR(&quot;armjtagew_tap_execute, emulator returned error code %d for a CMD_TAP_SHIFT command&quot;, stat);
 				return ERROR_JTAG_QUEUE_FAILED;
 			}

Modified: trunk/src/jtag/bitbang.c
===================================================================
--- trunk/src/jtag/bitbang.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/bitbang.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -247,7 +247,7 @@
 	 */
 	retval = ERROR_OK;
 
-	if(bitbang_interface-&gt;blink)
+	if (bitbang_interface-&gt;blink)
 		bitbang_interface-&gt;blink(1);
 
 	while (cmd)
@@ -318,7 +318,7 @@
 		}
 		cmd = cmd-&gt;next;
 	}
-	if(bitbang_interface-&gt;blink)
+	if (bitbang_interface-&gt;blink)
 		bitbang_interface-&gt;blink(0);
 
 	return retval;

Modified: trunk/src/jtag/core.c
===================================================================
--- trunk/src/jtag/core.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/core.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -510,11 +510,11 @@
 
 	if (goal_state==cur_state )
 		;	/* nothing to do */
-	else if( goal_state==TAP_RESET )
+	else if ( goal_state==TAP_RESET )
 	{
 		jtag_add_tlr();
 	}
-	else if( tap_is_state_stable(cur_state) &amp;&amp; tap_is_state_stable(goal_state) )
+	else if ( tap_is_state_stable(cur_state) &amp;&amp; tap_is_state_stable(goal_state) )
 	{
 		unsigned tms_bits  = tap_get_tms_path(cur_state, goal_state);
 		unsigned tms_count = tap_get_tms_path_len(cur_state, goal_state);
@@ -531,7 +531,7 @@
 
 		jtag_add_pathmove(tms_count, moves);
 	}
-	else if( tap_state_transition(cur_state, true)  == goal_state
+	else if ( tap_state_transition(cur_state, true)  == goal_state
 		||   tap_state_transition(cur_state, false) == goal_state )
 	{
 		jtag_add_pathmove(1, &amp;goal_state);
@@ -1026,7 +1026,7 @@
 	total_ir_length = 0;
 	for(;;){
 		tap = jtag_tap_next_enabled(tap);
-		if( tap == NULL ){
+		if ( tap == NULL ){
 			break;
 		}
 		total_ir_length += tap-&gt;ir_length;
@@ -1050,7 +1050,7 @@
 	int val;
 	for(;;){
 		tap = jtag_tap_next_enabled(tap);
-		if( tap == NULL ){
+		if ( tap == NULL ){
 			break;
 		}
 
@@ -1130,7 +1130,7 @@
 		LOG_ERROR(&quot;JTAG interface has to be specified, see \&quot;interface\&quot; command&quot;);
 		return ERROR_JTAG_INVALID_INTERFACE;
 	}
-	if(hasKHz)
+	if (hasKHz)
 	{
 		jtag_interface-&gt;khz(jtag_get_speed_khz(), &amp;jtag_speed);
 		hasKHz = false;
@@ -1151,7 +1151,7 @@
 	LOG_DEBUG(&quot;Init JTAG chain&quot;);
 
 	tap = jtag_tap_next_enabled(NULL);
-	if( tap == NULL ){
+	if ( tap == NULL ){
 		LOG_ERROR(&quot;There are no enabled taps?&quot;);
 		return ERROR_JTAG_INIT_FAILED;
 	}

Modified: trunk/src/jtag/dummy.c
===================================================================
--- trunk/src/jtag/dummy.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/dummy.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -85,16 +85,16 @@
 static void dummy_write(int tck, int tms, int tdi)
 {
 	/* TAP standard: &quot;state transitions occur on rising edge of clock&quot; */
-	if( tck != dummy_clock )
+	if ( tck != dummy_clock )
 	{
-		if( tck )
+		if ( tck )
 		{
 			tap_state_t old_state = dummy_state;
 			dummy_state = tap_state_transition( old_state, tms );
 
-			if( old_state != dummy_state )
+			if ( old_state != dummy_state )
 			{
-				if( clock_count )
+				if ( clock_count )
 				{
 					LOG_DEBUG(&quot;dummy_tap: %d stable clocks&quot;, clock_count);
 					clock_count = 0;
@@ -103,7 +103,7 @@
 				LOG_DEBUG(&quot;dummy_tap: %s&quot;, tap_state_name(dummy_state) );
 
 #if defined(DEBUG)
-				if(dummy_state == TAP_DRCAPTURE)
+				if (dummy_state == TAP_DRCAPTURE)
 					dummy_data = 0x01255043;
 #endif
 			}

Modified: trunk/src/jtag/interface.c
===================================================================
--- trunk/src/jtag/interface.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/interface.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -361,7 +361,7 @@
 
 	for( x = 0 ; x &lt; TAP_NUM_STATES ; x++ ){
 		/* be nice to the human */
-		if( 0 == strcasecmp( name, tap_state_name(x) ) ){
+		if ( 0 == strcasecmp( name, tap_state_name(x) ) ){
 			return x;
 		}
 	}

Modified: trunk/src/jtag/rlink/rlink.c
===================================================================
--- trunk/src/jtag/rlink/rlink.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/rlink/rlink.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -121,7 +121,7 @@
 	va_list		ap;
 	int		usb_ret;
 
-	if(length &gt; sizeof(usb_buffer)) {
+	if (length &gt; sizeof(usb_buffer)) {
 		length = sizeof(usb_buffer);
 	}
 
@@ -176,7 +176,7 @@
 	count = 0;
 
 	while(remain) {
-		if(remain &gt; sizeof(usb_buffer)) {
+		if (remain &gt; sizeof(usb_buffer)) {
 			length = sizeof(usb_buffer);
 		} else {
 			length = remain;
@@ -192,7 +192,7 @@
 			USB_TIMEOUT_MS
 		);
 
-		if(usb_ret &lt; sizeof(usb_buffer)) {
+		if (usb_ret &lt; sizeof(usb_buffer)) {
 			break;
 		}
 
@@ -202,7 +202,7 @@
 			USB_TIMEOUT_MS
 		);
 
-		if(usb_ret &lt; length) {
+		if (usb_ret &lt; length) {
 			break;
 		}
 
@@ -237,7 +237,7 @@
 	count = 0;
 
 	while(remain) {
-		if(remain &gt; (sizeof(usb_buffer) - 4)) {
+		if (remain &gt; (sizeof(usb_buffer) - 4)) {
 			length = (sizeof(usb_buffer) - 4);
 		} else {
 			length = remain;
@@ -263,7 +263,7 @@
 			USB_TIMEOUT_MS
 		);
 
-		if((size_t)usb_ret &lt; sizeof(usb_buffer)) {
+		if ((size_t)usb_ret &lt; sizeof(usb_buffer)) {
 			break;
 		}
 
@@ -291,7 +291,7 @@
 	va_list		ap;
 	size_t		remain;
 
-	if(length &gt; sizeof(buffer)) {
+	if (length &gt; sizeof(buffer)) {
 		length = sizeof(buffer);
 	}
 
@@ -346,10 +346,10 @@
 		pHDev, 1,
 		EP1_CMD_DTC_STOP
 	);
-	if(usb_err &lt; 0) return(usb_err);
+	if (usb_err &lt; 0) return(usb_err);
 
 	while(length) {
-		if(length &lt; sizeof(*header)) {
+		if (length &lt; sizeof(*header)) {
 			LOG_ERROR(&quot;Malformed DTC image\n&quot;);
 			exit(1);
 		}
@@ -358,7 +358,7 @@
 		buffer += sizeof(*header);
 		length -= sizeof(*header);
 
-		if(length &lt; (size_t)header-&gt;length + 1) {
+		if (length &lt; (size_t)header-&gt;length + 1) {
 			LOG_ERROR(&quot;Malformed DTC image\n&quot;);
 			exit(1);
 		}
@@ -369,7 +369,7 @@
 
 			case DTCLOAD_ENTRY:
 				/* store entry addresses somewhere */
-				if(!strncmp(&quot;download&quot;, (char *)buffer + 1, 8)) {
+				if (!strncmp(&quot;download&quot;, (char *)buffer + 1, 8)) {
 					dtc_entry_download = buffer[0];
 				}
 				break;
@@ -381,7 +381,7 @@
 					DTC_LOAD_BUFFER,
 					header-&gt;length + 1, buffer
 				);
-				if(usb_err &lt; 0) return(usb_err);
+				if (usb_err &lt; 0) return(usb_err);
 
 				/* Load it into the DTC. */
 				usb_err = ep1_generic_commandl(
@@ -390,7 +390,7 @@
 						(DTC_LOAD_BUFFER &gt;&gt; 8),
 						DTC_LOAD_BUFFER
 				);
-				if(usb_err &lt; 0) return(usb_err);
+				if (usb_err &lt; 0) return(usb_err);
 
 				break;
 
@@ -401,7 +401,7 @@
 						buffer[0],
 					EP1_CMD_DTC_WAIT
 				);
-				if(usb_err &lt; 0) return(usb_err);
+				if (usb_err &lt; 0) return(usb_err);
 
 				break;
 
@@ -415,7 +415,7 @@
 					ST7_USB_BUF_EP0OUT + lut_start,
 					header-&gt;length + 1, buffer
 				);
-				if(usb_err &lt; 0) return(usb_err);
+				if (usb_err &lt; 0) return(usb_err);
 				break;
 
 			default:
@@ -453,7 +453,7 @@
 			ST7_EP2TXR,
 			1
 	);
-	if(usb_err &lt; 0) return(usb_err);
+	if (usb_err &lt; 0) return(usb_err);
 
 	/* read back ep2txr */
 	usb_err = usb_bulk_read(
@@ -461,7 +461,7 @@
 		(char *)&amp;ep2txr, 1,
 		USB_TIMEOUT_MS
 	);
-	if(usb_err &lt; 0) return(usb_err);
+	if (usb_err &lt; 0) return(usb_err);
 
 	usb_err = ep1_generic_commandl(
 		pHDev, 13,
@@ -480,7 +480,7 @@
 			dtc_entry_download,
 		EP1_CMD_DTC_GET_CACHED_STATUS
 	);
-	if(usb_err &lt; 0) return(usb_err);
+	if (usb_err &lt; 0) return(usb_err);
 
 	/* wait for completion */
 	usb_err = usb_bulk_read(
@@ -514,7 +514,7 @@
 		(char *)command_buffer, USB_EP2BANK_SIZE,
 		USB_TIMEOUT_MS
 	);
-	if(usb_err &lt; 0) return(usb_err);
+	if (usb_err &lt; 0) return(usb_err);
 
 
 	/* Wait for DTC to finish running command buffer */
@@ -527,7 +527,7 @@
 				DTC_STATUS_POLL_BYTE,
 				1
 		);
-		if(usb_err &lt; 0) return(usb_err);
+		if (usb_err &lt; 0) return(usb_err);
 
 		usb_err = usb_bulk_read(
 			pHDev,
@@ -535,11 +535,11 @@
 			(char *)ep2_buffer, 1,
 			USB_TIMEOUT_MS
 		);
-		if(usb_err &lt; 0) return(usb_err);
+		if (usb_err &lt; 0) return(usb_err);
 
-		if(ep2_buffer[0] &amp; 0x01) break;
+		if (ep2_buffer[0] &amp; 0x01) break;
 
-		if(!--i) {
+		if (!--i) {
 			LOG_ERROR(&quot;%s, %d: too many retries waiting for DTC status\n&quot;,
 				__FILE__, __LINE__
 			);
@@ -548,8 +548,8 @@
 	}
 
 
-	if(!reply_buffer) reply_buffer_size = 0;
-	if(reply_buffer_size) {
+	if (!reply_buffer) reply_buffer_size = 0;
+	if (reply_buffer_size) {
 		usb_err = usb_bulk_read(
 			pHDev,
 			USB_EP2IN_ADDR,
@@ -557,7 +557,7 @@
 			USB_TIMEOUT_MS
 		);
 
-		if(usb_err &lt; (int)sizeof(ep2_buffer)) {
+		if (usb_err &lt; (int)sizeof(ep2_buffer)) {
 			LOG_ERROR(&quot;%s, %d: Read of endpoint 2 returned %d\n&quot;,
 				__FILE__, __LINE__, usb_err
 			);
@@ -643,7 +643,7 @@
 	dtc_reply_queue_entry_t	*rq_entry;
 
 	rq_entry = malloc(sizeof(dtc_reply_queue_entry_t));
-	if(rq_entry != NULL) {
+	if (rq_entry != NULL) {
 		rq_entry-&gt;scan.type = type;
 		rq_entry-&gt;scan.buffer = buffer;
 		rq_entry-&gt;scan.size = size;
@@ -652,7 +652,7 @@
 		rq_entry-&gt;cmd = cmd;
 		rq_entry-&gt;next = NULL;
 
-		if(dtc_queue.rq_head == NULL)
+		if (dtc_queue.rq_head == NULL)
 			dtc_queue.rq_head = rq_entry;
 		else
 			dtc_queue.rq_tail-&gt;next = rq_entry;
@@ -683,17 +683,17 @@
 
 	retval = ERROR_OK;
 
-	if(dtc_queue.cmd_index &lt; 1) return(retval);
+	if (dtc_queue.cmd_index &lt; 1) return(retval);
 
 	dtc_queue.cmd_buffer[dtc_queue.cmd_index++] = DTC_CMD_STOP;
 
 	/* run the cmd */
-	if(dtc_queue.rq_head == NULL) {
+	if (dtc_queue.rq_head == NULL) {
 		usb_err = dtc_run_download(pHDev,
 			dtc_queue.cmd_buffer, dtc_queue.cmd_index,
 			NULL, 0
 		);
-		if(usb_err &lt; 0) {
+		if (usb_err &lt; 0) {
 			LOG_ERROR(&quot;dtc_run_download: %s\n&quot;, usb_strerror());
 			exit(1);
 		}
@@ -702,7 +702,7 @@
 			dtc_queue.cmd_buffer, dtc_queue.cmd_index,
 			reply_buffer, dtc_queue.reply_index
 		);
-		if(usb_err &lt; 0) {
+		if (usb_err &lt; 0) {
 			LOG_ERROR(&quot;dtc_run_download: %s\n&quot;, usb_strerror());
 			exit(1);
 		} else {
@@ -721,7 +721,7 @@
 
 
 				bit_cnt = rq_p-&gt;scan.length;
-				if(bit_cnt &gt;= 8) {
+				if (bit_cnt &gt;= 8) {
 					/* bytes */
 
 					dtc_mask = 1 &lt;&lt; (8 - 1);
@@ -731,20 +731,20 @@
 						bit_cnt;
 						bit_cnt--
 					) {
-						if(*dtc_p &amp; dtc_mask) {
+						if (*dtc_p &amp; dtc_mask) {
 							*tdo_p |= tdo_mask;
 						} else {
 							*tdo_p &amp;=~ tdo_mask;
 						}
 
 						dtc_mask &gt;&gt;= 1;
-						if(dtc_mask == 0) {
+						if (dtc_mask == 0) {
 							dtc_p++;
 							dtc_mask = 1 &lt;&lt; (8 - 1);
 						}
 
 						tdo_mask &lt;&lt;= 1;
-						if(tdo_mask == 0) {
+						if (tdo_mask == 0) {
 							tdo_p++;
 							tdo_mask = 1;
 						}
@@ -753,7 +753,7 @@
 					/*  extra bits or last bit */
 
 					x = *dtc_p++;
-					if((
+					if ((
 						rq_p-&gt;scan.type == SCAN_IN
 					) &amp;&amp; (
 						rq_p-&gt;scan.offset != rq_p-&gt;scan.size - 1
@@ -769,7 +769,7 @@
 						bit_cnt;
 						bit_cnt--
 					) {
-						if(x &amp; dtc_mask) {
+						if (x &amp; dtc_mask) {
 							*tdo_p |= tdo_mask;
 						} else {
 							*tdo_p &amp;=~ tdo_mask;
@@ -778,7 +778,7 @@
 						dtc_mask &gt;&gt;= 1;
 
 						tdo_mask &lt;&lt;= 1;
-						if(tdo_mask == 0) {
+						if (tdo_mask == 0) {
 							tdo_p++;
 							tdo_mask = 1;
 						}
@@ -786,9 +786,9 @@
 					}
 				}
 
-				if((rq_p-&gt;scan.offset + rq_p-&gt;scan.length) &gt;= rq_p-&gt;scan.size) {
+				if ((rq_p-&gt;scan.offset + rq_p-&gt;scan.length) &gt;= rq_p-&gt;scan.size) {
 					/* feed scan buffer back into openocd and free it */
-					if(jtag_read_buffer(rq_p-&gt;scan.buffer, rq_p-&gt;cmd-&gt;cmd.scan) != ERROR_OK) {
+					if (jtag_read_buffer(rq_p-&gt;scan.buffer, rq_p-&gt;cmd-&gt;cmd.scan) != ERROR_OK) {
 						 retval = ERROR_JTAG_QUEUE_FAILED;
 					}
 					free(rq_p-&gt;scan.buffer);
@@ -831,27 +831,27 @@
 	int	retval;
 
 	retval = 0;
-	if(!tap_state_queue.length) return(retval);
+	if (!tap_state_queue.length) return(retval);
 	bits = 1;
 	byte = 0;
 	for(i = tap_state_queue.length; i--;) {
 
 		byte &lt;&lt;= 1;
-		if(tap_state_queue.buffer &amp; 1) {
+		if (tap_state_queue.buffer &amp; 1) {
 			byte |= 1;
 		}
-		if((bits &gt;= 8) || !i) {
+		if ((bits &gt;= 8) || !i) {
 			byte &lt;&lt;= (8 - bits);
 
 			/* make sure there's room for stop, byte op, and one byte */
-			if(dtc_queue.cmd_index &gt;= (sizeof(dtc_queue.cmd_buffer) - (1 + 1 + 1))) {
+			if (dtc_queue.cmd_index &gt;= (sizeof(dtc_queue.cmd_buffer) - (1 + 1 + 1))) {
 				dtc_queue.cmd_buffer[dtc_queue.cmd_index++] =
 					DTC_CMD_STOP;
 				dtc_queue_run();
 			}
 
 #ifdef USE_HARDWARE_SHIFTER_FOR_TMS
-			if(bits == 8) {
+			if (bits == 8) {
 				dtc_queue.cmd_buffer[dtc_queue.cmd_index++] =
 					DTC_CMD_SHIFT_TMS_BYTES(1);
 			} else {
@@ -885,12 +885,12 @@
 ) {
 	int	retval;
 
-	if(tap_state_queue.length &gt;= sizeof(tap_state_queue.buffer) * 8) {
+	if (tap_state_queue.length &gt;= sizeof(tap_state_queue.buffer) * 8) {
 		retval = tap_state_queue_run();
-		if(retval != 0) return(retval);
+		if (retval != 0) return(retval);
 	}
 
-	if(tms) {
+	if (tms) {
 		tap_state_queue.buffer |= (1 &lt;&lt; tap_state_queue.length);
 	}
 	tap_state_queue.length++;
@@ -1005,7 +1005,7 @@
 			ST7_PADR,
 			1
 	);
-	if(usb_err &lt; 0) {
+	if (usb_err &lt; 0) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
@@ -1015,12 +1015,12 @@
 		(char *)&amp;bitmap, 1,
 		USB_TIMEOUT_MS
 	);
-	if(usb_err &lt; 1) {
+	if (usb_err &lt; 1) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
 
-	if(trst) {
+	if (trst) {
 		bitmap &amp;= ~ST7_PA_NTRST;
 	} else {
 		bitmap |= ST7_PA_NTRST;
@@ -1040,7 +1040,7 @@
 			ST7_PBDDR,
 			1
 	);
-	if(usb_err &lt; 0) {
+	if (usb_err &lt; 0) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
@@ -1050,12 +1050,12 @@
 		(char *)&amp;bitmap, 1,
 		USB_TIMEOUT_MS
 	);
-	if(usb_err &lt; 1) {
+	if (usb_err &lt; 1) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
 
-	if(srst) {
+	if (srst) {
 		bitmap |= ST7_PB_NSRST;
 	} else {
 		bitmap &amp;= ~ST7_PB_NSRST;
@@ -1071,7 +1071,7 @@
 			bitmap,
 		EP1_CMD_DTC_GET_CACHED_STATUS
 	);
-	if(usb_err &lt; 0) {
+	if (usb_err &lt; 0) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
@@ -1081,7 +1081,7 @@
 		(char *)&amp;bitmap, 1,
 		USB_TIMEOUT_MS
 	);
-	if(usb_err &lt; 1) {
+	if (usb_err &lt; 1) {
 		LOG_ERROR(&quot;%s&quot;, usb_strerror());
 		exit(1);
 	}
@@ -1108,7 +1108,7 @@
 	uint8_t			tdi_mask, *tdi_p;
 	uint8_t			dtc_mask;
 
-	if(scan_size &lt; 1) {
+	if (scan_size &lt; 1) {
 		LOG_ERROR(&quot;scan_size cannot be less than 1 bit\n&quot;);
 		exit(1);
 	}
@@ -1156,11 +1156,11 @@
 	tdi_p = buffer;
 	tdi_mask = 1;
 
-	if(extra_bits &amp;&amp; (type == SCAN_OUT)) {
+	if (extra_bits &amp;&amp; (type == SCAN_OUT)) {
 		/* Schedule any extra bits into the DTC command buffer, padding as needed */
 		/* For SCAN_OUT, this comes before the full bytes so the (leading) padding bits will fall off the end */
 		/* make sure there's room for stop, byte op, and one byte */
-		if(
+		if (
 			(dtc_queue.cmd_index &gt;= sizeof(dtc_queue.cmd_buffer) - (1 + 1 + 1))
 		) {
 			dtc_queue_run();
@@ -1170,14 +1170,14 @@
 		dtc_mask = 1 &lt;&lt; (extra_bits - 1);
 
 		while(extra_bits--) {
-			if(*tdi_p &amp; tdi_mask) {
+			if (*tdi_p &amp; tdi_mask) {
 				x |= dtc_mask;
 			}
 
 			dtc_mask &gt;&gt;= 1;
 
 			tdi_mask &lt;&lt;= 1;
-			if(tdi_mask == 0) {
+			if (tdi_mask == 0) {
 				tdi_p++;
 				tdi_mask = 1;
 			}
@@ -1191,7 +1191,7 @@
 
 	/* Loop scheduling full bytes into the DTC command buffer */
 	while(byte_bits) {
-		if(type == SCAN_IN) {
+		if (type == SCAN_IN) {
 			/* make sure there's room for stop and byte op */
 			x = (dtc_queue.cmd_index &gt;= sizeof(dtc_queue.cmd_buffer) - (1 + 1));
 		} else {
@@ -1199,36 +1199,36 @@
 			x = (dtc_queue.cmd_index &gt;= sizeof(dtc_queue.cmd_buffer) - (1 + 1 + 1));
 		}
 
-		if(type != SCAN_OUT) {
+		if (type != SCAN_OUT) {
 			/* make sure there's room for at least one reply byte */
 			x |= (dtc_queue.reply_index &gt;= USB_EP2IN_SIZE - (1));
 		}
 
-		if(x) {
+		if (x) {
 			dtc_queue_run();
 		}
 
 		chunk_bits = byte_bits;
 		/* we can only use up to 16 bytes at a time */
-		if(chunk_bits &gt; (16 * 8)) chunk_bits = (16 * 8);
+		if (chunk_bits &gt; (16 * 8)) chunk_bits = (16 * 8);
 
-		if(type != SCAN_IN) {
+		if (type != SCAN_IN) {
 			/* how much is there room for, considering stop and byte op? */
 			x = (sizeof(dtc_queue.cmd_buffer) - (dtc_queue.cmd_index + 1 + 1)) * 8;
-			if(chunk_bits &gt; x) chunk_bits = x;
+			if (chunk_bits &gt; x) chunk_bits = x;
 		}
 
-		if(type != SCAN_OUT) {
+		if (type != SCAN_OUT) {
 			/* how much is there room for in the reply buffer? */
 			x = (USB_EP2IN_SIZE - dtc_queue.reply_index) * 8;
-			if(chunk_bits &gt; x) chunk_bits = x;
+			if (chunk_bits &gt; x) chunk_bits = x;
 		}
 
 		/* so the loop will end */
 		byte_bits -= chunk_bits;
 
-		if(type != SCAN_OUT) {
-			if(dtc_queue_enqueue_reply(
+		if (type != SCAN_OUT) {
+			if (dtc_queue_enqueue_reply(
 				type, buffer, scan_size, tdi_bit_offset,
 				chunk_bits,
 				cmd
@@ -1256,17 +1256,17 @@
 		}
 		dtc_queue.cmd_buffer[dtc_queue.cmd_index++] = x;
 
-		if(type != SCAN_IN) {
+		if (type != SCAN_IN) {
 			x = 0;
 			dtc_mask = 1 &lt;&lt; (8 - 1);
 
 			while(chunk_bits--) {
-				if(*tdi_p &amp; tdi_mask) {
+				if (*tdi_p &amp; tdi_mask) {
 					x |= dtc_mask;
 				}
 
 				dtc_mask &gt;&gt;= 1;
-				if(dtc_mask == 0) {
+				if (dtc_mask == 0) {
 					dtc_queue.cmd_buffer[dtc_queue.cmd_index++] = x;
 					dtc_queue.reply_index++;
 					x = 0;
@@ -1274,7 +1274,7 @@
 				}
 
 				tdi_mask &lt;&lt;= 1;
-				if(tdi_mask == 0) {
+				if (tdi_mask == 0) {
 					tdi_p++;
 					tdi_mask = 1;
 				}
@@ -1282,10 +1282,10 @@
 		}
 	}
 
-	if(extra_bits &amp;&amp; (type != SCAN_OUT)) {
+	if (extra_bits &amp;&amp; (type != SCAN_OUT)) {
 		/* Schedule any extra bits into the DTC command buffer */
 		/* make sure there's room for stop, byte op, and one byte */
-		if(
+		if (
 			(dtc_queue.cmd_index &gt;= sizeof(dtc_queue.cmd_buffer) - (1 + 1 + 1))
 			||
 			(dtc_queue.reply_index &gt;= USB_EP2IN_SIZE - (1))
@@ -1293,7 +1293,7 @@
 			dtc_queue_run();
 		}
 
-		if(dtc_queue_enqueue_reply(
+		if (dtc_queue_enqueue_reply(
 			type, buffer, scan_size, tdi_bit_offset,
 			extra_bits,
 			cmd
@@ -1304,7 +1304,7 @@
 
 		tdi_bit_offset += extra_bits;
 
-		if(type == SCAN_IN) {
+		if (type == SCAN_IN) {
 			dtc_queue.cmd_buffer[dtc_queue.cmd_index++] =
 				DTC_CMD_SHIFT_TDO_BYTES(1);
 
@@ -1316,14 +1316,14 @@
 			dtc_mask = 1 &lt;&lt; (8 - 1);
 
 			while(extra_bits--) {
-				if(*tdi_p &amp; tdi_mask) {
+				if (*tdi_p &amp; tdi_mask) {
 					x |= dtc_mask;
 				}
 
 				dtc_mask &gt;&gt;= 1;
 
 				tdi_mask &lt;&lt;= 1;
-				if(tdi_mask == 0) {
+				if (tdi_mask == 0) {
 					tdi_p++;
 					tdi_mask = 1;
 				}
@@ -1338,7 +1338,7 @@
 	/* Schedule the last bit into the DTC command buffer */
 	{
 		/* make sure there's room for stop, and bit pair command */
-		if(
+		if (
 			(dtc_queue.cmd_index &gt;= sizeof(dtc_queue.cmd_buffer) - (1 + 1))
 			||
 			(dtc_queue.reply_index &gt;= USB_EP2IN_SIZE - (1))
@@ -1346,12 +1346,12 @@
 			dtc_queue_run();
 		}
 
-		if(type == SCAN_OUT) {
+		if (type == SCAN_OUT) {
 			dtc_queue.cmd_buffer[dtc_queue.cmd_index++] =
 				DTC_CMD_SHIFT_TMS_TDI_BIT_PAIR(1, (*tdi_p &amp; tdi_mask), 0);
 
 		} else {
-			if(dtc_queue_enqueue_reply(
+			if (dtc_queue_enqueue_reply(
 				type, buffer, scan_size, tdi_bit_offset,
 				1,
 				cmd
@@ -1455,7 +1455,7 @@
 					rlink_end_state(cmd-&gt;cmd.scan-&gt;end_state);
 				scan_size = jtag_build_buffer(cmd-&gt;cmd.scan, &amp;buffer);
 				type = jtag_scan_type(cmd-&gt;cmd.scan);
-				if(rlink_scan(cmd, type, buffer, scan_size) != ERROR_OK) {
+				if (rlink_scan(cmd, type, buffer, scan_size) != ERROR_OK) {
 					retval = ERROR_FAIL;
 				}
 				break;
@@ -1475,7 +1475,7 @@
 	/* Flush the DTC queue to make sure any pending reads have been done before exiting this function */
 	tap_state_queue_run();
 	tmp_retval = dtc_queue_run();
-	if(tmp_retval != ERROR_OK) {
+	if (tmp_retval != ERROR_OK) {
 		retval = tmp_retval;
 	}
 
@@ -1498,19 +1498,19 @@
 {
 	int		i;
 
-	if(speed == 0) {
+	if (speed == 0) {
 		/* fastest speed */
 		speed = rlink_speed_table[rlink_speed_table_size - 1].prescaler;
 	}
 
 	for(i = rlink_speed_table_size; i--; ) {
-		if(rlink_speed_table[i].prescaler == speed) {
-			if(dtc_load_from_buffer(pHDev, rlink_speed_table[i].dtc, rlink_speed_table[i].dtc_size) != 0) {
+		if (rlink_speed_table[i].prescaler == speed) {
+			if (dtc_load_from_buffer(pHDev, rlink_speed_table[i].dtc, rlink_speed_table[i].dtc_size) != 0) {
 				LOG_ERROR(&quot;An error occurred while trying to load DTC code for speed \&quot;%d\&quot;.\n&quot;, speed);
 				exit(1);
 			}
 
-			if(dtc_start_download() &lt; 0) {
+			if (dtc_start_download() &lt; 0) {
 				LOG_ERROR(&quot;%s, %d: starting DTC: %s&quot;,
 					__FILE__, __LINE__,
 					usb_strerror()
@@ -1535,7 +1535,7 @@
 	int	i;
 
 	for(i = rlink_speed_table_size; i--; ) {
-		if(rlink_speed_table[i].prescaler == speed) {
+		if (rlink_speed_table[i].prescaler == speed) {
 			*khz = rlink_speed_table[i].khz;
 			return(ERROR_OK);
 		}
@@ -1553,13 +1553,13 @@
 ) {
 	int	i;
 
-	if(khz == 0) {
+	if (khz == 0) {
 		LOG_ERROR(&quot;RCLK not supported&quot;);
 		return ERROR_FAIL;
 	}
 
 	for(i = rlink_speed_table_size; i--; ) {
-		if(rlink_speed_table[i].khz &lt;= khz) {
+		if (rlink_speed_table[i].khz &lt;= khz) {
 			*speed = rlink_speed_table[i].prescaler;
 			return(ERROR_OK);
 		}
@@ -1580,7 +1580,7 @@
 	char **args,
 	int argc
 ) {
-	if(argc != 1) {
+	if (argc != 1) {
 		LOG_ERROR(&quot;expected exactly one argument to rlink_dtc_directory &lt;directory-path&gt;&quot;);
 		return(ERROR_INVALID_ARGUMENTS);
 	}
@@ -1636,26 +1636,26 @@
 
 		for(dev = bus-&gt;devices; dev; dev = dev-&gt;next)
 		{
-			if( (dev-&gt;descriptor.idVendor == USB_IDVENDOR) &amp;&amp; (dev-&gt;descriptor.idProduct == USB_IDPRODUCT) )
+			if ( (dev-&gt;descriptor.idVendor == USB_IDVENDOR) &amp;&amp; (dev-&gt;descriptor.idProduct == USB_IDPRODUCT) )
 			{
 				found = 1;
 				LOG_DEBUG(&quot;Found device on bus.\n&quot;);
 
 				do
 				{
-					if( dev-&gt;descriptor.bNumConfigurations &gt; 1 )
+					if ( dev-&gt;descriptor.bNumConfigurations &gt; 1 )
 					{
 						LOG_ERROR(&quot;Whoops! NumConfigurations is not 1, don't know what to do...\n&quot;);
 						break;
 					}
-					if( dev-&gt;config-&gt;bNumInterfaces &gt; 1 )
+					if ( dev-&gt;config-&gt;bNumInterfaces &gt; 1 )
 					{
 						LOG_ERROR(&quot;Whoops! NumInterfaces is not 1, don't know what to do...\n&quot;);
 						break;
 					}
 
 					pHDev=usb_open(dev);
-					if( !pHDev )
+					if ( !pHDev )
 						LOG_ERROR (&quot;Failed to open device.\n&quot;);
 					else
 					{
@@ -1668,12 +1668,12 @@
 						do
 						{
 							i = usb_claim_interface(pHDev,0);
-							if(i)
+							if (i)
 							{
 								LOG_ERROR(&quot;usb_claim_interface: %s&quot;, usb_strerror());
 #ifdef LIBUSB_HAS_DETACH_KERNEL_DRIVER_NP
 								j = usb_detach_kernel_driver_np(pHDev, 0);
-								if(j)
+								if (j)
 									LOG_ERROR(&quot;detach kernel driver: %s&quot;, usb_strerror());
 #endif
 							}
@@ -1684,9 +1684,9 @@
 							}
 						} while(--retries);
 
-						if(!i)
+						if (!i)
 						{
-							if( usb_set_altinterface(pHDev,0) )
+							if ( usb_set_altinterface(pHDev,0) )
 							{
 								LOG_ERROR(&quot;Failed to set interface.\n&quot;);
 								break;
@@ -1700,13 +1700,13 @@
 		}
 	}
 
-	if( !found )
+	if ( !found )
 	{
 		LOG_ERROR(&quot;No device found on bus.\n&quot;);
 		exit(1);
 	}
 
-	if( !success )
+	if ( !success )
 	{
 		LOG_ERROR(&quot;Initialisation failed.&quot;);
 		exit(1);
@@ -1720,7 +1720,7 @@
 			pHDev, 1,
 			EP1_CMD_GET_FWREV
 		);
-		if(j &lt; USB_EP1OUT_SIZE) {
+		if (j &lt; USB_EP1OUT_SIZE) {
 			LOG_ERROR(&quot;USB write error: %s&quot;, usb_strerror());
 			return(ERROR_FAIL);
 		}
@@ -1729,16 +1729,16 @@
 			(char *)reply_buffer, sizeof(reply_buffer),
 			200
 		);
-		if(j != -ETIMEDOUT) break;
+		if (j != -ETIMEDOUT) break;
 	}
 
-	if(j &lt; (int)sizeof(reply_buffer)) {
+	if (j &lt; (int)sizeof(reply_buffer)) {
 		LOG_ERROR(&quot;USB read error: %s&quot;, usb_strerror());
 		return(ERROR_FAIL);
 	}
 	LOG_DEBUG(INTERFACE_NAME&quot; firmware version: %d.%d.%d\n&quot;, reply_buffer[0], reply_buffer[1], reply_buffer[2]);
 
-	if((reply_buffer[0] != 0) || (reply_buffer[1] != 0) || (reply_buffer[2] != 3)) {
+	if ((reply_buffer[0] != 0) || (reply_buffer[1] != 0) || (reply_buffer[2] != 3)) {
 		LOG_WARNING(&quot;The rlink device is not of the version that the developers have played with.  It may or may not work.\n&quot;);
 	}
 
@@ -1769,7 +1769,7 @@
 		USB_TIMEOUT_MS
 	);
 
-	if((reply_buffer[0] &amp; ST7_PE_ADAPTER_SENSE_IN) != 0) {
+	if ((reply_buffer[0] &amp; ST7_PE_ADAPTER_SENSE_IN) != 0) {
 		LOG_WARNING(&quot;target detection problem\n&quot;);
 	}
 
@@ -1795,7 +1795,7 @@
 	);
 
 
-	if((reply_buffer[0] &amp; ST7_PE_ADAPTER_SENSE_IN) == 0) {
+	if ((reply_buffer[0] &amp; ST7_PE_ADAPTER_SENSE_IN) == 0) {
 		LOG_WARNING(&quot;target not plugged in\n&quot;);
 	}
 

Modified: trunk/src/jtag/tcl.c
===================================================================
--- trunk/src/jtag/tcl.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/tcl.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -340,7 +340,7 @@
 	/*
 	 * we expect CHIP + TAP + OPTIONS
 	 * */
-	if( goi-&gt;argc &lt; 3 ){
+	if ( goi-&gt;argc &lt; 3 ){
 		Jim_SetResult_sprintf(goi-&gt;interp, &quot;Missing CHIP TAP OPTIONS ....&quot;);
 		return JIM_ERR;
 	}
@@ -369,7 +369,7 @@
 
 	while( goi-&gt;argc ){
 		e = Jim_GetOpt_Nvp( goi, opts, &amp;n );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			Jim_GetOpt_NvpUnknown( goi, opts, 0 );
 			return e;
 		}
@@ -386,7 +386,7 @@
 			uint32_t *new_expected_ids;
 
 			e = Jim_GetOpt_Wide( goi, &amp;w );
-			if( e != JIM_OK) {
+			if ( e != JIM_OK) {
 				Jim_SetResult_sprintf(goi-&gt;interp, &quot;option: %s bad parameter&quot;, n-&gt;name);
 				return e;
 			}
@@ -410,7 +410,7 @@
 		case NTAP_OPT_IRMASK:
 		case NTAP_OPT_IRCAPTURE:
 			e = Jim_GetOpt_Wide( goi, &amp;w );
-			if( e != JIM_OK ){
+			if ( e != JIM_OK ){
 				Jim_SetResult_sprintf( goi-&gt;interp, &quot;option: %s bad parameter&quot;, n-&gt;name );
 				return e;
 			}
@@ -535,7 +535,7 @@
 	Jim_GetOpt_Setup( &amp;goi, interp, argc-1, argv+1 );
 
 	e = Jim_GetOpt_Nvp( &amp;goi, jtag_cmds, &amp;n );
-	if( e != JIM_OK ){
+	if ( e != JIM_OK ){
 		Jim_GetOpt_NvpUnknown( &amp;goi, jtag_cmds, 0 );
 		return e;
 	}
@@ -545,19 +545,19 @@
 		/* return the name of the interface */
 		/* TCL code might need to know the exact type... */
 		/* FUTURE: we allow this as a means to &quot;set&quot; the interface. */
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 1, goi.argv-1, &quot;(no params)&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResultString( goi.interp, jtag_interface-&gt;name, -1 );
 		return JIM_OK;
 	case JTAG_CMD_INIT_RESET:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 1, goi.argv-1, &quot;(no params)&quot;);
 			return JIM_ERR;
 		}
 		e = jtag_init_reset(context);
-		if( e != ERROR_OK ){
+		if ( e != ERROR_OK ){
 			Jim_SetResult_sprintf( goi.interp, &quot;error: %d&quot;, e);
 			return JIM_ERR;
 		}
@@ -568,7 +568,7 @@
 	case JTAG_CMD_TAPISENABLED:
 	case JTAG_CMD_TAPENABLE:
 	case JTAG_CMD_TAPDISABLE:
-		if( goi.argc != 1 ){
+		if ( goi.argc != 1 ){
 			Jim_SetResultString( goi.interp, &quot;Too many parameters&quot;,-1 );
 			return JIM_ERR;
 		}
@@ -619,7 +619,7 @@
 		break;
 
 	case JTAG_CMD_CGET:
-		if( goi.argc &lt; 2 ){
+		if ( goi.argc &lt; 2 ){
 			Jim_WrongNumArgs( goi.interp, 0, NULL, &quot;?tap-name? -option ...&quot;);
 			return JIM_ERR;
 		}
@@ -629,7 +629,7 @@
 
 			Jim_GetOpt_Obj(&amp;goi, &amp;o);
 			t = jtag_tap_by_jim_obj( goi.interp, o );
-			if( t == NULL ){
+			if ( t == NULL ){
 				return JIM_ERR;
 			}
 
@@ -639,7 +639,7 @@
 		break;
 
 	case JTAG_CMD_CONFIGURE:
-		if( goi.argc &lt; 3 ){
+		if ( goi.argc &lt; 3 ){
 			Jim_WrongNumArgs( goi.interp, 0, NULL, &quot;?tap-name? -option ?VALUE? ...&quot;);
 			return JIM_ERR;
 		}
@@ -649,7 +649,7 @@
 
 			Jim_GetOpt_Obj(&amp;goi, &amp;o);
 			t = jtag_tap_by_jim_obj( goi.interp, o );
-			if( t == NULL ){
+			if ( t == NULL ){
 				return JIM_ERR;
 			}
 
@@ -806,7 +806,7 @@
 	 * argv[ 3] = not actually used by anything but in the docs
 	 */
 
-	if( argc &lt; 4 ){
+	if ( argc &lt; 4 ){
 		command_print( cmd_ctx, &quot;OLD DEPRECATED SYNTAX: Please use the NEW syntax&quot;);
 		return ERROR_OK;
 	}
@@ -847,7 +847,7 @@
 			 Jim_GetString( newargs[9], NULL ) );
 
 	e = jim_jtag_command( interp, 10, newargs );
-	if( e != JIM_OK ){
+	if ( e != JIM_OK ){
 		command_print( cmd_ctx, &quot;%s&quot;, Jim_GetString( Jim_GetResult(interp), NULL ) );
 	}
 	return e;
@@ -1174,20 +1174,20 @@
 	 */
 	endstate = TAP_IDLE;
 
-	if( argc &gt;= 4 ){
+	if ( argc &gt;= 4 ){
 		/* have at least one pair of numbers. */
 		/* is last pair the magic text? */
-		if( 0 == strcmp( &quot;-endstate&quot;, args[ argc - 2 ] ) ){
+		if ( 0 == strcmp( &quot;-endstate&quot;, args[ argc - 2 ] ) ){
 			const char *cpA;
 			const char *cpS;
 			cpA = args[ argc-1 ];
 			for( endstate = 0 ; endstate &lt; TAP_NUM_STATES ; endstate++ ){
 				cpS = tap_state_name( endstate );
-				if( 0 == strcmp( cpA, cpS ) ){
+				if ( 0 == strcmp( cpA, cpS ) ){
 					break;
 				}
 			}
-			if( endstate &gt;= TAP_NUM_STATES ){
+			if ( endstate &gt;= TAP_NUM_STATES ){
 				return ERROR_COMMAND_SYNTAX_ERROR;
 			} else {
 				if (!scan_is_safe(endstate))
@@ -1281,7 +1281,7 @@
 
 		e = Jim_GetLong(interp, args[i], &amp;bits);
 		/* If valid - try next arg */
-		if( e == JIM_OK ){
+		if ( e == JIM_OK ){
 			continue;
 		}
 
@@ -1299,13 +1299,13 @@
 		/* get arg as a string. */
 		cp = Jim_GetString( args[i], NULL );
 		/* is it the magic? */
-		if( 0 == strcmp( &quot;-endstate&quot;, cp ) ){
+		if ( 0 == strcmp( &quot;-endstate&quot;, cp ) ){
 			/* is the statename valid? */
 			cp = Jim_GetString( args[i+1], NULL );
 
 			/* see if it is a valid state name */
 			endstate = tap_state_by_name(cp);
-			if( endstate &lt; 0 ){
+			if ( endstate &lt; 0 ){
 				/* update the error message */
 				Jim_SetResult_sprintf(interp,&quot;endstate: %s invalid&quot;, cp );
 			} else {
@@ -1321,13 +1321,13 @@
 		}
 
 		/* Still an error? */
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			return e; /* too bad */
 		}
 	} /* validate args */
 
 	tap = jtag_tap_by_jim_obj( interp, args[1] );
-	if( tap == NULL ){
+	if ( tap == NULL ){
 		return JIM_ERR;
 	}
 
@@ -1401,7 +1401,7 @@
 		const char *cp;
 		cp = Jim_GetString( args[i+1], NULL );
 		states[i] = tap_state_by_name(cp);
-		if( states[i] &lt; 0 )
+		if ( states[i] &lt; 0 )
 		{
 			/* update the error message */
 			Jim_SetResult_sprintf(interp,&quot;endstate: %s invalid&quot;, cp );

Modified: trunk/src/jtag/usbprog.c
===================================================================
--- trunk/src/jtag/usbprog.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/usbprog.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -591,7 +591,7 @@
 		{
 			send_bits = size;
 			loops = size/8;
-			/* if(loops==0) */
+			/* if (loops==0) */
 			loops++;
 			size = 0;
 		}

Modified: trunk/src/jtag/vsllink.c
===================================================================
--- trunk/src/jtag/vsllink.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/vsllink.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -1201,12 +1201,12 @@
 		{
 			// already in IRSHIFT or DRSHIFT state
 			// merge tms data in the last tms shift command into next scan command
-			if(*vsllink_tms_cmd_pos &lt; 1)
+			if (*vsllink_tms_cmd_pos &lt; 1)
 			{
 				LOG_ERROR(&quot;There MUST be some bugs in the driver&quot;);
 				exit(-1);
 			}
-			else if(*vsllink_tms_cmd_pos &lt; 2)
+			else if (*vsllink_tms_cmd_pos &lt; 2)
 			{
 				tms_tmp = vsllink_usb_out_buffer[vsllink_usb_out_buffer_idx];
 				vsllink_usb_out_buffer_idx--;
@@ -1603,7 +1603,7 @@
 
 	if (vsllink_tms_data_len &gt; 0)
 	{
-		if((tap_get_state() != TAP_RESET) &amp;&amp; (tap_get_state() != TAP_IDLE) &amp;&amp; (tap_get_state() != TAP_IRPAUSE) &amp;&amp; (tap_get_state() != TAP_DRPAUSE))
+		if ((tap_get_state() != TAP_RESET) &amp;&amp; (tap_get_state() != TAP_IDLE) &amp;&amp; (tap_get_state() != TAP_IRPAUSE) &amp;&amp; (tap_get_state() != TAP_DRPAUSE))
 		{
 			LOG_WARNING(&quot;%s is not in RESET or IDLE or PAUSR state&quot;, tap_state_name(tap_get_state()));
 		}

Modified: trunk/src/jtag/zy1000/zy1000.c
===================================================================
--- trunk/src/jtag/zy1000/zy1000.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/jtag/zy1000/zy1000.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -127,7 +127,7 @@
 void zy1000_reset(int trst, int srst)
 {
 	LOG_DEBUG(&quot;zy1000 trst=%d, srst=%d&quot;, trst, srst);
-	if(!srst)
+	if (!srst)
 	{
 		ZY1000_POKE(ZY1000_JTAG_BASE+0x14, 0x00000001);
 	}
@@ -139,7 +139,7 @@
 		ZY1000_POKE(ZY1000_JTAG_BASE+0x10, 0x00000001);
 	}
 
-	if(!trst)
+	if (!trst)
 	{
 		ZY1000_POKE(ZY1000_JTAG_BASE+0x14, 0x00000002);
 	}
@@ -188,7 +188,7 @@
 
 int zy1000_speed(int speed)
 {
-	if(speed == 0)
+	if (speed == 0)
 	{
 		/*0 means RCLK*/
 		speed = 0;
@@ -197,7 +197,7 @@
 	}
 	else
 	{
-		if(speed &gt; 8190 || speed &lt; 2)
+		if (speed &gt; 8190 || speed &lt; 2)
 		{
 			LOG_USER(&quot;valid ZY1000 jtag_speed=[8190,2]. Divisor is 64MHz / even values between 8190-2, i.e. min 7814Hz, max 32MHz&quot;);
 			return ERROR_INVALID_ARGUMENTS;

Modified: trunk/src/server/gdb_server.c
===================================================================
--- trunk/src/server/gdb_server.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/server/gdb_server.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -319,7 +319,7 @@
 			break;
 		if ((retval = gdb_get_char(connection, &amp;reply)) != ERROR_OK)
 			return retval;
-		if( reply == '$' ){
+		if ( reply == '$' ){
 			/* fix a problem with some IAR tools */
 			gdb_putback_char( connection, reply );
 			LOG_DEBUG(&quot;Unexpected start of new packet&quot;);
@@ -349,7 +349,7 @@
 			local_buffer[len++] = '#';
 			local_buffer[len++] = DIGITS[(my_checksum &gt;&gt; 4) &amp; 0xf];
 			local_buffer[len++] = DIGITS[my_checksum &amp; 0xf];
-			if((retval = gdb_write(connection, local_buffer, len)) != ERROR_OK)
+			if ((retval = gdb_write(connection, local_buffer, len)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -361,15 +361,15 @@
 			local_buffer[1] = '#';
 			local_buffer[2] = DIGITS[(my_checksum &gt;&gt; 4) &amp; 0xf];
 			local_buffer[3] = DIGITS[my_checksum &amp; 0xf];
-			if((retval = gdb_write(connection, local_buffer, 1)) != ERROR_OK)
+			if ((retval = gdb_write(connection, local_buffer, 1)) != ERROR_OK)
 			{
 				return retval;
 			}
-			if((retval = gdb_write(connection, buffer, len)) != ERROR_OK)
+			if ((retval = gdb_write(connection, buffer, len)) != ERROR_OK)
 			{
 				return retval;
 			}
-			if((retval = gdb_write(connection, local_buffer+1, 3)) != ERROR_OK)
+			if ((retval = gdb_write(connection, local_buffer+1, 3)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -402,7 +402,7 @@
 				log_remove_callback(gdb_log_callback, connection);
 				LOG_WARNING(&quot;negative reply, retrying&quot;);
 			}
-			else if( reply == '$' ){
+			else if ( reply == '$' ){
 				LOG_ERROR(&quot;GDB missing ack(1) - assumed good&quot;);
 				gdb_putback_char( connection, reply );
 				return ERROR_OK;
@@ -413,7 +413,7 @@
 				return ERROR_SERVER_REMOTE_CLOSED;
 			}
 		}
-		else if( reply == '$' ){
+		else if ( reply == '$' ){
 			LOG_ERROR(&quot;GDB missing ack(2) - assumed good&quot;);
 			gdb_putback_char( connection, reply );
 			return ERROR_OK;
@@ -720,7 +720,7 @@
 			break;
 		case TARGET_EVENT_GDB_FLASH_ERASE_START:
 			target_handle_event( target, TARGET_EVENT_OLD_gdb_program_config );
-			if((retval = jtag_execute_queue()) != ERROR_OK)
+			if ((retval = jtag_execute_queue()) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -1918,7 +1918,7 @@
 		}
 
 		/* create new section with content from packet buffer */
-		if((retval = image_add_section(gdb_connection-&gt;vflash_image, addr, length, 0x0, (uint8_t*)parse)) != ERROR_OK)
+		if ((retval = image_add_section(gdb_connection-&gt;vflash_image, addr, length, 0x0, (uint8_t*)parse)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -2036,8 +2036,8 @@
 		/* terminate with zero */
 		packet[packet_size] = 0;
 
-		if( LOG_LEVEL_IS( LOG_LVL_DEBUG ) ){
-			if( packet[0] == 'X' ){
+		if ( LOG_LEVEL_IS( LOG_LVL_DEBUG ) ){
+			if ( packet[0] == 'X' ){
 				// binary packets spew junk into the debug log stream
 				char buf[ 50 ];
 				int x;

Modified: trunk/src/target/arm720t.c
===================================================================
--- trunk/src/target/arm720t.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/arm720t.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -97,11 +97,11 @@
 	buf_set_u32(out_buf, 0, 32, flip_u32(out, 32));
 
 	jtag_set_end_state(TAP_DRPAUSE);
-	if((retval = arm_jtag_scann(jtag_info, 0xf)) != ERROR_OK)
+	if ((retval = arm_jtag_scann(jtag_info, 0xf)) != ERROR_OK)
 	{
 		return retval;
 	}
-	if((retval = arm_jtag_set_instr(jtag_info, jtag_info-&gt;intest_instr, NULL)) != ERROR_OK)
+	if ((retval = arm_jtag_set_instr(jtag_info, jtag_info-&gt;intest_instr, NULL)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -130,7 +130,7 @@
 		jtag_add_runtest(0, jtag_get_end_state());
 
 #ifdef _DEBUG_INSTRUCTION_EXECUTION_
-	if((retval = jtag_execute_queue()) != ERROR_OK)
+	if ((retval = jtag_execute_queue()) != ERROR_OK)
 	{
 		return retval;
 	}

Modified: trunk/src/target/arm7_9_common.c
===================================================================
--- trunk/src/target/arm7_9_common.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/arm7_9_common.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -469,7 +469,7 @@
 	armv4_5_common_t *armv4_5 = target-&gt;arch_info;
 	arm7_9_common_t *arm7_9 = armv4_5-&gt;arch_info;
 
-	if((retval = arm7_9_unset_breakpoint(target, breakpoint)) != ERROR_OK)
+	if ((retval = arm7_9_unset_breakpoint(target, breakpoint)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -481,7 +481,7 @@
 	if (arm7_9-&gt;breakpoint_count==0)
 	{
 		/* make sure we don't have any dangling breakpoints */
-		if((retval = arm7_9_clear_watchpoints(arm7_9)) != ERROR_OK)
+		if ((retval = arm7_9_clear_watchpoints(arm7_9)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -526,12 +526,12 @@
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_ADDR_VALUE], watchpoint-&gt;address);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_ADDR_MASK], mask);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_DATA_MASK], watchpoint-&gt;mask);
-		if( watchpoint-&gt;mask != 0xffffffffu )
+		if ( watchpoint-&gt;mask != 0xffffffffu )
 			embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_DATA_VALUE], watchpoint-&gt;value);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_CONTROL_MASK], 0xff &amp; ~EICE_W_CTRL_nOPC &amp; ~rw_mask);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_CONTROL_VALUE], EICE_W_CTRL_ENABLE | EICE_W_CTRL_nOPC | (watchpoint-&gt;rw &amp; 1));
 
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -543,12 +543,12 @@
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_ADDR_VALUE], watchpoint-&gt;address);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_ADDR_MASK], mask);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_DATA_MASK], watchpoint-&gt;mask);
-		if( watchpoint-&gt;mask != 0xffffffffu )
+		if ( watchpoint-&gt;mask != 0xffffffffu )
 			embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_DATA_VALUE], watchpoint-&gt;value);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_CONTROL_MASK], 0xff &amp; ~EICE_W_CTRL_nOPC &amp; ~rw_mask);
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_CONTROL_VALUE], EICE_W_CTRL_ENABLE | EICE_W_CTRL_nOPC | (watchpoint-&gt;rw &amp; 1));
 
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -593,7 +593,7 @@
 	if (watchpoint-&gt;set == 1)
 	{
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W0_CONTROL_VALUE], 0x0);
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -602,7 +602,7 @@
 	else if (watchpoint-&gt;set == 2)
 	{
 		embeddedice_set_reg(&amp;arm7_9-&gt;eice_cache-&gt;reg_list[EICE_W1_CONTROL_VALUE], 0x0);
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -663,7 +663,7 @@
 
 	if (watchpoint-&gt;set)
 	{
-		if((retval = arm7_9_unset_watchpoint(target, watchpoint)) != ERROR_OK)
+		if ((retval = arm7_9_unset_watchpoint(target, watchpoint)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -1942,7 +1942,7 @@
 	uint32_t current_pc;
 	current_pc = buf_get_u32(armv4_5-&gt;core_cache-&gt;reg_list[15].value, 0, 32);
 
-	if(next_pc != current_pc)
+	if (next_pc != current_pc)
 	{
 		/* setup an inverse breakpoint on the current PC
 		* - comparator 1 matches the current address
@@ -2297,7 +2297,7 @@
 						retval = arm7_9_execute_fast_sys_speed(target);
 					else
 						retval = arm7_9_execute_sys_speed(target);
-					if(retval != ERROR_OK)
+					if (retval != ERROR_OK)
 					{
 						return retval;
 					}
@@ -2335,7 +2335,7 @@
 						retval = arm7_9_execute_fast_sys_speed(target);
 					else
 						retval = arm7_9_execute_sys_speed(target);
-					if(retval != ERROR_OK)
+					if (retval != ERROR_OK)
 					{
 						return retval;
 					}
@@ -2451,7 +2451,7 @@
 					retval = arm7_9_execute_fast_sys_speed(target);
 				else
 					retval = arm7_9_execute_sys_speed(target);
-				if(retval != ERROR_OK)
+				if (retval != ERROR_OK)
 				{
 					return retval;
 				}
@@ -2487,7 +2487,7 @@
 						retval = arm7_9_execute_fast_sys_speed(target);
 					else
 						retval = arm7_9_execute_sys_speed(target);
-					if(retval != ERROR_OK)
+					if (retval != ERROR_OK)
 					{
 						return retval;
 					}
@@ -2522,7 +2522,7 @@
 						retval = arm7_9_execute_fast_sys_speed(target);
 					else
 						retval = arm7_9_execute_sys_speed(target);
-					if(retval != ERROR_OK)
+					if (retval != ERROR_OK)
 					{
 						return retval;
 					}
@@ -2608,7 +2608,7 @@
 		}
 	}
 
-	if((retval = target_halt(target))!= ERROR_OK)
+	if ((retval = target_halt(target))!= ERROR_OK)
 	{
 		return retval;
 	}
@@ -3087,7 +3087,7 @@
 
 	arm7_9-&gt;common_magic = ARM7_9_COMMON_MAGIC;
 
-	if((retval = arm_jtag_setup_connection(&amp;arm7_9-&gt;jtag_info)) != ERROR_OK)
+	if ((retval = arm_jtag_setup_connection(&amp;arm7_9-&gt;jtag_info)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -3120,12 +3120,12 @@
 	armv4_5-&gt;write_core_reg = arm7_9_write_core_reg;
 	armv4_5-&gt;full_context = arm7_9_full_context;
 
-	if((retval = armv4_5_init_arch_info(target, armv4_5)) != ERROR_OK)
+	if ((retval = armv4_5_init_arch_info(target, armv4_5)) != ERROR_OK)
 	{
 		return retval;
 	}
 
-	if((retval = target_register_timer_callback(arm7_9_handle_target_request, 1, 1, target)) != ERROR_OK)
+	if ((retval = target_register_timer_callback(arm7_9_handle_target_request, 1, 1, target)) != ERROR_OK)
 	{
 		return retval;
 	}

Modified: trunk/src/target/arm7tdmi.c
===================================================================
--- trunk/src/target/arm7tdmi.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/arm7tdmi.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -110,14 +110,14 @@
 		fields[1].out_value = NULL;
 		fields[1].in_value = databus;
 
-		if((retval = arm_jtag_scann(&amp;arm7_9-&gt;jtag_info, 0x1)) != ERROR_OK)
+		if ((retval = arm_jtag_scann(&amp;arm7_9-&gt;jtag_info, 0x1)) != ERROR_OK)
 		{
 			return retval;
 		}
 		arm_jtag_set_instr(&amp;arm7_9-&gt;jtag_info, arm7_9-&gt;jtag_info.intest_instr, NULL);
 
 		jtag_add_dr_scan(2, fields, jtag_set_end_state(TAP_DRPAUSE));
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -171,7 +171,7 @@
 	scan_field_t fields[2];
 
 	jtag_set_end_state(TAP_DRPAUSE);
-	if((retval = arm_jtag_scann(jtag_info, 0x1)) != ERROR_OK)
+	if ((retval = arm_jtag_scann(jtag_info, 0x1)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -195,7 +195,7 @@
 
 #ifdef _DEBUG_INSTRUCTION_EXECUTION_
 {
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -262,7 +262,7 @@
 	scan_field_t fields[2];
 
 	jtag_set_end_state(TAP_DRPAUSE);
-	if((retval = arm_jtag_scann(jtag_info, 0x1)) != ERROR_OK)
+	if ((retval = arm_jtag_scann(jtag_info, 0x1)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -286,7 +286,7 @@
 
 #ifdef _DEBUG_INSTRUCTION_EXECUTION_
 {
-		if((retval = jtag_execute_queue()) != ERROR_OK)
+		if ((retval = jtag_execute_queue()) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/target/arm_jtag.c
===================================================================
--- trunk/src/target/arm_jtag.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/arm_jtag.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -69,7 +69,7 @@
 int arm_jtag_scann(arm_jtag_t *jtag_info, uint32_t new_scan_chain)
 {
 	int retval = ERROR_OK;
-	if(jtag_info-&gt;cur_scan_chain != new_scan_chain)
+	if (jtag_info-&gt;cur_scan_chain != new_scan_chain)
 	{
 		uint32_t values[1];
 		int num_bits[1];
@@ -77,7 +77,7 @@
 		values[0]=new_scan_chain;
 		num_bits[0]=jtag_info-&gt;scann_size;
 
-		if((retval = arm_jtag_set_instr(jtag_info, jtag_info-&gt;scann_instr, NULL)) != ERROR_OK)
+		if ((retval = arm_jtag_set_instr(jtag_info, jtag_info-&gt;scann_instr, NULL)) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/target/arm_simulator.c
===================================================================
--- trunk/src/target/arm_simulator.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/arm_simulator.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -280,11 +280,11 @@
 		uint32_t opcode;
 		
 		/* get current instruction, and identify it */
-		if((retval = target_read_u32(target, current_pc, &amp;opcode)) != ERROR_OK)
+		if ((retval = target_read_u32(target, current_pc, &amp;opcode)) != ERROR_OK)
 		{
 			return retval;
 		}
-		if((retval = arm_evaluate_opcode(opcode, current_pc, &amp;instruction)) != ERROR_OK)
+		if ((retval = arm_evaluate_opcode(opcode, current_pc, &amp;instruction)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -309,11 +309,11 @@
 	{
 		uint16_t opcode;
 		
-		if((retval = target_read_u16(target, current_pc, &amp;opcode)) != ERROR_OK)
+		if ((retval = target_read_u16(target, current_pc, &amp;opcode)) != ERROR_OK)
 		{
 			return retval;
 		}
-		if((retval = thumb_evaluate_opcode(opcode, current_pc, &amp;instruction)) != ERROR_OK)
+		if ((retval = thumb_evaluate_opcode(opcode, current_pc, &amp;instruction)) != ERROR_OK)
 		{
 			return retval;
 			}
@@ -350,7 +350,7 @@
 		else
 		{
 			target = buf_get_u32(ARMV4_5_CORE_REG_MODE(armv4_5-&gt;core_cache, armv4_5-&gt;core_mode, instruction.info.b_bl_bx_blx.reg_operand).value, 0, 32); 
-			if(instruction.info.b_bl_bx_blx.reg_operand == 15)
+			if (instruction.info.b_bl_bx_blx.reg_operand == 15)
 			{
 				target += 2 * instruction_size;
 			}
@@ -545,9 +545,9 @@
 			 load_address = Rn;
 		}
 		
-		if((!dry_run_pc) || (instruction.info.load_store.Rd == 15))
+		if ((!dry_run_pc) || (instruction.info.load_store.Rd == 15))
 		{
-			if((retval = target_read_u32(target, load_address, &amp;load_value)) != ERROR_OK)
+			if ((retval = target_read_u32(target, load_address, &amp;load_value)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -614,7 +614,7 @@
 		{
 			if (instruction.info.load_store_multiple.register_list &amp; (1 &lt;&lt; i))
 			{
-				if((!dry_run_pc) || (i == 15))
+				if ((!dry_run_pc) || (i == 15))
 				{
 					target_read_u32(target, Rn, &amp;load_values[i]);
 				}

Modified: trunk/src/target/armv7m.c
===================================================================
--- trunk/src/target/armv7m.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/armv7m.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -295,7 +295,7 @@
 	int retval;
 	/* This code relies on the target specific  resume() and  poll()-&gt;debug_entry()
 	 * sequence to write register values to the processor and the read them back */
-	if((retval = target_resume(target, 0, entry_point, 1, 1)) != ERROR_OK)
+	if ((retval = target_resume(target, 0, entry_point, 1, 1)) != ERROR_OK)
 	{
 		return retval;
 	}
@@ -409,7 +409,7 @@
 	for (i = 0; i &lt; num_mem_params; i++)
 	{
 		if (mem_params[i].direction != PARAM_OUT)
-			if((retval = target_read_buffer(target, mem_params[i].address, mem_params[i].size, mem_params[i].value)) != ERROR_OK)
+			if ((retval = target_read_buffer(target, mem_params[i].address, mem_params[i].size, mem_params[i].value)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -600,7 +600,7 @@
 
 	/* convert flash writing code into a buffer in target endianness */
 	for (i = 0; i &lt; (sizeof(cortex_m3_crc_code)/sizeof(uint16_t)); i++)
-		if((retval = target_write_u16(target, crc_algorithm-&gt;address + i*sizeof(uint16_t), cortex_m3_crc_code[i])) != ERROR_OK)
+		if ((retval = target_write_u16(target, crc_algorithm-&gt;address + i*sizeof(uint16_t), cortex_m3_crc_code[i])) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/target/cortex_m3.c
===================================================================
--- trunk/src/target/cortex_m3.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/cortex_m3.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -932,11 +932,11 @@
 	{
 		uint8_t code[4];
 		buf_set_u32(code, 0, 32, ARMV7M_T_BKPT(0x11));
-		if((retval = target_read_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+		if ((retval = target_read_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 		{
 			return retval;
 		}
-		if((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, breakpoint-&gt;length, 1, code)) != ERROR_OK)
+		if ((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, breakpoint-&gt;length, 1, code)) != ERROR_OK)
 		{
 			return retval;
 		}
@@ -977,14 +977,14 @@
 		/* restore original instruction (kept in target endianness) */
 		if (breakpoint-&gt;length == 4)
 		{
-			if((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
 		}
 		else
 		{
-			if((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_write_memory(target, breakpoint-&gt;address &amp; 0xFFFFFFFE, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}

Modified: trunk/src/target/feroceon.c
===================================================================
--- trunk/src/target/feroceon.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/feroceon.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -566,7 +566,7 @@
 			target_buffer_set_u32(target, dcc_code_buf + i*4, dcc_code[i]);
 
 		/* write DCC code to working area */
-		if((retval = target_write_memory(target, arm7_9-&gt;dcc_working_area-&gt;address, 4, dcc_size/4, dcc_code_buf)) != ERROR_OK)
+		if ((retval = target_write_memory(target, arm7_9-&gt;dcc_working_area-&gt;address, 4, dcc_size/4, dcc_code_buf)) != ERROR_OK)
 		{
 			return retval;
 		}

Modified: trunk/src/target/image.c
===================================================================
--- trunk/src/target/image.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/image.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -345,7 +345,7 @@
 
 	elf-&gt;header = malloc(sizeof(Elf32_Ehdr));
 
-	if(elf-&gt;header == NULL)
+	if (elf-&gt;header == NULL)
 	{
 		LOG_ERROR(&quot;insufficient memory to perform operation &quot;);
 		return ERROR_FILEIO_OPERATION_FAILED;
@@ -395,7 +395,7 @@
 	}
 
 	elf-&gt;segments = malloc(elf-&gt;segment_count*sizeof(Elf32_Phdr));
-	if(elf-&gt;segments == NULL)
+	if (elf-&gt;segments == NULL)
 	{
 		LOG_ERROR(&quot;insufficient memory to perform operation &quot;);
 		return ERROR_FILEIO_OPERATION_FAILED;
@@ -636,7 +636,7 @@
 		cal_checksum += (uint8_t)checksum;
 		bytes_read += 2;
 
-		if( cal_checksum != 0xFF )
+		if ( cal_checksum != 0xFF )
 		{
 			/* checksum failed */
 			LOG_ERROR(&quot;incorrect record checksum found in S19 file&quot;);

Modified: trunk/src/target/mips32_pracc.c
===================================================================
--- trunk/src/target/mips32_pracc.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/mips32_pracc.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -278,7 +278,7 @@
 		case 2:
 			return mips32_pracc_read_mem16(ejtag_info, addr, count, (uint16_t*)buf);
 		case 4:
-			if(count==1)
+			if (count==1)
 				return mips32_pracc_read_u32(ejtag_info, addr, (uint32_t*)buf);
 			else
 				return mips32_pracc_read_mem32(ejtag_info, addr, count, (uint32_t*)buf);
@@ -562,7 +562,7 @@
 		case 2:
 			return mips32_pracc_write_mem16(ejtag_info, addr, count,(uint16_t*)buf);
 		case 4:
-			if(count==1)
+			if (count==1)
 				return mips32_pracc_write_u32(ejtag_info, addr, (uint32_t*)buf);
 			else
 				return mips32_pracc_write_mem32(ejtag_info, addr, count, (uint32_t*)buf);

Modified: trunk/src/target/mips_ejtag.c
===================================================================
--- trunk/src/target/mips_ejtag.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/mips_ejtag.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -212,7 +212,7 @@
 	ejtag_ctrl = ejtag_info-&gt;ejtag_ctrl;
 	mips_ejtag_drscan_32(ejtag_info, &amp;ejtag_ctrl);
 	LOG_DEBUG(&quot;ejtag_ctrl: 0x%8.8&quot; PRIx32 &quot;&quot;, ejtag_ctrl);
-	if((ejtag_ctrl &amp; EJTAG_CTRL_BRKST) == 0)
+	if ((ejtag_ctrl &amp; EJTAG_CTRL_BRKST) == 0)
 		LOG_DEBUG(&quot;Failed to enter Debug Mode!&quot;);
 
 	return ERROR_OK;
@@ -294,7 +294,7 @@
 		ejtag_info-&gt;impcode &amp; (1&lt;&lt;0)  ? &quot; MIPS64&quot;: &quot; MIPS32&quot;
 	);
 
-	if((ejtag_info-&gt;impcode &amp; (1&lt;&lt;14)) == 0)
+	if ((ejtag_info-&gt;impcode &amp; (1&lt;&lt;14)) == 0)
 		LOG_DEBUG(&quot;EJTAG: DMA Access Mode Support Enabled&quot;);
 
 	/* set initial state for ejtag control reg */

Modified: trunk/src/target/mips_m4k.c
===================================================================
--- trunk/src/target/mips_m4k.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/mips_m4k.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -531,7 +531,7 @@
 		{
 			uint32_t verify = 0xffffffff;
 			
-			if((retval = target_read_memory(target, breakpoint-&gt;address, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_read_memory(target, breakpoint-&gt;address, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -554,7 +554,7 @@
 		{
 			uint16_t verify = 0xffff;
 			
-			if((retval = target_read_memory(target, breakpoint-&gt;address, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_read_memory(target, breakpoint-&gt;address, breakpoint-&gt;length, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -619,7 +619,7 @@
 			}
 			if (current_instr == MIPS32_SDBBP)
 			{
-				if((retval = target_write_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+				if ((retval = target_write_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 				{
 					return retval;
 				}
@@ -637,7 +637,7 @@
 			
 			if (current_instr == MIPS16_SDBBP)
 			{
-				if((retval = target_write_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+				if ((retval = target_write_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 				{
 					return retval;
 				}
@@ -750,7 +750,7 @@
 
 	/* if noDMA off, use DMAACC mode for memory read */
 	int retval;
-	if(ejtag_info-&gt;impcode &amp; EJTAG_IMP_NODMA)
+	if (ejtag_info-&gt;impcode &amp; EJTAG_IMP_NODMA)
 		retval = mips32_pracc_read_mem(ejtag_info, address, size, count, (void *)buffer);
 	else
 		retval = mips32_dmaacc_read_mem(ejtag_info, address, size, count, (void *)buffer);
@@ -825,7 +825,7 @@
 	}	   
 
 	/* if noDMA off, use DMAACC mode for memory write */
-	if(ejtag_info-&gt;impcode &amp; EJTAG_IMP_NODMA)
+	if (ejtag_info-&gt;impcode &amp; EJTAG_IMP_NODMA)
 		return mips32_pracc_write_mem(ejtag_info, address, size, count, (void *)buffer);
 	else
 		return mips32_dmaacc_write_mem(ejtag_info, address, size, count, (void *)buffer);

Modified: trunk/src/target/oocd_trace.c
===================================================================
--- trunk/src/target/oocd_trace.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/oocd_trace.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -104,7 +104,7 @@
 
 	oocd_trace-&gt;tty_fd = open(oocd_trace-&gt;tty, O_RDWR | O_NOCTTY | O_NONBLOCK);
 
-	if(oocd_trace-&gt;tty_fd &lt; 0)
+	if (oocd_trace-&gt;tty_fd &lt; 0)
 	{
 		LOG_ERROR(&quot;can't open tty&quot;);
 		return ERROR_ETM_CAPTURE_INIT_FAILED;

Modified: trunk/src/target/target.c
===================================================================
--- trunk/src/target/target.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/target.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -144,7 +144,7 @@
 	const Jim_Nvp *n;
 
 	n = Jim_Nvp_value2name_simple( nvp_error_target, err );
-	if( n-&gt;name == NULL ){
+	if ( n-&gt;name == NULL ){
 		return &quot;unknown&quot;;
 	} else {
 		return n-&gt;name;
@@ -245,7 +245,7 @@
 	x = -1;
 	t = all_targets;
 	while( t ){
-		if( x &lt; t-&gt;target_number ){
+		if ( x &lt; t-&gt;target_number ){
 			x = (t-&gt;target_number)+1;
 		}
 		t = t-&gt;next;
@@ -263,7 +263,7 @@
 	x = -1;
 	t = all_targets;
 	while(t){
-		if( x &lt; t-&gt;target_number ){
+		if ( x &lt; t-&gt;target_number ){
 			x = t-&gt;target_number;
 		}
 		t = t-&gt;next;
@@ -353,7 +353,7 @@
 	target_t *target = all_targets;
 
 	while (target){
-		if( target-&gt;target_number == num ){
+		if ( target-&gt;target_number == num ){
 			return target;
 		}
 		target = target-&gt;next;
@@ -429,7 +429,7 @@
 	int retval;
 	Jim_Nvp *n;
 	n = Jim_Nvp_value2name_simple( nvp_reset_modes, reset_mode );
-	if( n-&gt;name == NULL ){
+	if ( n-&gt;name == NULL ){
 		LOG_ERROR(&quot;invalid reset mode&quot;);
 		return ERROR_FAIL;
 	}
@@ -446,7 +446,7 @@
 
 	target_continuous_poll = save_poll;
 
-	if(retval != JIM_OK) {
+	if (retval != JIM_OK) {
 		Jim_PrintErrorMessage(interp);
 		return ERROR_FAIL;
 	}
@@ -685,9 +685,9 @@
 
 	if (all_targets)
 	{
-		if((retval = target_register_user_commands(cmd_ctx)) != ERROR_OK)
+		if ((retval = target_register_user_commands(cmd_ctx)) != ERROR_OK)
 			return retval;
-		if((retval = target_register_timer_callback(handle_target, 100, 1, NULL)) != ERROR_OK)
+		if ((retval = target_register_timer_callback(handle_target, 100, 1, NULL)) != ERROR_OK)
 			return retval;
 	}
 
@@ -983,7 +983,7 @@
 		{
 			int retval;
 			new_wa-&gt;backup = malloc(new_wa-&gt;size);
-			if((retval = target_read_memory(target, new_wa-&gt;address, 4, new_wa-&gt;size / 4, new_wa-&gt;backup)) != ERROR_OK)
+			if ((retval = target_read_memory(target, new_wa-&gt;address, 4, new_wa-&gt;size / 4, new_wa-&gt;backup)) != ERROR_OK)
 			{
 				free(new_wa-&gt;backup);
 				free(new_wa);
@@ -1017,7 +1017,7 @@
 	if (restore&amp;&amp;target-&gt;backup_working_area)
 	{
 		int retval;
-		if((retval = target_write_memory(target, area-&gt;address, 4, area-&gt;size / 4, area-&gt;backup)) != ERROR_OK)
+		if ((retval = target_write_memory(target, area-&gt;address, 4, area-&gt;size / 4, area-&gt;backup)) != ERROR_OK)
 			return retval;
 	}
 
@@ -1504,9 +1504,9 @@
 	register_command(cmd_ctx,  NULL, &quot;verify_image&quot;, handle_verify_image_command, COMMAND_EXEC, &quot;verify_image &lt;file&gt; [offset] [type]&quot;);
 	register_command(cmd_ctx,  NULL, &quot;test_image&quot;, handle_test_image_command, COMMAND_EXEC, &quot;test_image &lt;file&gt; [offset] [type]&quot;);
 
-	if((retval = target_request_register_commands(cmd_ctx)) != ERROR_OK)
+	if ((retval = target_request_register_commands(cmd_ctx)) != ERROR_OK)
 		return retval;
-	if((retval = trace_register_commands(cmd_ctx)) != ERROR_OK)
+	if ((retval = trace_register_commands(cmd_ctx)) != ERROR_OK)
 		return retval;
 
 	return retval;
@@ -1703,7 +1703,7 @@
 		if (!powerDropout &amp;&amp; !srstAsserted)
 		{
 			/* polling may fail silently until the target has been examined */
-			if((retval = target_poll(target)) != ERROR_OK)
+			if ((retval = target_poll(target)) != ERROR_OK)
 				return retval;
 		}
 	}
@@ -1983,7 +1983,7 @@
 	{
 		const Jim_Nvp *n;
 		n = Jim_Nvp_name2value_simple( nvp_reset_modes, args[0] );
-		if( (n-&gt;name == NULL) || (n-&gt;value == RESET_UNKNOWN) ){
+		if ( (n-&gt;name == NULL) || (n-&gt;value == RESET_UNKNOWN) ){
 			return ERROR_COMMAND_SYNTAX_ERROR;
 		}
 		reset_mode = n-&gt;value;
@@ -2308,7 +2308,7 @@
 		free(buffer);
 	}
 
-	if((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
+	if ((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
 	{
 		image_close(&amp;image);
 		return retvaltemp;
@@ -2384,10 +2384,10 @@
 		address += this_run_size;
 	}
 
-	if((retvaltemp = fileio_close(&amp;fileio)) != ERROR_OK)
+	if ((retvaltemp = fileio_close(&amp;fileio)) != ERROR_OK)
 		return retvaltemp;
 
-	if((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
+	if ((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
 		return retvaltemp;
 
 	if (retval==ERROR_OK)
@@ -2476,13 +2476,13 @@
 			image_calculate_checksum( buffer, buf_cnt, &amp;checksum );
 
 			retval = target_checksum_memory(target, image.sections[i].base_address, buf_cnt, &amp;mem_checksum);
-			if( retval != ERROR_OK )
+			if ( retval != ERROR_OK )
 			{
 				free(buffer);
 				break;
 			}
 
-			if( checksum != mem_checksum )
+			if ( checksum != mem_checksum )
 			{
 				/* failed crc checksum, fall back to a binary compare */
 				uint8_t *data;
@@ -2538,7 +2538,7 @@
 	}
 done:
 
-	if((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
+	if ((retvaltemp = duration_stop_measure(&amp;duration, &amp;duration_text)) != ERROR_OK)
 	{
 		image_close(&amp;image);
 		return retvaltemp;
@@ -2938,7 +2938,7 @@
 		} else if (target-&gt;state == TARGET_RUNNING)
 		{
 			/* We want to quickly sample the PC. */
-			if((retval = target_halt(target)) != ERROR_OK)
+			if ((retval = target_halt(target)) != ERROR_OK)
 			{
 				free(samples);
 				return retval;
@@ -2958,7 +2958,7 @@
 		if ((numSamples&gt;=maxSample) || ((now.tv_sec &gt;= timeout.tv_sec) &amp;&amp; (now.tv_usec &gt;= timeout.tv_usec)))
 		{
 			command_print(cmd_ctx, &quot;Profiling completed. %d samples.&quot;, numSamples);
-			if((retval = target_poll(target)) != ERROR_OK)
+			if ((retval = target_poll(target)) != ERROR_OK)
 			{
 				free(samples);
 				return retval;
@@ -2967,7 +2967,7 @@
 			{
 				target_resume(target, 1, 0, 0, 0); /* current pc, addr = 0, do not handle breakpoints, not debugging */
 			}
-			if((retval = target_poll(target)) != ERROR_OK)
+			if ((retval = target_poll(target)) != ERROR_OK)
 			{
 				free(samples);
 				return retval;
@@ -3379,7 +3379,7 @@
 
 	done = 0;
 	while( teap ){
-		if( teap-&gt;event == e ){
+		if ( teap-&gt;event == e ){
 			done = 1;
 			LOG_DEBUG( &quot;target: (%d) %s (%s) event: %d (%s) action: %s\n&quot;,
 					   target-&gt;target_number,
@@ -3395,7 +3395,7 @@
 		}
 		teap = teap-&gt;next;
 	}
-	if( !done ){
+	if ( !done ){
 		LOG_DEBUG( &quot;event: %d %s - no action&quot;,
 				   e,
 				   Jim_Nvp_value2name_simple( nvp_target_event, e )-&gt;name );
@@ -3441,34 +3441,34 @@
 		Jim_SetEmptyResult( goi-&gt;interp );
 		/* Jim_GetOpt_Debug( goi ); */
 
-		if( target-&gt;type-&gt;target_jim_configure ){
+		if ( target-&gt;type-&gt;target_jim_configure ){
 			/* target defines a configure function */
 			/* target gets first dibs on parameters */
 			e = (*(target-&gt;type-&gt;target_jim_configure))( target, goi );
-			if( e == JIM_OK ){
+			if ( e == JIM_OK ){
 				/* more? */
 				continue;
 			}
-			if( e == JIM_ERR ){
+			if ( e == JIM_ERR ){
 				/* An error */
 				return e;
 			}
 			/* otherwise we 'continue' below */
 		}
 		e = Jim_GetOpt_Nvp( goi, nvp_config_opts, &amp;n );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			Jim_GetOpt_NvpUnknown( goi, nvp_config_opts, 0 );
 			return e;
 		}
 		switch( n-&gt;value ){
 		case TCFG_TYPE:
 			/* not setable */
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				Jim_SetResult_sprintf( goi-&gt;interp, &quot;not setable: %s&quot;, n-&gt;name );
 				return JIM_ERR;
 			} else {
 			no_params:
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					Jim_WrongNumArgs( goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;NO PARAMS&quot;);
 					return JIM_ERR;
 				}
@@ -3477,24 +3477,24 @@
 			/* loop for more */
 			break;
 		case TCFG_EVENT:
-			if( goi-&gt;argc == 0 ){
+			if ( goi-&gt;argc == 0 ){
 				Jim_WrongNumArgs( goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name? ...&quot;);
 				return JIM_ERR;
 			}
 
 			e = Jim_GetOpt_Nvp( goi, nvp_target_event, &amp;n );
-			if( e != JIM_OK ){
+			if ( e != JIM_OK ){
 				Jim_GetOpt_NvpUnknown( goi, nvp_target_event, 1 );
 				return e;
 			}
 
-			if( goi-&gt;isconfigure ){
-				if( goi-&gt;argc != 1 ){
+			if ( goi-&gt;isconfigure ){
+				if ( goi-&gt;argc != 1 ){
 					Jim_WrongNumArgs( goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name? ?EVENT-BODY?&quot;);
 					return JIM_ERR;
 				}
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					Jim_WrongNumArgs(goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name?&quot;);
 					return JIM_ERR;
 				}
@@ -3506,20 +3506,20 @@
 				teap = target-&gt;event_action;
 				/* replace existing? */
 				while( teap ){
-					if( teap-&gt;event == (enum target_event)n-&gt;value ){
+					if ( teap-&gt;event == (enum target_event)n-&gt;value ){
 						break;
 					}
 					teap = teap-&gt;next;
 				}
 
-				if( goi-&gt;isconfigure ){
-					if( teap == NULL ){
+				if ( goi-&gt;isconfigure ){
+					if ( teap == NULL ){
 						/* create new */
 						teap = calloc( 1, sizeof(*teap) );
 					}
 					teap-&gt;event = n-&gt;value;
 					Jim_GetOpt_Obj( goi, &amp;o );
-					if( teap-&gt;body ){
+					if ( teap-&gt;body ){
 						Jim_DecrRefCount( interp, teap-&gt;body );
 					}
 					teap-&gt;body  = Jim_DuplicateObj( goi-&gt;interp, o );
@@ -3541,7 +3541,7 @@
 					Jim_SetEmptyResult(goi-&gt;interp);
 				} else {
 					/* get */
-					if( teap == NULL ){
+					if ( teap == NULL ){
 						Jim_SetEmptyResult( goi-&gt;interp );
 					} else {
 						Jim_SetResult( goi-&gt;interp, Jim_DuplicateObj( goi-&gt;interp, teap-&gt;body ) );
@@ -3552,15 +3552,15 @@
 			break;
 
 		case TCFG_WORK_AREA_VIRT:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide( goi, &amp;w );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					return e;
 				}
 				target-&gt;working_area_virt = w;
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3569,15 +3569,15 @@
 			break;
 
 		case TCFG_WORK_AREA_PHYS:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide( goi, &amp;w );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					return e;
 				}
 				target-&gt;working_area_phys = w;
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3586,15 +3586,15 @@
 			break;
 
 		case TCFG_WORK_AREA_SIZE:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide( goi, &amp;w );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					return e;
 				}
 				target-&gt;working_area_size = w;
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3603,16 +3603,16 @@
 			break;
 
 		case TCFG_WORK_AREA_BACKUP:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide( goi, &amp;w );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					return e;
 				}
 				/* make this exactly 1 or 0 */
 				target-&gt;backup_working_area = (!!w);
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3621,20 +3621,20 @@
 			break;
 
 		case TCFG_ENDIAN:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				e = Jim_GetOpt_Nvp( goi, nvp_target_endian, &amp;n );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					Jim_GetOpt_NvpUnknown( goi, nvp_target_endian, 1 );
 					return e;
 				}
 				target-&gt;endianness = n-&gt;value;
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
 			n = Jim_Nvp_value2name_simple( nvp_target_endian, target-&gt;endianness );
-			if( n-&gt;name == NULL ){
+			if ( n-&gt;name == NULL ){
 				target-&gt;endianness = TARGET_LITTLE_ENDIAN;
 				n = Jim_Nvp_value2name_simple( nvp_target_endian, target-&gt;endianness );
 			}
@@ -3643,20 +3643,20 @@
 			break;
 
 		case TCFG_VARIANT:
-			if( goi-&gt;isconfigure ){
-				if( goi-&gt;argc &lt; 1 ){
+			if ( goi-&gt;isconfigure ){
+				if ( goi-&gt;argc &lt; 1 ){
 					Jim_SetResult_sprintf( goi-&gt;interp,
 										   &quot;%s ?STRING?&quot;,
 										   n-&gt;name );
 					return JIM_ERR;
 				}
-				if( target-&gt;variant ){
+				if ( target-&gt;variant ){
 					free((void *)(target-&gt;variant));
 				}
 				e = Jim_GetOpt_String( goi, &amp;cp, NULL );
 				target-&gt;variant = strdup(cp);
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3664,22 +3664,22 @@
 			/* loop for more */
 			break;
 		case TCFG_CHAIN_POSITION:
-			if( goi-&gt;isconfigure ){
+			if ( goi-&gt;isconfigure ){
 				Jim_Obj *o;
 				jtag_tap_t *tap;
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Obj( goi, &amp;o );
-				if( e != JIM_OK ){
+				if ( e != JIM_OK ){
 					return e;
 				}
 				tap = jtag_tap_by_jim_obj( goi-&gt;interp, o );
-				if( tap == NULL ){
+				if ( tap == NULL ){
 					return JIM_ERR;
 				}
 				/* make this exactly 1 or 0 */
 				target-&gt;tap = tap;
 			} else {
-				if( goi-&gt;argc != 0 ){
+				if ( goi-&gt;argc != 0 ){
 					goto no_params;
 				}
 			}
@@ -3756,7 +3756,7 @@
 
 	/* commands here are in an NVP table */
 	e = Jim_GetOpt_Nvp( &amp;goi, target_options, &amp;n );
-	if( e != JIM_OK ){
+	if ( e != JIM_OK ){
 		Jim_GetOpt_NvpUnknown( &amp;goi, target_options, 0 );
 		return e;
 	}
@@ -3765,7 +3765,7 @@
 
 	switch( n-&gt;value ){
 	case TS_CMD_CONFIGURE:
-		if( goi.argc &lt; 2 ){
+		if ( goi.argc &lt; 2 ){
 			Jim_WrongNumArgs( goi.interp, goi.argc, goi.argv, &quot;missing: -option VALUE ...&quot;);
 			return JIM_ERR;
 		}
@@ -3773,7 +3773,7 @@
 		return target_configure( &amp;goi, target );
 	case TS_CMD_CGET:
 		// some things take params
-		if( goi.argc &lt; 1 ){
+		if ( goi.argc &lt; 1 ){
 			Jim_WrongNumArgs( goi.interp, 0, goi.argv, &quot;missing: ?-option?&quot;);
 			return JIM_ERR;
 		}
@@ -3789,7 +3789,7 @@
 		 * argv[3] = optional count.
 		 */
 
-		if( (goi.argc == 2) || (goi.argc == 3) ){
+		if ( (goi.argc == 2) || (goi.argc == 3) ){
 			/* all is well */
 		} else {
 		mwx_error:
@@ -3798,17 +3798,17 @@
 		}
 
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;a );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			goto mwx_error;
 		}
 
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;b );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			goto mwx_error;
 		}
 		if (goi.argc == 3) {
 			e = Jim_GetOpt_Wide( &amp;goi, &amp;c );
-			if( e != JIM_OK ){
+			if ( e != JIM_OK ){
 				goto mwx_error;
 			}
 		} else {
@@ -3831,7 +3831,7 @@
 		}
 		for( x = 0 ; x &lt; c ; x++ ){
 			e = target_write_memory( target, a, b, 1, target_buf );
-			if( e != ERROR_OK ){
+			if ( e != ERROR_OK ){
 				Jim_SetResult_sprintf( interp, &quot;Error writing @ 0x%08x: %d\n&quot;, (int)(a), e );
 				return JIM_ERR;
 			}
@@ -3849,17 +3849,17 @@
 		 * argv[1] = address
 		 * argv[2] = optional count
 		 */
-		if( (goi.argc == 2) || (goi.argc == 3) ){
+		if ( (goi.argc == 2) || (goi.argc == 3) ){
 			Jim_SetResult_sprintf( goi.interp, &quot;expected: %s ADDR [COUNT]&quot;, n-&gt;name );
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;a );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			return JIM_ERR;
 		}
-		if( goi.argc ){
+		if ( goi.argc ){
 			e = Jim_GetOpt_Wide( &amp;goi, &amp;c );
-			if( e != JIM_OK ){
+			if ( e != JIM_OK ){
 				return JIM_ERR;
 			}
 		} else {
@@ -3883,11 +3883,11 @@
 		/* count is now in 'BYTES' */
 		while( c &gt; 0 ){
 			y = c;
-			if( y &gt; 16 ){
+			if ( y &gt; 16 ){
 				y = 16;
 			}
 			e = target_read_memory( target, a, b, y / b, target_buf );
-			if( e != ERROR_OK ){
+			if ( e != ERROR_OK ){
 				Jim_SetResult_sprintf( interp, &quot;error reading target @ 0x%08lx&quot;, (int)(a) );
 				return JIM_ERR;
 			}
@@ -3925,7 +3925,7 @@
 			}
 			/* ascii-ify the bytes */
 			for( x = 0 ; x &lt; y ; x++ ){
-				if( (target_buf[x] &gt;= 0x20) &amp;&amp;
+				if ( (target_buf[x] &gt;= 0x20) &amp;&amp;
 					(target_buf[x] &lt;= 0x7e) ){
 					/* good */
 				} else {
@@ -3954,31 +3954,31 @@
 		return target_array2mem( goi.interp, target, goi.argc, goi.argv );
 		break;
 	case TS_CMD_EXAMINE:
-		if( goi.argc ){
+		if ( goi.argc ){
 			Jim_WrongNumArgs( goi.interp, 2, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
 		e = target-&gt;type-&gt;examine( target );
-		if( e != ERROR_OK ){
+		if ( e != ERROR_OK ){
 			Jim_SetResult_sprintf( interp, &quot;examine-fails: %d&quot;, e );
 			return JIM_ERR;
 		}
 		return JIM_OK;
 	case TS_CMD_POLL:
-		if( goi.argc ){
+		if ( goi.argc ){
 			Jim_WrongNumArgs( goi.interp, 2, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
-		if( !(target_was_examined(target)) ){
+		if ( !(target_was_examined(target)) ){
 			e = ERROR_TARGET_NOT_EXAMINED;
 		} else {
 			e = target-&gt;type-&gt;poll( target );
 		}
-		if( e != ERROR_OK ){
+		if ( e != ERROR_OK ){
 			Jim_SetResult_sprintf( interp, &quot;poll-fails: %d&quot;, e );
 			return JIM_ERR;
 		} else {
@@ -3986,18 +3986,18 @@
 		}
 		break;
 	case TS_CMD_RESET:
-		if( goi.argc != 2 ){
+		if ( goi.argc != 2 ){
 			Jim_WrongNumArgs( interp, 2, argv, &quot;t|f|assert|deassert BOOL&quot;);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp( &amp;goi, nvp_assert, &amp;n );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			Jim_GetOpt_NvpUnknown( &amp;goi, nvp_assert, 1 );
 			return e;
 		}
 		/* the halt or not param */
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;a);
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			return e;
 		}
 		if (!target-&gt;tap-&gt;enabled)
@@ -4008,14 +4008,14 @@
 		target_free_all_working_areas_restore(target, 0);
 
 		/* do the assert */
-		if( n-&gt;value == NVP_ASSERT ){
+		if ( n-&gt;value == NVP_ASSERT ){
 			target-&gt;type-&gt;assert_reset( target );
 		} else {
 			target-&gt;type-&gt;deassert_reset( target );
 		}
 		return JIM_OK;
 	case TS_CMD_HALT:
-		if( goi.argc ){
+		if ( goi.argc ){
 			Jim_WrongNumArgs( goi.interp, 0, argv, &quot;halt [no parameters]&quot;);
 			return JIM_ERR;
 		}
@@ -4025,23 +4025,23 @@
 		return JIM_OK;
 	case TS_CMD_WAITSTATE:
 		/* params:  &lt;name&gt;  statename timeoutmsecs */
-		if( goi.argc != 2 ){
+		if ( goi.argc != 2 ){
 			Jim_SetResult_sprintf( goi.interp, &quot;%s STATENAME TIMEOUTMSECS&quot;, n-&gt;name );
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp( &amp;goi, nvp_target_state, &amp;n );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			Jim_GetOpt_NvpUnknown( &amp;goi, nvp_target_state,1 );
 			return e;
 		}
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;a );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			return e;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
 		e = target_wait_state( target, n-&gt;value, a );
-		if( e != ERROR_OK ){
+		if ( e != ERROR_OK ){
 			Jim_SetResult_sprintf( goi.interp,
 								   &quot;target: %s wait %s fails (%d) %s&quot;,
 								   target-&gt;cmd_name,
@@ -4074,7 +4074,7 @@
 			return JIM_OK;
 		}
 	case TS_CMD_CURSTATE:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 0, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
@@ -4082,12 +4082,12 @@
 							 Jim_Nvp_value2name_simple(nvp_target_state,target-&gt;state)-&gt;name,-1);
 		return JIM_OK;
 	case TS_CMD_INVOKE_EVENT:
-		if( goi.argc != 1 ){
+		if ( goi.argc != 1 ){
 			Jim_SetResult_sprintf( goi.interp, &quot;%s ?EVENTNAME?&quot;,n-&gt;name);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp( &amp;goi, nvp_target_event, &amp;n );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			Jim_GetOpt_NvpUnknown( &amp;goi, nvp_target_event, 1 );
 			return e;
 		}
@@ -4113,7 +4113,7 @@
 	struct command_context_s *cmd_ctx;
 
 	cmd_ctx = Jim_GetAssocData(goi-&gt;interp, &quot;context&quot;);
-	if( goi-&gt;argc &lt; 3 ){
+	if ( goi-&gt;argc &lt; 3 ){
 		Jim_WrongNumArgs( goi-&gt;interp, 1, goi-&gt;argv, &quot;?name? ?type? ..options...&quot;);
 		return JIM_ERR;
 	}
@@ -4122,7 +4122,7 @@
 	Jim_GetOpt_Obj( goi, &amp;new_cmd );
 	/* does this command exist? */
 	cmd = Jim_GetCommand( goi-&gt;interp, new_cmd, JIM_ERRMSG );
-	if( cmd ){
+	if ( cmd ){
 		cp = Jim_GetString( new_cmd, NULL );
 		Jim_SetResult_sprintf(goi-&gt;interp, &quot;Command/target: %s Exists&quot;, cp);
 		return JIM_ERR;
@@ -4133,15 +4133,15 @@
 	cp = cp2;
 	/* now does target type exist */
 	for( x = 0 ; target_types[x] ; x++ ){
-		if( 0 == strcmp( cp, target_types[x]-&gt;name ) ){
+		if ( 0 == strcmp( cp, target_types[x]-&gt;name ) ){
 			/* found */
 			break;
 		}
 	}
-	if( target_types[x] == NULL ){
+	if ( target_types[x] == NULL ){
 		Jim_SetResult_sprintf( goi-&gt;interp, &quot;Unknown target type %s, try one of &quot;, cp );
 		for( x = 0 ; target_types[x] ; x++ ){
-			if( target_types[x+1] ){
+			if ( target_types[x+1] ){
 				Jim_AppendStrings( goi-&gt;interp,
 								   Jim_GetResult(goi-&gt;interp),
 								   target_types[x]-&gt;name,
@@ -4209,13 +4209,13 @@
 		e=JIM_ERR;
 	}
 
-	if( e != JIM_OK ){
+	if ( e != JIM_OK ){
 		free( target-&gt;type );
 		free( target );
 		return e;
 	}
 
-	if( target-&gt;endianness == TARGET_ENDIAN_UNKNOWN ){
+	if ( target-&gt;endianness == TARGET_ENDIAN_UNKNOWN ){
 		/* default endian to little if not specified */
 		target-&gt;endianness = TARGET_LITTLE_ENDIAN;
 	}
@@ -4225,10 +4225,10 @@
 		target-&gt;variant = strdup(&quot;&quot;);
 
 	/* create the target specific commands */
-	if( target-&gt;type-&gt;register_commands ){
+	if ( target-&gt;type-&gt;register_commands ){
 		(*(target-&gt;type-&gt;register_commands))( cmd_ctx );
 	}
-	if( target-&gt;type-&gt;target_create ){
+	if ( target-&gt;type-&gt;target_create ){
 		(*(target-&gt;type-&gt;target_create))( target, goi-&gt;interp );
 	}
 
@@ -4285,14 +4285,14 @@
 
 	Jim_GetOpt_Setup( &amp;goi, interp, argc-1, argv+1 );
 
-	if( goi.argc == 0 ){
+	if ( goi.argc == 0 ){
 		Jim_WrongNumArgs(interp, 1, argv, &quot;missing: command ...&quot;);
 		return JIM_ERR;
 	}
 
 	/* Jim_GetOpt_Debug( &amp;goi ); */
 	r = Jim_GetOpt_Enum( &amp;goi, target_cmds, &amp;x   );
-	if( r != JIM_OK ){
+	if ( r != JIM_OK ){
 		return r;
 	}
 
@@ -4301,14 +4301,14 @@
 		Jim_Panic(goi.interp,&quot;Why am I here?&quot;);
 		return JIM_ERR;
 	case TG_CMD_CURRENT:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 1, goi.argv, &quot;Too many parameters&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResultString( goi.interp, get_current_target( cmd_ctx )-&gt;cmd_name, -1 );
 		return JIM_OK;
 	case TG_CMD_TYPES:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 1, goi.argv, &quot;Too many parameters&quot; );
 			return JIM_ERR;
 		}
@@ -4320,7 +4320,7 @@
 		}
 		return JIM_OK;
 	case TG_CMD_NAMES:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 1, goi.argv, &quot;Too many parameters&quot; );
 			return JIM_ERR;
 		}
@@ -4334,25 +4334,25 @@
 		}
 		return JIM_OK;
 	case TG_CMD_CREATE:
-		if( goi.argc &lt; 3 ){
+		if ( goi.argc &lt; 3 ){
 			Jim_WrongNumArgs( goi.interp, goi.argc, goi.argv, &quot;?name  ... config options ...&quot;);
 			return JIM_ERR;
 		}
 		return target_create( &amp;goi );
 		break;
 	case TG_CMD_NUMBER:
-		if( goi.argc != 1 ){
+		if ( goi.argc != 1 ){
 			Jim_SetResult_sprintf( goi.interp, &quot;expected: target number ?NUMBER?&quot;);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Wide( &amp;goi, &amp;w );
-		if( e != JIM_OK ){
+		if ( e != JIM_OK ){
 			return JIM_ERR;
 		}
 		{
 			target_t *t;
 			t = get_target_by_num(w);
-			if( t == NULL ){
+			if ( t == NULL ){
 				Jim_SetResult_sprintf( goi.interp,&quot;Target: number %d does not exist&quot;, (int)(w));
 				return JIM_ERR;
 			}
@@ -4360,7 +4360,7 @@
 			return JIM_OK;
 		}
 	case TG_CMD_COUNT:
-		if( goi.argc != 0 ){
+		if ( goi.argc != 0 ){
 			Jim_WrongNumArgs( goi.interp, 0, goi.argv, &quot;&lt;no parameters&gt;&quot;);
 			return JIM_ERR;
 		}

Modified: trunk/src/target/xscale.c
===================================================================
--- trunk/src/target/xscale.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/target/xscale.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -2189,12 +2189,12 @@
 		if (breakpoint-&gt;length == 4)
 		{
 			/* keep the original instruction in target endianness */
-			if((retval = target_read_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_read_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
 			/* write the original instruction in target endianness (arm7_9-&gt;arm_bkpt is host endian) */
-			if((retval = target_write_u32(target, breakpoint-&gt;address, xscale-&gt;arm_bkpt)) != ERROR_OK)
+			if ((retval = target_write_u32(target, breakpoint-&gt;address, xscale-&gt;arm_bkpt)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -2202,12 +2202,12 @@
 		else
 		{
 			/* keep the original instruction in target endianness */
-			if((retval = target_read_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_read_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
 			/* write the original instruction in target endianness (arm7_9-&gt;arm_bkpt is host endian) */
-			if((retval = target_write_u32(target, breakpoint-&gt;address, xscale-&gt;thumb_bkpt)) != ERROR_OK)
+			if ((retval = target_write_u32(target, breakpoint-&gt;address, xscale-&gt;thumb_bkpt)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -2286,14 +2286,14 @@
 		/* restore original instruction (kept in target endianness) */
 		if (breakpoint-&gt;length == 4)
 		{
-			if((retval = target_write_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_write_memory(target, breakpoint-&gt;address, 4, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
 		}
 		else
 		{
-			if((retval = target_write_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
+			if ((retval = target_write_memory(target, breakpoint-&gt;address, 2, 1, breakpoint-&gt;orig_instr)) != ERROR_OK)
 			{
 				return retval;
 			}
@@ -3606,7 +3606,7 @@
 	}
 	uint32_t reg_no = 0;
 	reg_t *reg = NULL;
-	if(argc &gt; 0)
+	if (argc &gt; 0)
 	{
 		reg_no = strtoul(args[0], NULL, 0);
 		/*translate from xscale cp15 register no to openocd register*/
@@ -3643,7 +3643,7 @@
 		reg = &amp;xscale-&gt;reg_cache-&gt;reg_list[reg_no];
 
 	}
-	if(argc == 1)
+	if (argc == 1)
 	{
 		uint32_t value;
 
@@ -3652,7 +3652,7 @@
 		value = buf_get_u32(reg-&gt;value, 0, 32);
 		command_print(cmd_ctx, &quot;%s (/%i): 0x%&quot; PRIx32 &quot;&quot;, reg-&gt;name, (int)(reg-&gt;size), value);
 	}
-	else if(argc == 2)
+	else if (argc == 2)
 	{
 
 		uint32_t value = strtoul(args[1], NULL, 0);

Modified: trunk/src/xsvf/xsvf.c
===================================================================
--- trunk/src/xsvf/xsvf.c	2009-06-23 07:38:01 UTC (rev 2356)
+++ trunk/src/xsvf/xsvf.c	2009-06-23 22:35:09 UTC (rev 2357)
@@ -327,9 +327,9 @@
 				xsdrsize = be_to_h_u32(xsdrsize_buf);
 				LOG_DEBUG(&quot;XSDRSIZE %d&quot;, xsdrsize);
 
-				if( dr_out_buf ) free(dr_out_buf);
-				if( dr_in_buf)   free(dr_in_buf);
-				if( dr_in_mask)  free(dr_in_mask);
+				if ( dr_out_buf ) free(dr_out_buf);
+				if ( dr_in_buf)   free(dr_in_buf);
+				if ( dr_in_mask)  free(dr_in_mask);
 
 				dr_out_buf = malloc((xsdrsize + 7) / 8);
 				dr_in_buf = malloc((xsdrsize + 7) / 8);
@@ -354,7 +354,7 @@
 
 				if (opcode == XSDRTDO)
 				{
-					if(xsvf_read_buffer(xsdrsize, xsvf_fd, dr_in_buf)  != ERROR_OK )
+					if (xsvf_read_buffer(xsdrsize, xsvf_fd, dr_in_buf)  != ERROR_OK )
 					{
 						do_abort = 1;
 						break;
@@ -370,7 +370,7 @@
 				{
 					scan_field_t field;
 
-					if( attempt&gt;0 )
+					if ( attempt&gt;0 )
 					{
 						/* perform the XC9500 exception handling sequence shown in xapp067.pdf and
 						   illustrated in psuedo code at end of this file.  We start from state
@@ -505,7 +505,7 @@
 					the XSTATE.
 				*/
 
-				if( jtag_add_statemove( mystate ) != ERROR_OK )
+				if ( jtag_add_statemove( mystate ) != ERROR_OK )
 				{
 					/*	For special states known as stable states
 						(Test-Logic-Reset, Run-Test/Idle, Pause-DR, Pause- IR),
@@ -538,9 +538,9 @@
 			}
 
 			/* see page 22 of XSVF spec */
-			if( uc == 0 )
+			if ( uc == 0 )
 				xendir = TAP_IDLE;
-			else if( uc == 1 )
+			else if ( uc == 1 )
 				xendir = TAP_IRPAUSE;
 			else
 			{
@@ -561,9 +561,9 @@
 			}
 
 			/* see page 22 of XSVF spec */
-			if( uc == 0 )
+			if ( uc == 0 )
 				xenddr = TAP_IDLE;
-			else if( uc == 1 )
+			else if ( uc == 1 )
 				xenddr = TAP_DRPAUSE;
 			else
 			{
@@ -583,7 +583,7 @@
 				int bitcount;
 				tap_state_t my_end_state = xruntest ? TAP_IDLE : xendir;
 
-				if( opcode == XSIR )
+				if ( opcode == XSIR )
 				{
 					/* one byte bitcount */
 					if (read(xsvf_fd, short_buf, 1) &lt; 0)
@@ -642,7 +642,7 @@
 
 					/* LOG_DEBUG(&quot;FLUSHING QUEUE&quot;); */
 					result = jtag_execute_queue();
-					if(result != ERROR_OK)
+					if (result != ERROR_OK)
 					{
 						tdo_mismatch = 1;
 					}
@@ -864,7 +864,7 @@
 
 					/* LOG_DEBUG(&quot;FLUSHING QUEUE&quot;); */
 					result = jtag_execute_queue();
-					if(result == ERROR_OK)
+					if (result == ERROR_OK)
 					{
 						matched = 1;
 						break;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001140.html">[Openocd-svn] r2356 - trunk/src/helper
</A></li>
	<LI>Next message: <A HREF="001142.html">[Openocd-svn] r2358 - in trunk: src/flash src/helper src/jtag	src/jtag/rlink src/server src/target src/xsvf	testing/examples/PIC32 testing/examples/ledtest-imx27ads	testing/examples/ledtest-imx31pdk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1141">[ date ]</a>
              <a href="thread.html#1141">[ thread ]</a>
              <a href="subject.html#1141">[ subject ]</a>
              <a href="author.html#1141">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
