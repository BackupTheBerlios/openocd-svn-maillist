<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-svn] r2378 - in trunk/src: flash helper jtag pld server	target
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2378%20-%20in%20trunk/src%3A%20flash%20helper%20jtag%20pld%20server%0A%09target&In-Reply-To=%3C200906232249.n5NMnHB4022878%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001161.html">
   <LINK REL="Next"  HREF="001163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-svn] r2378 - in trunk/src: flash helper jtag pld server	target</H1>
    <B>zwelch at mail.berlios.de</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2378%20-%20in%20trunk/src%3A%20flash%20helper%20jtag%20pld%20server%0A%09target&In-Reply-To=%3C200906232249.n5NMnHB4022878%40sheep.berlios.de%3E"
       TITLE="[Openocd-svn] r2378 - in trunk/src: flash helper jtag pld server	target">zwelch at mail.berlios.de
       </A><BR>
    <I>Wed Jun 24 00:49:17 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001161.html">[Openocd-svn] r2377 - in trunk/src: . flash flash/ocl/at91sam7x	helper jtag jtag/rlink jtag/zy1000 pld server svf target xsvf
</A></li>
        <LI>Next message: <A HREF="001163.html">[Openocd-svn] r2379 - in trunk/src: flash flash/ocl/at91sam7x	target target/xscale
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1162">[ date ]</a>
              <a href="thread.html#1162">[ thread ]</a>
              <a href="subject.html#1162">[ subject ]</a>
              <a href="author.html#1162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zwelch
Date: 2009-06-24 00:49:06 +0200 (Wed, 24 Jun 2009)
New Revision: 2378

Modified:
   trunk/src/flash/str7x.c
   trunk/src/flash/str9xpec.c
   trunk/src/helper/command.c
   trunk/src/helper/jim.c
   trunk/src/helper/jim.h
   trunk/src/jtag/core.c
   trunk/src/jtag/interface.c
   trunk/src/jtag/tcl.c
   trunk/src/pld/xilinx_bit.c
   trunk/src/server/gdb_server.c
   trunk/src/target/target.c
Log:
- Replace '){' with ') {'.


Modified: trunk/src/flash/str7x.c
===================================================================
--- trunk/src/flash/str7x.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/flash/str7x.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -273,7 +273,7 @@
 	cmd = FLASH_SER | FLASH_WMS;
 	target_write_u32(target, str7x_get_flash_adr(bank, FLASH_CR0), cmd);
 	
-	while (((retval = str7x_status(bank)) &amp; str7x_info-&gt;busy_bits)){
+	while (((retval = str7x_status(bank)) &amp; str7x_info-&gt;busy_bits)) {
 		alive_sleep(1);
 	}
 	
@@ -329,7 +329,7 @@
 	cmd = FLASH_SPR | FLASH_WMS;
 	target_write_u32(target, str7x_get_flash_adr(bank, FLASH_CR0), cmd);
 	
-	while (((retval = str7x_status(bank)) &amp; str7x_info-&gt;busy_bits)){
+	while (((retval = str7x_status(bank)) &amp; str7x_info-&gt;busy_bits)) {
 		alive_sleep(1);
 	}
 	

Modified: trunk/src/flash/str9xpec.c
===================================================================
--- trunk/src/flash/str9xpec.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/flash/str9xpec.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -101,7 +101,7 @@
 
 int str9xpec_set_instr(jtag_tap_t *tap, uint32_t new_instr, tap_state_t end_state)
 {
-	if (tap == NULL){
+	if (tap == NULL) {
 		return ERROR_TARGET_INVALID;
 	}
 
@@ -671,11 +671,11 @@
 				check_address = sec_end;
 		}
 
-		if ((offset &gt;= sec_start) &amp;&amp; (offset &lt; sec_end)){
+		if ((offset &gt;= sec_start) &amp;&amp; (offset &lt; sec_end)) {
 			first_sector = i;
 		}
 
-		if ((offset + count &gt;= sec_start) &amp;&amp; (offset + count &lt; sec_end)){
+		if ((offset + count &gt;= sec_start) &amp;&amp; (offset + count &lt; sec_end)) {
 			last_sector = i;
 		}
 	}

Modified: trunk/src/helper/command.c
===================================================================
--- trunk/src/helper/command.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/helper/command.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -348,7 +348,7 @@
 
 void command_output_text(command_context_t *context, const char *data)
 {
-	if (context &amp;&amp; context-&gt;output_handler &amp;&amp; data){
+	if (context &amp;&amp; context-&gt;output_handler &amp;&amp; data) {
 		context-&gt;output_handler(context, data);
 	}
 }

Modified: trunk/src/helper/jim.c
===================================================================
--- trunk/src/helper/jim.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/helper/jim.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -544,7 +544,7 @@
 #endif
 	
 	/* This may actually crash... we do it last */
-	if (interp &amp;&amp; interp-&gt;cookie_stderr){
+	if (interp &amp;&amp; interp-&gt;cookie_stderr) {
 		Jim_fprintf(interp, interp-&gt;cookie_stderr, JIM_NL &quot;JIM INTERPRETER PANIC: &quot;);
 		Jim_vfprintf(interp, interp-&gt;cookie_stderr, fmt, ap);
 		Jim_fprintf(interp, interp-&gt;cookie_stderr, JIM_NL JIM_NL);
@@ -2064,7 +2064,7 @@
 	buf = jim_vasprintf(fmt, ap);
 	va_end(ap);
 
-	if (buf){
+	if (buf) {
 		Jim_AppendString(interp, objPtr, buf, -1);
 		jim_vasprintf_done(buf);
 	}
@@ -2283,10 +2283,10 @@
 		haveprec = 0;
 		prec = -1; /* not found yet */
     next_fmt:
-		if (fmtLen &lt;= 0){
+		if (fmtLen &lt;= 0) {
 			break;
 		}
-		switch (*fmt){
+		switch (*fmt) {
 			/* terminals */
         case 'b': /* binary - not all printfs() do this */
 		case 's': /* string */
@@ -2341,11 +2341,11 @@
 		case '8':
 		case '9':
 			accum = 0;
-			while (isdigit(*fmt) &amp;&amp; (fmtLen &gt; 0)){
+			while (isdigit(*fmt) &amp;&amp; (fmtLen &gt; 0)) {
 				accum = (accum * 10) + (*fmt - '0');
 				fmt++;  fmtLen--;
 			}
-			if (inprec){
+			if (inprec) {
 				haveprec = 1;
 				prec = accum;
 			} else {
@@ -2356,24 +2356,24 @@
 			/* suck up the next item as an integer */
 			fmt++;  fmtLen--;
 			objc--;
-			if (objc &lt;= 0){
+			if (objc &lt;= 0) {
 				goto not_enough_args;
 			}
-			if (Jim_GetWide(interp,objv[0],&amp;wideValue)== JIM_ERR){
+			if (Jim_GetWide(interp,objv[0],&amp;wideValue)== JIM_ERR) {
 				Jim_FreeNewObj(interp, resObjPtr);
 				return NULL;
 			}
-			if (inprec){
+			if (inprec) {
 				haveprec = 1;
 				prec = wideValue;
-				if (prec &lt; 0){
+				if (prec &lt; 0) {
 					/* man 3 printf says */
 					/* if prec is negative, it is zero */
 					prec = 0;
 				}
 			} else {
 			width = wideValue;
-			if (width &lt; 0){
+			if (width &lt; 0) {
 				ljust = 1;
 				width = -width;
 			}
@@ -2402,32 +2402,32 @@
 		 */
 		cp = fmt_str;
 		*cp++ = '%';
-		if (altfm){
+		if (altfm) {
 			*cp++ = '#';
 		}
-		if (forceplus){
+		if (forceplus) {
 			*cp++ = '+';
-		} else if (spad){
+		} else if (spad) {
 			/* PLUS overrides */
 			*cp++ = ' ';
 		}
-		if (ljust){
+		if (ljust) {
 			*cp++ = '-';
 		}
-		if (zpad){
+		if (zpad) {
 			*cp++ = '0';
 		}
-		if (width &gt; 0){
+		if (width &gt; 0) {
 			sprintf(cp, &quot;%d&quot;, width);
 			/* skip ahead */
 			cp = strchr(cp,0);
 		}
 		/* did we find a period? */
-		if (inprec){
+		if (inprec) {
 			/* then add it */
 			*cp++ = '.';
 			/* did something occur after the period? */
-			if (haveprec){
+			if (haveprec) {
 				sprintf(cp, &quot;%d&quot;, prec);
 			}
 			cp = strchr(cp,0);
@@ -2461,7 +2461,7 @@
 		case 'E':
 			*cp++ = *fmt;
 			*cp   = 0;
-			if (Jim_GetDouble(interp, objv[0], &amp;doubleValue) == JIM_ERR){
+			if (Jim_GetDouble(interp, objv[0], &amp;doubleValue) == JIM_ERR) {
 				Jim_FreeNewObj(interp, resObjPtr);
 				return NULL;
 			}
@@ -2475,7 +2475,7 @@
 		case 'x':
 		case 'X':
 			/* jim widevaluse are 64bit */
-			if (sizeof(jim_wide) == sizeof(long long)){
+			if (sizeof(jim_wide) == sizeof(long long)) {
 				*cp++ = 'l'; 
 				*cp++ = 'l';
 			} else {
@@ -2627,12 +2627,12 @@
 	int e;
 
 	e = Jim_Nvp_name2value_obj(interp, nvp_table, objPtr, &amp;n);
-	if (e == JIM_ERR){
+	if (e == JIM_ERR) {
 		return e;
 	}
 
 	/* Success? found? */
-	if (n-&gt;name){
+	if (n-&gt;name) {
 		/* remove const */
 		*result = (Jim_Nvp *)n;
 		return JIM_OK;
@@ -8894,7 +8894,7 @@
     Jim_IncrRefCount(scriptObjPtr);
 
 
-	if (filename){
+	if (filename) {
 		JimSetSourceInfo(interp, scriptObjPtr, filename, lineno);
 	}
 
@@ -12412,7 +12412,7 @@
 
 int Jim_vfprintf(Jim_Interp *interp, void *cookie, const char *fmt, va_list ap)
 {
-	if ((interp == NULL) || (interp-&gt;cb_vfprintf == NULL)){
+	if ((interp == NULL) || (interp-&gt;cb_vfprintf == NULL)) {
 		errno = ENOTSUP;
 		return -1;
 	}
@@ -12421,7 +12421,7 @@
 
 size_t Jim_fwrite(Jim_Interp *interp, const void *ptr, size_t size, size_t n, void *cookie)
 {
-	if ((interp == NULL) || (interp-&gt;cb_fwrite == NULL)){
+	if ((interp == NULL) || (interp-&gt;cb_fwrite == NULL)) {
 		errno = ENOTSUP;
 		return 0;
 	}
@@ -12430,7 +12430,7 @@
 
 size_t Jim_fread(Jim_Interp *interp, void *ptr, size_t size, size_t n, void *cookie)
 {
-	if ((interp == NULL) || (interp-&gt;cb_fread == NULL)){
+	if ((interp == NULL) || (interp-&gt;cb_fread == NULL)) {
 		errno = ENOTSUP;
 		return 0;
 	}
@@ -12439,7 +12439,7 @@
 
 int Jim_fflush(Jim_Interp *interp, void *cookie)
 {
-	if ((interp == NULL) || (interp-&gt;cb_fflush == NULL)){
+	if ((interp == NULL) || (interp-&gt;cb_fflush == NULL)) {
 		/* pretend all is well */
 		return 0;
 	}
@@ -12448,7 +12448,7 @@
 
 char* Jim_fgets(Jim_Interp *interp, char *s, int size, void *cookie)
 {
-	if ((interp == NULL) || (interp-&gt;cb_fgets == NULL)){
+	if ((interp == NULL) || (interp-&gt;cb_fgets == NULL)) {
 		errno = ENOTSUP;
 		return NULL;
 	}
@@ -12457,8 +12457,8 @@
 Jim_Nvp *
 Jim_Nvp_name2value_simple(const Jim_Nvp *p, const char *name)
 {
-	while (p-&gt;name){
-		if (0 == strcmp(name, p-&gt;name)){
+	while (p-&gt;name) {
+		if (0 == strcmp(name, p-&gt;name)) {
 			break;
 		}
 		p++;
@@ -12469,8 +12469,8 @@
 Jim_Nvp *
 Jim_Nvp_name2value_nocase_simple(const Jim_Nvp *p, const char *name)
 {
-	while (p-&gt;name){
-		if (0 == strcasecmp(name, p-&gt;name)){
+	while (p-&gt;name) {
+		if (0 == strcasecmp(name, p-&gt;name)) {
 			break;
 		}
 		p++;
@@ -12499,12 +12499,12 @@
 	p = Jim_Nvp_name2value_simple(_p, name);
 
 	/* result */
-	if (result){
+	if (result) {
 		*result = (Jim_Nvp *)(p);
 	}
 	
 	/* found? */
-	if (p-&gt;name){
+	if (p-&gt;name) {
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12524,11 +12524,11 @@
 
 	p = Jim_Nvp_name2value_nocase_simple(_p, name);
 
-	if (puthere){
+	if (puthere) {
 		*puthere = (Jim_Nvp *)(p);
 	}
 	/* found */
-	if (p-&gt;name){
+	if (p-&gt;name) {
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12543,7 +12543,7 @@
 	jim_wide w;
 
 	e = Jim_GetWide(interp, o, &amp;w);
-	if (e != JIM_OK){
+	if (e != JIM_OK) {
 		return e;
 	}
 
@@ -12553,8 +12553,8 @@
 Jim_Nvp *
 Jim_Nvp_value2name_simple(const Jim_Nvp *p, int value)
 {
-	while (p-&gt;name){
-		if (value == p-&gt;value){
+	while (p-&gt;name) {
+		if (value == p-&gt;value) {
 			break;
 		}
 		p++;
@@ -12570,11 +12570,11 @@
 
 	p = Jim_Nvp_value2name_simple(_p, value);
 
-	if (result){
+	if (result) {
 		*result = (Jim_Nvp *)(p);
 	}
 
-	if (p-&gt;name){
+	if (p-&gt;name) {
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12599,7 +12599,7 @@
 	int x;
 
 	Jim_fprintf(p-&gt;interp, p-&gt;interp-&gt;cookie_stderr, &quot;---args---\n&quot;);
-	for (x = 0 ; x &lt; p-&gt;argc ; x++){
+	for (x = 0 ; x &lt; p-&gt;argc ; x++) {
 		Jim_fprintf(p-&gt;interp, p-&gt;interp-&gt;cookie_stderr, 
 					 &quot;%2d) %s\n&quot;, 
 					 x, 
@@ -12615,16 +12615,16 @@
 	Jim_Obj *o;
 	
 	o = NULL; // failure 
-	if (goi-&gt;argc){
+	if (goi-&gt;argc) {
 		// success 
 		o = goi-&gt;argv[0];
 		goi-&gt;argc -= 1;
 		goi-&gt;argv += 1;
 	}
-	if (puthere){
+	if (puthere) {
 		*puthere = o;
 	}
-	if (o != NULL){
+	if (o != NULL) {
 		return JIM_OK;
 	} else {
 		return JIM_ERR;
@@ -12640,9 +12640,9 @@
 
 
 	r = Jim_GetOpt_Obj(goi, &amp;o);
-	if (r == JIM_OK){
+	if (r == JIM_OK) {
 		cp = Jim_GetString(o, len);
-		if (puthere){
+		if (puthere) {
 			/* remove const */
 			*puthere = (char *)(cp);
 		}
@@ -12657,14 +12657,14 @@
 	Jim_Obj *o;
 	double _safe;
 	
-	if (puthere == NULL){
+	if (puthere == NULL) {
 		puthere = &amp;_safe;
 	}
 
 	r = Jim_GetOpt_Obj(goi, &amp;o);
-	if (r == JIM_OK){
+	if (r == JIM_OK) {
 		r = Jim_GetDouble(goi-&gt;interp, o, puthere);
-		if (r != JIM_OK){
+		if (r != JIM_OK) {
 			Jim_SetResult_sprintf(goi-&gt;interp,
 								   &quot;not a number: %s&quot;, 
 								   Jim_GetString(o, NULL));
@@ -12680,12 +12680,12 @@
 	Jim_Obj *o;
 	jim_wide _safe;
 
-	if (puthere == NULL){
+	if (puthere == NULL) {
 		puthere = &amp;_safe;
 	}
 
 	r = Jim_GetOpt_Obj(goi, &amp;o);
-	if (r == JIM_OK){
+	if (r == JIM_OK) {
 		r = Jim_GetWide(goi-&gt;interp, o, puthere);
 	}
 	return r;
@@ -12699,12 +12699,12 @@
 	Jim_Obj *o;
 	int e;
 
-	if (puthere == NULL){
+	if (puthere == NULL) {
 		puthere = &amp;_safe;
 	}
 
 	e = Jim_GetOpt_Obj(goi, &amp;o);
-	if (e == JIM_OK){
+	if (e == JIM_OK) {
 		e = Jim_Nvp_name2value_obj(goi-&gt;interp,
 									nvp, 
 									o,
@@ -12719,7 +12719,7 @@
 					   const Jim_Nvp *nvptable,
 					   int hadprefix)
 {
-	if (hadprefix){
+	if (hadprefix) {
 		Jim_SetResult_NvpUnknown(goi-&gt;interp,
 								  goi-&gt;argv[-2],
 								  goi-&gt;argv[-1],
@@ -12742,11 +12742,11 @@
 	Jim_Obj *o;
 	int e;
 
-	if (puthere == NULL){
+	if (puthere == NULL) {
 		puthere = &amp;_safe;
 	}
 	e = Jim_GetOpt_Obj(goi, &amp;o);
-	if (e == JIM_OK){
+	if (e == JIM_OK) {
 		e = Jim_GetEnum(goi-&gt;interp,
 						 o,
 						 lookup,
@@ -12768,7 +12768,7 @@
 	va_start(ap,fmt);
 	buf = jim_vasprintf(fmt, ap);
 	va_end(ap);
-	if (buf){
+	if (buf) {
 		Jim_SetResultString(interp, buf, -1);
 		jim_vasprintf_done(buf);
 	}
@@ -12782,7 +12782,7 @@
 						  Jim_Obj *param_value,
 						  const Jim_Nvp *nvp)
 {
-	if (param_name){
+	if (param_name) {
 		Jim_SetResult_sprintf(interp,
 							   &quot;%s: Unknown: %s, try one of: &quot;,
 							   Jim_GetString(param_name, NULL),
@@ -12792,11 +12792,11 @@
 							   &quot;Unknown param: %s, try one of: &quot;,
 							   Jim_GetString(param_value, NULL));
 	}
-	while (nvp-&gt;name){
+	while (nvp-&gt;name) {
 		const char *a;
 		const char *b;
 
-		if ((nvp + 1)-&gt;name){
+		if ((nvp + 1)-&gt;name) {
 			a = nvp-&gt;name;
 			b = &quot;, &quot;;
 		} else {
@@ -12818,12 +12818,12 @@
 {
 	int x;
 
-	if (debug_string_obj){
+	if (debug_string_obj) {
 		Jim_FreeObj(interp, debug_string_obj);
 	}
 
 	debug_string_obj = Jim_NewEmptyStringObj(interp);
-	for (x = 0 ; x &lt; argc ; x++){
+	for (x = 0 ; x &lt; argc ; x++) {
 		Jim_AppendStrings(interp,
 						   debug_string_obj,
 						   Jim_GetString(argv[x], NULL),

Modified: trunk/src/helper/jim.h
===================================================================
--- trunk/src/helper/jim.h	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/helper/jim.h	2009-06-23 22:49:06 UTC (rev 2378)
@@ -985,19 +985,19 @@
  *
  *   Jim_GetOpt_Setup(&amp;goi, interp, argc, argv);
  *
- *   while (goi.argc){
+ *   while (goi.argc) {
  *         e = Jim_GetOpt_Nvp(&amp;goi, nvp_options, &amp;n);
- *         if (e != JIM_OK){
+ *         if (e != JIM_OK) {
  *               Jim_GetOpt_NvpUnknown(&amp;goi, nvp_options, 0);
  *               return e;
  *         }
  *
- *         switch (n-&gt;value){
+ *         switch (n-&gt;value) {
  *         case ALIVE:
  *             printf(&quot;Option ALIVE specified\n&quot;);
  *             break;
  *         case FIRST:
- *             if (goi.argc &lt; 1){
+ *             if (goi.argc &lt; 1) {
  *                     .. not enough args error ..
  *             }
  *             Jim_GetOpt_String(&amp;goi, &amp;cp, NULL);
@@ -1008,7 +1008,7 @@
  *             break;
  *         case POLITICS:
  *             e = Jim_GetOpt_Nvp(&amp;goi, nvp_politics, &amp;n);
- *             if (e != JIM_OK){
+ *             if (e != JIM_OK) {
  *                 Jim_GetOpt_NvpUnknown(&amp;goi, nvp_politics, 1);
  *                 return e;
  *             }
@@ -1102,21 +1102,21 @@
  * Example:
  * \code
  *
- *  while (goi.argc){
+ *  while (goi.argc) {
  *     // Get the next option 
  *     e = Jim_GetOpt_Nvp(&amp;goi, cmd_options, &amp;n);
- *     if (e != JIM_OK){
+ *     if (e != JIM_OK) {
  *          // option was not recognized
  *          // pass 'hadprefix = 0' because there is no prefix
  *          Jim_GetOpt_NvpUnknown(&amp;goi, cmd_options, 0);
  *          return e;
  *     }
  *
- *     switch (n-&gt;value){
+ *     switch (n-&gt;value) {
  *     case OPT_SEX:
  *          // handle:  --sex male | female | lots | needmore
  *          e = Jim_GetOpt_Nvp(&amp;goi, &amp;nvp_sex, &amp;n);
- *          if (e != JIM_OK){
+ *          if (e != JIM_OK) {
  *               Jim_GetOpt_NvpUnknown(&amp;ogi, nvp_sex, 1);
  *               return e;
  *          }

Modified: trunk/src/jtag/core.c
===================================================================
--- trunk/src/jtag/core.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/jtag/core.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -704,7 +704,7 @@
 	else
 		compare_failed = buf_cmp(captured, in_check_value, num_bits);
 
-	if (compare_failed){
+	if (compare_failed) {
 		/* An error handler could have caught the failing check
 		 * only report a problem when there wasn't a handler, or if the handler
 		 * acknowledged the error
@@ -1024,9 +1024,9 @@
 
 	tap = NULL;
 	total_ir_length = 0;
-	for (;;){
+	for (;;) {
 		tap = jtag_tap_next_enabled(tap);
-		if (tap == NULL){
+		if (tap == NULL) {
 			break;
 		}
 		total_ir_length += tap-&gt;ir_length;
@@ -1048,9 +1048,9 @@
 	tap = NULL;
 	chain_pos = 0;
 	int val;
-	for (;;){
+	for (;;) {
 		tap = jtag_tap_next_enabled(tap);
-		if (tap == NULL){
+		if (tap == NULL) {
 			break;
 		}
 
@@ -1151,7 +1151,7 @@
 	LOG_DEBUG(&quot;Init JTAG chain&quot;);
 
 	tap = jtag_tap_next_enabled(NULL);
-	if (tap == NULL){
+	if (tap == NULL) {
 		LOG_ERROR(&quot;There are no enabled taps?&quot;);
 		return ERROR_JTAG_INIT_FAILED;
 	}

Modified: trunk/src/jtag/interface.c
===================================================================
--- trunk/src/jtag/interface.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/jtag/interface.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -359,9 +359,9 @@
 {
 	tap_state_t x;
 
-	for (x = 0 ; x &lt; TAP_NUM_STATES ; x++){
+	for (x = 0 ; x &lt; TAP_NUM_STATES ; x++) {
 		/* be nice to the human */
-		if (0 == strcasecmp(name, tap_state_name(x))){
+		if (0 == strcasecmp(name, tap_state_name(x))) {
 			return x;
 		}
 	}

Modified: trunk/src/jtag/tcl.c
===================================================================
--- trunk/src/jtag/tcl.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/jtag/tcl.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -340,7 +340,7 @@
 	/*
 	 * we expect CHIP + TAP + OPTIONS
 	 * */
-	if (goi-&gt;argc &lt; 3){
+	if (goi-&gt;argc &lt; 3) {
 		Jim_SetResult_sprintf(goi-&gt;interp, &quot;Missing CHIP TAP OPTIONS ....&quot;);
 		return JIM_ERR;
 	}
@@ -367,14 +367,14 @@
 	/* clear them as we find them */
 	reqbits = (NTREQ_IRLEN | NTREQ_IRCAPTURE | NTREQ_IRMASK);
 
-	while (goi-&gt;argc){
+	while (goi-&gt;argc) {
 		e = Jim_GetOpt_Nvp(goi, opts, &amp;n);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			Jim_GetOpt_NvpUnknown(goi, opts, 0);
 			return e;
 		}
 		LOG_DEBUG(&quot;Processing option: %s&quot;, n-&gt;name);
-		switch (n-&gt;value){
+		switch (n-&gt;value) {
 		case NTAP_OPT_ENABLED:
 			pTap-&gt;disabled_after_reset = false;
 			break;
@@ -410,11 +410,11 @@
 		case NTAP_OPT_IRMASK:
 		case NTAP_OPT_IRCAPTURE:
 			e = Jim_GetOpt_Wide(goi, &amp;w);
-			if (e != JIM_OK){
+			if (e != JIM_OK) {
 				Jim_SetResult_sprintf(goi-&gt;interp, &quot;option: %s bad parameter&quot;, n-&gt;name);
 				return e;
 			}
-			switch (n-&gt;value){
+			switch (n-&gt;value) {
 			case NTAP_OPT_IRLEN:
 				if (w &gt; (jim_wide) (8 * sizeof(pTap-&gt;ir_capture_value)))
 					LOG_WARNING(&quot;huge IR length %d&quot;, (int) w);
@@ -535,29 +535,29 @@
 	Jim_GetOpt_Setup(&amp;goi, interp, argc-1, argv + 1);
 
 	e = Jim_GetOpt_Nvp(&amp;goi, jtag_cmds, &amp;n);
-	if (e != JIM_OK){
+	if (e != JIM_OK) {
 		Jim_GetOpt_NvpUnknown(&amp;goi, jtag_cmds, 0);
 		return e;
 	}
 		Jim_SetEmptyResult(goi.interp);
-	switch (n-&gt;value){
+	switch (n-&gt;value) {
 	case JTAG_CMD_INTERFACE:
 		/* return the name of the interface */
 		/* TCL code might need to know the exact type... */
 		/* FUTURE: we allow this as a means to &quot;set&quot; the interface. */
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 1, goi.argv-1, &quot;(no params)&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResultString(goi.interp, jtag_interface-&gt;name, -1);
 		return JIM_OK;
 	case JTAG_CMD_INIT_RESET:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 1, goi.argv-1, &quot;(no params)&quot;);
 			return JIM_ERR;
 		}
 		e = jtag_init_reset(context);
-		if (e != ERROR_OK){
+		if (e != ERROR_OK) {
 			Jim_SetResult_sprintf(goi.interp, &quot;error: %d&quot;, e);
 			return JIM_ERR;
 		}
@@ -568,7 +568,7 @@
 	case JTAG_CMD_TAPISENABLED:
 	case JTAG_CMD_TAPENABLE:
 	case JTAG_CMD_TAPDISABLE:
-		if (goi.argc != 1){
+		if (goi.argc != 1) {
 			Jim_SetResultString(goi.interp, &quot;Too many parameters&quot;,-1);
 			return JIM_ERR;
 		}
@@ -619,7 +619,7 @@
 		break;
 
 	case JTAG_CMD_CGET:
-		if (goi.argc &lt; 2){
+		if (goi.argc &lt; 2) {
 			Jim_WrongNumArgs(goi.interp, 0, NULL, &quot;?tap-name? -option ...&quot;);
 			return JIM_ERR;
 		}
@@ -629,7 +629,7 @@
 
 			Jim_GetOpt_Obj(&amp;goi, &amp;o);
 			t = jtag_tap_by_jim_obj(goi.interp, o);
-			if (t == NULL){
+			if (t == NULL) {
 				return JIM_ERR;
 			}
 
@@ -639,7 +639,7 @@
 		break;
 
 	case JTAG_CMD_CONFIGURE:
-		if (goi.argc &lt; 3){
+		if (goi.argc &lt; 3) {
 			Jim_WrongNumArgs(goi.interp, 0, NULL, &quot;?tap-name? -option ?VALUE? ...&quot;);
 			return JIM_ERR;
 		}
@@ -649,7 +649,7 @@
 
 			Jim_GetOpt_Obj(&amp;goi, &amp;o);
 			t = jtag_tap_by_jim_obj(goi.interp, o);
-			if (t == NULL){
+			if (t == NULL) {
 				return JIM_ERR;
 			}
 
@@ -806,7 +806,7 @@
 	 * argv[ 3] = not actually used by anything but in the docs
 	 */
 
-	if (argc &lt; 4){
+	if (argc &lt; 4) {
 		command_print(cmd_ctx, &quot;OLD DEPRECATED SYNTAX: Please use the NEW syntax&quot;);
 		return ERROR_OK;
 	}
@@ -847,7 +847,7 @@
 			 Jim_GetString(newargs[9], NULL));
 
 	e = jim_jtag_command(interp, 10, newargs);
-	if (e != JIM_OK){
+	if (e != JIM_OK) {
 		command_print(cmd_ctx, &quot;%s&quot;, Jim_GetString(Jim_GetResult(interp), NULL));
 	}
 	return e;
@@ -861,7 +861,7 @@
 	command_print(cmd_ctx, &quot;     TapName            | Enabled |   IdCode      Expected    IrLen IrCap  IrMask Instr     &quot;);
 	command_print(cmd_ctx, &quot;---|--------------------|---------|------------|------------|------|------|------|---------&quot;);
 
-	while (tap){
+	while (tap) {
 		uint32_t expected, expected_mask, cur_instr, ii;
 		expected = buf_get_u32(tap-&gt;expected, 0, tap-&gt;ir_length);
 		expected_mask = buf_get_u32(tap-&gt;expected_mask, 0, tap-&gt;ir_length);
@@ -1174,20 +1174,20 @@
 	 */
 	endstate = TAP_IDLE;
 
-	if (argc &gt;= 4){
+	if (argc &gt;= 4) {
 		/* have at least one pair of numbers. */
 		/* is last pair the magic text? */
-		if (0 == strcmp(&quot;-endstate&quot;, args[ argc - 2 ])){
+		if (0 == strcmp(&quot;-endstate&quot;, args[ argc - 2 ])) {
 			const char *cpA;
 			const char *cpS;
 			cpA = args[ argc-1 ];
-			for (endstate = 0 ; endstate &lt; TAP_NUM_STATES ; endstate++){
+			for (endstate = 0 ; endstate &lt; TAP_NUM_STATES ; endstate++) {
 				cpS = tap_state_name(endstate);
-				if (0 == strcmp(cpA, cpS)){
+				if (0 == strcmp(cpA, cpS)) {
 					break;
 				}
 			}
-			if (endstate &gt;= TAP_NUM_STATES){
+			if (endstate &gt;= TAP_NUM_STATES) {
 				return ERROR_COMMAND_SYNTAX_ERROR;
 			} else {
 				if (!scan_is_safe(endstate))
@@ -1281,12 +1281,12 @@
 
 		e = Jim_GetLong(interp, args[i], &amp;bits);
 		/* If valid - try next arg */
-		if (e == JIM_OK){
+		if (e == JIM_OK) {
 			continue;
 		}
 
 		/* Not valid.. are we at the end? */
-		if (((i + 2) != argc)){
+		if (((i + 2) != argc)) {
 			/* nope, then error */
 			return e;
 		}
@@ -1299,13 +1299,13 @@
 		/* get arg as a string. */
 		cp = Jim_GetString(args[i], NULL);
 		/* is it the magic? */
-		if (0 == strcmp(&quot;-endstate&quot;, cp)){
+		if (0 == strcmp(&quot;-endstate&quot;, cp)) {
 			/* is the statename valid? */
 			cp = Jim_GetString(args[i + 1], NULL);
 
 			/* see if it is a valid state name */
 			endstate = tap_state_by_name(cp);
-			if (endstate &lt; 0){
+			if (endstate &lt; 0) {
 				/* update the error message */
 				Jim_SetResult_sprintf(interp,&quot;endstate: %s invalid&quot;, cp);
 			} else {
@@ -1321,13 +1321,13 @@
 		}
 
 		/* Still an error? */
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			return e; /* too bad */
 		}
 	} /* validate args */
 
 	tap = jtag_tap_by_jim_obj(interp, args[1]);
-	if (tap == NULL){
+	if (tap == NULL) {
 		return JIM_ERR;
 	}
 

Modified: trunk/src/pld/xilinx_bit.c
===================================================================
--- trunk/src/pld/xilinx_bit.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/pld/xilinx_bit.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -96,7 +96,7 @@
 		return ERROR_PLD_FILE_LOAD_FAILED;
 	}
 
-	if (input_stat.st_size == 0){
+	if (input_stat.st_size == 0) {
 		LOG_ERROR(&quot;Empty file %s&quot;, filename);
 		return ERROR_PLD_FILE_LOAD_FAILED;
 	}

Modified: trunk/src/server/gdb_server.c
===================================================================
--- trunk/src/server/gdb_server.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/server/gdb_server.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -319,7 +319,7 @@
 			break;
 		if ((retval = gdb_get_char(connection, &amp;reply)) != ERROR_OK)
 			return retval;
-		if (reply == '$'){
+		if (reply == '$') {
 			/* fix a problem with some IAR tools */
 			gdb_putback_char(connection, reply);
 			LOG_DEBUG(&quot;Unexpected start of new packet&quot;);
@@ -402,7 +402,7 @@
 				log_remove_callback(gdb_log_callback, connection);
 				LOG_WARNING(&quot;negative reply, retrying&quot;);
 			}
-			else if (reply == '$'){
+			else if (reply == '$') {
 				LOG_ERROR(&quot;GDB missing ack(1) - assumed good&quot;);
 				gdb_putback_char(connection, reply);
 				return ERROR_OK;
@@ -413,7 +413,7 @@
 				return ERROR_SERVER_REMOTE_CLOSED;
 			}
 		}
-		else if (reply == '$'){
+		else if (reply == '$') {
 			LOG_ERROR(&quot;GDB missing ack(2) - assumed good&quot;);
 			gdb_putback_char(connection, reply);
 			return ERROR_OK;
@@ -2036,12 +2036,12 @@
 		/* terminate with zero */
 		packet[packet_size] = 0;
 
-		if (LOG_LEVEL_IS(LOG_LVL_DEBUG)){
-			if (packet[0] == 'X'){
+		if (LOG_LEVEL_IS(LOG_LVL_DEBUG)) {
+			if (packet[0] == 'X') {
 				// binary packets spew junk into the debug log stream
 				char buf[ 50 ];
 				int x;
-				for (x = 0 ; (x &lt; 49) &amp;&amp; (packet[x] != ':') ; x++){
+				for (x = 0 ; (x &lt; 49) &amp;&amp; (packet[x] != ':') ; x++) {
 					buf[x] = packet[x];
 				}
 				buf[x] = 0;

Modified: trunk/src/target/target.c
===================================================================
--- trunk/src/target/target.c	2009-06-23 22:47:42 UTC (rev 2377)
+++ trunk/src/target/target.c	2009-06-23 22:49:06 UTC (rev 2378)
@@ -144,7 +144,7 @@
 	const Jim_Nvp *n;
 
 	n = Jim_Nvp_value2name_simple(nvp_error_target, err);
-	if (n-&gt;name == NULL){
+	if (n-&gt;name == NULL) {
 		return &quot;unknown&quot;;
 	} else {
 		return n-&gt;name;
@@ -244,8 +244,8 @@
 
 	x = -1;
 	t = all_targets;
-	while (t){
-		if (x &lt; t-&gt;target_number){
+	while (t) {
+		if (x &lt; t-&gt;target_number) {
 			x = (t-&gt;target_number) + 1;
 		}
 		t = t-&gt;next;
@@ -262,8 +262,8 @@
 	/* number is 0 based */
 	x = -1;
 	t = all_targets;
-	while (t){
-		if (x &lt; t-&gt;target_number){
+	while (t) {
+		if (x &lt; t-&gt;target_number) {
 			x = t-&gt;target_number;
 		}
 		t = t-&gt;next;
@@ -352,8 +352,8 @@
 {
 	target_t *target = all_targets;
 
-	while (target){
-		if (target-&gt;target_number == num){
+	while (target) {
+		if (target-&gt;target_number == num) {
 			return target;
 		}
 		target = target-&gt;next;
@@ -429,7 +429,7 @@
 	int retval;
 	Jim_Nvp *n;
 	n = Jim_Nvp_value2name_simple(nvp_reset_modes, reset_mode);
-	if (n-&gt;name == NULL){
+	if (n-&gt;name == NULL) {
 		LOG_ERROR(&quot;invalid reset mode&quot;);
 		return ERROR_FAIL;
 	}
@@ -1983,7 +1983,7 @@
 	{
 		const Jim_Nvp *n;
 		n = Jim_Nvp_name2value_simple(nvp_reset_modes, args[0]);
-		if ((n-&gt;name == NULL) || (n-&gt;value == RESET_UNKNOWN)){
+		if ((n-&gt;name == NULL) || (n-&gt;value == RESET_UNKNOWN)) {
 			return ERROR_COMMAND_SYNTAX_ERROR;
 		}
 		reset_mode = n-&gt;value;
@@ -3205,12 +3205,12 @@
 	target_t *target;
 
 	context = Jim_GetAssocData(interp, &quot;context&quot;);
-	if (context == NULL){
+	if (context == NULL) {
 		LOG_ERROR(&quot;array2mem: no command context&quot;);
 		return JIM_ERR;
 	}
 	target = get_current_target(context);
-	if (target == NULL){
+	if (target == NULL) {
 		LOG_ERROR(&quot;array2mem: no current target&quot;);
 		return JIM_ERR;
 	}
@@ -3364,7 +3364,7 @@
 			   Jim_Nvp_value2name_simple(nvp_target_event, e)-&gt;name);
 
 	target = all_targets;
-	while (target){
+	while (target) {
 		target_handle_event(target, e);
 		target = target-&gt;next;
 	}
@@ -3378,8 +3378,8 @@
 	teap = target-&gt;event_action;
 
 	done = 0;
-	while (teap){
-		if (teap-&gt;event == e){
+	while (teap) {
+		if (teap-&gt;event == e) {
 			done = 1;
 			LOG_DEBUG(&quot;target: (%d) %s (%s) event: %d (%s) action: %s\n&quot;,
 					   target-&gt;target_number,
@@ -3395,7 +3395,7 @@
 		}
 		teap = teap-&gt;next;
 	}
-	if (!done){
+	if (!done) {
 		LOG_DEBUG(&quot;event: %d %s - no action&quot;,
 				   e,
 				   Jim_Nvp_value2name_simple(nvp_target_event, e)-&gt;name);
@@ -3437,38 +3437,38 @@
 	int e;
 
 	/* parse config or cget options ... */
-	while (goi-&gt;argc &gt; 0){
+	while (goi-&gt;argc &gt; 0) {
 		Jim_SetEmptyResult(goi-&gt;interp);
 		/* Jim_GetOpt_Debug(goi); */
 
-		if (target-&gt;type-&gt;target_jim_configure){
+		if (target-&gt;type-&gt;target_jim_configure) {
 			/* target defines a configure function */
 			/* target gets first dibs on parameters */
 			e = (*(target-&gt;type-&gt;target_jim_configure))(target, goi);
-			if (e == JIM_OK){
+			if (e == JIM_OK) {
 				/* more? */
 				continue;
 			}
-			if (e == JIM_ERR){
+			if (e == JIM_ERR) {
 				/* An error */
 				return e;
 			}
 			/* otherwise we 'continue' below */
 		}
 		e = Jim_GetOpt_Nvp(goi, nvp_config_opts, &amp;n);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			Jim_GetOpt_NvpUnknown(goi, nvp_config_opts, 0);
 			return e;
 		}
-		switch (n-&gt;value){
+		switch (n-&gt;value) {
 		case TCFG_TYPE:
 			/* not setable */
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				Jim_SetResult_sprintf(goi-&gt;interp, &quot;not setable: %s&quot;, n-&gt;name);
 				return JIM_ERR;
 			} else {
 			no_params:
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					Jim_WrongNumArgs(goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;NO PARAMS&quot;);
 					return JIM_ERR;
 				}
@@ -3477,24 +3477,24 @@
 			/* loop for more */
 			break;
 		case TCFG_EVENT:
-			if (goi-&gt;argc == 0){
+			if (goi-&gt;argc == 0) {
 				Jim_WrongNumArgs(goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name? ...&quot;);
 				return JIM_ERR;
 			}
 
 			e = Jim_GetOpt_Nvp(goi, nvp_target_event, &amp;n);
-			if (e != JIM_OK){
+			if (e != JIM_OK) {
 				Jim_GetOpt_NvpUnknown(goi, nvp_target_event, 1);
 				return e;
 			}
 
-			if (goi-&gt;isconfigure){
-				if (goi-&gt;argc != 1){
+			if (goi-&gt;isconfigure) {
+				if (goi-&gt;argc != 1) {
 					Jim_WrongNumArgs(goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name? ?EVENT-BODY?&quot;);
 					return JIM_ERR;
 				}
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					Jim_WrongNumArgs(goi-&gt;interp, goi-&gt;argc, goi-&gt;argv, &quot;-event ?event-name?&quot;);
 					return JIM_ERR;
 				}
@@ -3505,21 +3505,21 @@
 
 				teap = target-&gt;event_action;
 				/* replace existing? */
-				while (teap){
-					if (teap-&gt;event == (enum target_event)n-&gt;value){
+				while (teap) {
+					if (teap-&gt;event == (enum target_event)n-&gt;value) {
 						break;
 					}
 					teap = teap-&gt;next;
 				}
 
-				if (goi-&gt;isconfigure){
-					if (teap == NULL){
+				if (goi-&gt;isconfigure) {
+					if (teap == NULL) {
 						/* create new */
 						teap = calloc(1, sizeof(*teap));
 					}
 					teap-&gt;event = n-&gt;value;
 					Jim_GetOpt_Obj(goi, &amp;o);
-					if (teap-&gt;body){
+					if (teap-&gt;body) {
 						Jim_DecrRefCount(interp, teap-&gt;body);
 					}
 					teap-&gt;body  = Jim_DuplicateObj(goi-&gt;interp, o);
@@ -3541,7 +3541,7 @@
 					Jim_SetEmptyResult(goi-&gt;interp);
 				} else {
 					/* get */
-					if (teap == NULL){
+					if (teap == NULL) {
 						Jim_SetEmptyResult(goi-&gt;interp);
 					} else {
 						Jim_SetResult(goi-&gt;interp, Jim_DuplicateObj(goi-&gt;interp, teap-&gt;body));
@@ -3552,15 +3552,15 @@
 			break;
 
 		case TCFG_WORK_AREA_VIRT:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide(goi, &amp;w);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					return e;
 				}
 				target-&gt;working_area_virt = w;
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3569,15 +3569,15 @@
 			break;
 
 		case TCFG_WORK_AREA_PHYS:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide(goi, &amp;w);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					return e;
 				}
 				target-&gt;working_area_phys = w;
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3586,15 +3586,15 @@
 			break;
 
 		case TCFG_WORK_AREA_SIZE:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide(goi, &amp;w);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					return e;
 				}
 				target-&gt;working_area_size = w;
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3603,16 +3603,16 @@
 			break;
 
 		case TCFG_WORK_AREA_BACKUP:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Wide(goi, &amp;w);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					return e;
 				}
 				/* make this exactly 1 or 0 */
 				target-&gt;backup_working_area = (!!w);
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3621,20 +3621,20 @@
 			break;
 
 		case TCFG_ENDIAN:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				e = Jim_GetOpt_Nvp(goi, nvp_target_endian, &amp;n);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					Jim_GetOpt_NvpUnknown(goi, nvp_target_endian, 1);
 					return e;
 				}
 				target-&gt;endianness = n-&gt;value;
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
 			n = Jim_Nvp_value2name_simple(nvp_target_endian, target-&gt;endianness);
-			if (n-&gt;name == NULL){
+			if (n-&gt;name == NULL) {
 				target-&gt;endianness = TARGET_LITTLE_ENDIAN;
 				n = Jim_Nvp_value2name_simple(nvp_target_endian, target-&gt;endianness);
 			}
@@ -3643,20 +3643,20 @@
 			break;
 
 		case TCFG_VARIANT:
-			if (goi-&gt;isconfigure){
-				if (goi-&gt;argc &lt; 1){
+			if (goi-&gt;isconfigure) {
+				if (goi-&gt;argc &lt; 1) {
 					Jim_SetResult_sprintf(goi-&gt;interp,
 										   &quot;%s ?STRING?&quot;,
 										   n-&gt;name);
 					return JIM_ERR;
 				}
-				if (target-&gt;variant){
+				if (target-&gt;variant) {
 					free((void *)(target-&gt;variant));
 				}
 				e = Jim_GetOpt_String(goi, &amp;cp, NULL);
 				target-&gt;variant = strdup(cp);
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3664,22 +3664,22 @@
 			/* loop for more */
 			break;
 		case TCFG_CHAIN_POSITION:
-			if (goi-&gt;isconfigure){
+			if (goi-&gt;isconfigure) {
 				Jim_Obj *o;
 				jtag_tap_t *tap;
 				target_free_all_working_areas(target);
 				e = Jim_GetOpt_Obj(goi, &amp;o);
-				if (e != JIM_OK){
+				if (e != JIM_OK) {
 					return e;
 				}
 				tap = jtag_tap_by_jim_obj(goi-&gt;interp, o);
-				if (tap == NULL){
+				if (tap == NULL) {
 					return JIM_ERR;
 				}
 				/* make this exactly 1 or 0 */
 				target-&gt;tap = tap;
 			} else {
-				if (goi-&gt;argc != 0){
+				if (goi-&gt;argc != 0) {
 					goto no_params;
 				}
 			}
@@ -3756,16 +3756,16 @@
 
 	/* commands here are in an NVP table */
 	e = Jim_GetOpt_Nvp(&amp;goi, target_options, &amp;n);
-	if (e != JIM_OK){
+	if (e != JIM_OK) {
 		Jim_GetOpt_NvpUnknown(&amp;goi, target_options, 0);
 		return e;
 	}
 	/* Assume blank result */
 	Jim_SetEmptyResult(goi.interp);
 
-	switch (n-&gt;value){
+	switch (n-&gt;value) {
 	case TS_CMD_CONFIGURE:
-		if (goi.argc &lt; 2){
+		if (goi.argc &lt; 2) {
 			Jim_WrongNumArgs(goi.interp, goi.argc, goi.argv, &quot;missing: -option VALUE ...&quot;);
 			return JIM_ERR;
 		}
@@ -3773,7 +3773,7 @@
 		return target_configure(&amp;goi, target);
 	case TS_CMD_CGET:
 		// some things take params
-		if (goi.argc &lt; 1){
+		if (goi.argc &lt; 1) {
 			Jim_WrongNumArgs(goi.interp, 0, goi.argv, &quot;missing: ?-option?&quot;);
 			return JIM_ERR;
 		}
@@ -3789,7 +3789,7 @@
 		 * argv[3] = optional count.
 		 */
 
-		if ((goi.argc == 2) || (goi.argc == 3)){
+		if ((goi.argc == 2) || (goi.argc == 3)) {
 			/* all is well */
 		} else {
 		mwx_error:
@@ -3798,24 +3798,24 @@
 		}
 
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;a);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			goto mwx_error;
 		}
 
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;b);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			goto mwx_error;
 		}
 		if (goi.argc == 3) {
 			e = Jim_GetOpt_Wide(&amp;goi, &amp;c);
-			if (e != JIM_OK){
+			if (e != JIM_OK) {
 				goto mwx_error;
 			}
 		} else {
 			c = 1;
 		}
 
-		switch (n-&gt;value){
+		switch (n-&gt;value) {
 		case TS_CMD_MWW:
 			target_buffer_set_u32(target, target_buf, b);
 			b = 4;
@@ -3829,9 +3829,9 @@
 			b = 1;
 			break;
 		}
-		for (x = 0 ; x &lt; c ; x++){
+		for (x = 0 ; x &lt; c ; x++) {
 			e = target_write_memory(target, a, b, 1, target_buf);
-			if (e != ERROR_OK){
+			if (e != ERROR_OK) {
 				Jim_SetResult_sprintf(interp, &quot;Error writing @ 0x%08x: %d\n&quot;, (int)(a), e);
 				return JIM_ERR;
 			}
@@ -3849,24 +3849,24 @@
 		 * argv[1] = address
 		 * argv[2] = optional count
 		 */
-		if ((goi.argc == 2) || (goi.argc == 3)){
+		if ((goi.argc == 2) || (goi.argc == 3)) {
 			Jim_SetResult_sprintf(goi.interp, &quot;expected: %s ADDR [COUNT]&quot;, n-&gt;name);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;a);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			return JIM_ERR;
 		}
-		if (goi.argc){
+		if (goi.argc) {
 			e = Jim_GetOpt_Wide(&amp;goi, &amp;c);
-			if (e != JIM_OK){
+			if (e != JIM_OK) {
 				return JIM_ERR;
 			}
 		} else {
 			c = 1;
 		}
 		b = 1; /* shut up gcc */
-		switch (n-&gt;value){
+		switch (n-&gt;value) {
 		case TS_CMD_MDW:
 			b =  4;
 			break;
@@ -3881,52 +3881,52 @@
 		/* convert to &quot;bytes&quot; */
 		c = c * b;
 		/* count is now in 'BYTES' */
-		while (c &gt; 0){
+		while (c &gt; 0) {
 			y = c;
-			if (y &gt; 16){
+			if (y &gt; 16) {
 				y = 16;
 			}
 			e = target_read_memory(target, a, b, y / b, target_buf);
-			if (e != ERROR_OK){
+			if (e != ERROR_OK) {
 				Jim_SetResult_sprintf(interp, &quot;error reading target @ 0x%08lx&quot;, (int)(a));
 				return JIM_ERR;
 			}
 
 			Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;0x%08x &quot;, (int)(a));
-			switch (b){
+			switch (b) {
 			case 4:
-				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 4){
+				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 4) {
 					z = target_buffer_get_u32(target, &amp;(target_buf[ x * 4 ]));
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;%08x &quot;, (int)(z));
 				}
-				for (; (x &lt; 16) ; x += 4){
+				for (; (x &lt; 16) ; x += 4) {
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;         &quot;);
 				}
 				break;
 			case 2:
-				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 2){
+				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 2) {
 					z = target_buffer_get_u16(target, &amp;(target_buf[ x * 2 ]));
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;%04x &quot;, (int)(z));
 				}
-				for (; (x &lt; 16) ; x += 2){
+				for (; (x &lt; 16) ; x += 2) {
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;     &quot;);
 				}
 				break;
 			case 1:
 			default:
-				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 1){
+				for (x = 0 ; (x &lt; 16) &amp;&amp; (x &lt; y) ; x += 1) {
 					z = target_buffer_get_u8(target, &amp;(target_buf[ x * 4 ]));
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;%02x &quot;, (int)(z));
 				}
-				for (; (x &lt; 16) ; x += 1){
+				for (; (x &lt; 16) ; x += 1) {
 					Jim_fprintf(interp, interp-&gt;cookie_stdout, &quot;   &quot;);
 				}
 				break;
 			}
 			/* ascii-ify the bytes */
-			for (x = 0 ; x &lt; y ; x++){
+			for (x = 0 ; x &lt; y ; x++) {
 				if ((target_buf[x] &gt;= 0x20) &amp;&amp;
-					(target_buf[x] &lt;= 0x7e)){
+					(target_buf[x] &lt;= 0x7e)) {
 					/* good */
 				} else {
 					/* smack it */
@@ -3934,7 +3934,7 @@
 				}
 			}
 			/* space pad  */
-			while (x &lt; 16){
+			while (x &lt; 16) {
 				target_buf[x] = ' ';
 				x++;
 			}
@@ -3954,31 +3954,31 @@
 		return target_array2mem(goi.interp, target, goi.argc, goi.argv);
 		break;
 	case TS_CMD_EXAMINE:
-		if (goi.argc){
+		if (goi.argc) {
 			Jim_WrongNumArgs(goi.interp, 2, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
 		e = target-&gt;type-&gt;examine(target);
-		if (e != ERROR_OK){
+		if (e != ERROR_OK) {
 			Jim_SetResult_sprintf(interp, &quot;examine-fails: %d&quot;, e);
 			return JIM_ERR;
 		}
 		return JIM_OK;
 	case TS_CMD_POLL:
-		if (goi.argc){
+		if (goi.argc) {
 			Jim_WrongNumArgs(goi.interp, 2, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
-		if (!(target_was_examined(target))){
+		if (!(target_was_examined(target))) {
 			e = ERROR_TARGET_NOT_EXAMINED;
 		} else {
 			e = target-&gt;type-&gt;poll(target);
 		}
-		if (e != ERROR_OK){
+		if (e != ERROR_OK) {
 			Jim_SetResult_sprintf(interp, &quot;poll-fails: %d&quot;, e);
 			return JIM_ERR;
 		} else {
@@ -3986,18 +3986,18 @@
 		}
 		break;
 	case TS_CMD_RESET:
-		if (goi.argc != 2){
+		if (goi.argc != 2) {
 			Jim_WrongNumArgs(interp, 2, argv, &quot;t | f|assert | deassert BOOL&quot;);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp(&amp;goi, nvp_assert, &amp;n);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			Jim_GetOpt_NvpUnknown(&amp;goi, nvp_assert, 1);
 			return e;
 		}
 		/* the halt or not param */
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;a);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			return e;
 		}
 		if (!target-&gt;tap-&gt;enabled)
@@ -4008,14 +4008,14 @@
 		target_free_all_working_areas_restore(target, 0);
 
 		/* do the assert */
-		if (n-&gt;value == NVP_ASSERT){
+		if (n-&gt;value == NVP_ASSERT) {
 			target-&gt;type-&gt;assert_reset(target);
 		} else {
 			target-&gt;type-&gt;deassert_reset(target);
 		}
 		return JIM_OK;
 	case TS_CMD_HALT:
-		if (goi.argc){
+		if (goi.argc) {
 			Jim_WrongNumArgs(goi.interp, 0, argv, &quot;halt [no parameters]&quot;);
 			return JIM_ERR;
 		}
@@ -4025,23 +4025,23 @@
 		return JIM_OK;
 	case TS_CMD_WAITSTATE:
 		/* params:  &lt;name&gt;  statename timeoutmsecs */
-		if (goi.argc != 2){
+		if (goi.argc != 2) {
 			Jim_SetResult_sprintf(goi.interp, &quot;%s STATENAME TIMEOUTMSECS&quot;, n-&gt;name);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp(&amp;goi, nvp_target_state, &amp;n);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			Jim_GetOpt_NvpUnknown(&amp;goi, nvp_target_state,1);
 			return e;
 		}
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;a);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			return e;
 		}
 		if (!target-&gt;tap-&gt;enabled)
 			goto err_tap_disabled;
 		e = target_wait_state(target, n-&gt;value, a);
-		if (e != ERROR_OK){
+		if (e != ERROR_OK) {
 			Jim_SetResult_sprintf(goi.interp,
 								   &quot;target: %s wait %s fails (%d) %s&quot;,
 								   target-&gt;cmd_name,
@@ -4063,7 +4063,7 @@
 						   target-&gt;cmd_name);
 			command_print(cmd_ctx, &quot;%-25s | Body&quot;, &quot;Event&quot;);
 			command_print(cmd_ctx, &quot;------------------------- | ----------------------------------------&quot;);
-			while (teap){
+			while (teap) {
 				command_print(cmd_ctx,
 							   &quot;%-25s | %s&quot;,
 							   Jim_Nvp_value2name_simple(nvp_target_event, teap-&gt;event)-&gt;name,
@@ -4074,7 +4074,7 @@
 			return JIM_OK;
 		}
 	case TS_CMD_CURSTATE:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 0, argv, &quot;[no parameters]&quot;);
 			return JIM_ERR;
 		}
@@ -4082,12 +4082,12 @@
 							 Jim_Nvp_value2name_simple(nvp_target_state,target-&gt;state)-&gt;name,-1);
 		return JIM_OK;
 	case TS_CMD_INVOKE_EVENT:
-		if (goi.argc != 1){
+		if (goi.argc != 1) {
 			Jim_SetResult_sprintf(goi.interp, &quot;%s ?EVENTNAME?&quot;,n-&gt;name);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Nvp(&amp;goi, nvp_target_event, &amp;n);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			Jim_GetOpt_NvpUnknown(&amp;goi, nvp_target_event, 1);
 			return e;
 		}
@@ -4113,7 +4113,7 @@
 	struct command_context_s *cmd_ctx;
 
 	cmd_ctx = Jim_GetAssocData(goi-&gt;interp, &quot;context&quot;);
-	if (goi-&gt;argc &lt; 3){
+	if (goi-&gt;argc &lt; 3) {
 		Jim_WrongNumArgs(goi-&gt;interp, 1, goi-&gt;argv, &quot;?name? ?type? ..options...&quot;);
 		return JIM_ERR;
 	}
@@ -4122,7 +4122,7 @@
 	Jim_GetOpt_Obj(goi, &amp;new_cmd);
 	/* does this command exist? */
 	cmd = Jim_GetCommand(goi-&gt;interp, new_cmd, JIM_ERRMSG);
-	if (cmd){
+	if (cmd) {
 		cp = Jim_GetString(new_cmd, NULL);
 		Jim_SetResult_sprintf(goi-&gt;interp, &quot;Command/target: %s Exists&quot;, cp);
 		return JIM_ERR;
@@ -4132,16 +4132,16 @@
 	e = Jim_GetOpt_String(goi, &amp;cp2, NULL);
 	cp = cp2;
 	/* now does target type exist */
-	for (x = 0 ; target_types[x] ; x++){
-		if (0 == strcmp(cp, target_types[x]-&gt;name)){
+	for (x = 0 ; target_types[x] ; x++) {
+		if (0 == strcmp(cp, target_types[x]-&gt;name)) {
 			/* found */
 			break;
 		}
 	}
-	if (target_types[x] == NULL){
+	if (target_types[x] == NULL) {
 		Jim_SetResult_sprintf(goi-&gt;interp, &quot;Unknown target type %s, try one of &quot;, cp);
-		for (x = 0 ; target_types[x] ; x++){
-			if (target_types[x + 1]){
+		for (x = 0 ; target_types[x] ; x++) {
+			if (target_types[x + 1]) {
 				Jim_AppendStrings(goi-&gt;interp,
 								   Jim_GetResult(goi-&gt;interp),
 								   target_types[x]-&gt;name,
@@ -4209,13 +4209,13 @@
 		e = JIM_ERR;
 	}
 
-	if (e != JIM_OK){
+	if (e != JIM_OK) {
 		free(target-&gt;type);
 		free(target);
 		return e;
 	}
 
-	if (target-&gt;endianness == TARGET_ENDIAN_UNKNOWN){
+	if (target-&gt;endianness == TARGET_ENDIAN_UNKNOWN) {
 		/* default endian to little if not specified */
 		target-&gt;endianness = TARGET_LITTLE_ENDIAN;
 	}
@@ -4225,10 +4225,10 @@
 		target-&gt;variant = strdup(&quot;&quot;);
 
 	/* create the target specific commands */
-	if (target-&gt;type-&gt;register_commands){
+	if (target-&gt;type-&gt;register_commands) {
 		(*(target-&gt;type-&gt;register_commands))(cmd_ctx);
 	}
-	if (target-&gt;type-&gt;target_create){
+	if (target-&gt;type-&gt;target_create) {
 		(*(target-&gt;type-&gt;target_create))(target, goi-&gt;interp);
 	}
 
@@ -4236,7 +4236,7 @@
 	{
 		target_t **tpp;
 		tpp = &amp;(all_targets);
-		while (*tpp){
+		while (*tpp) {
 			tpp = &amp;((*tpp)-&gt;next);
 		}
 		*tpp = target;
@@ -4285,48 +4285,48 @@
 
 	Jim_GetOpt_Setup(&amp;goi, interp, argc-1, argv + 1);
 
-	if (goi.argc == 0){
+	if (goi.argc == 0) {
 		Jim_WrongNumArgs(interp, 1, argv, &quot;missing: command ...&quot;);
 		return JIM_ERR;
 	}
 
 	/* Jim_GetOpt_Debug(&amp;goi); */
 	r = Jim_GetOpt_Enum(&amp;goi, target_cmds, &amp;x);
-	if (r != JIM_OK){
+	if (r != JIM_OK) {
 		return r;
 	}
 
-	switch (x){
+	switch (x) {
 	default:
 		Jim_Panic(goi.interp,&quot;Why am I here?&quot;);
 		return JIM_ERR;
 	case TG_CMD_CURRENT:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 1, goi.argv, &quot;Too many parameters&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResultString(goi.interp, get_current_target(cmd_ctx)-&gt;cmd_name, -1);
 		return JIM_OK;
 	case TG_CMD_TYPES:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 1, goi.argv, &quot;Too many parameters&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResult(goi.interp, Jim_NewListObj(goi.interp, NULL, 0));
-		for (x = 0 ; target_types[x] ; x++){
+		for (x = 0 ; target_types[x] ; x++) {
 			Jim_ListAppendElement(goi.interp,
 								   Jim_GetResult(goi.interp),
 								   Jim_NewStringObj(goi.interp, target_types[x]-&gt;name, -1));
 		}
 		return JIM_OK;
 	case TG_CMD_NAMES:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 1, goi.argv, &quot;Too many parameters&quot;);
 			return JIM_ERR;
 		}
 		Jim_SetResult(goi.interp, Jim_NewListObj(goi.interp, NULL, 0));
 		target = all_targets;
-		while (target){
+		while (target) {
 			Jim_ListAppendElement(goi.interp,
 								   Jim_GetResult(goi.interp),
 								   Jim_NewStringObj(goi.interp, target-&gt;cmd_name, -1));
@@ -4334,25 +4334,25 @@
 		}
 		return JIM_OK;
 	case TG_CMD_CREATE:
-		if (goi.argc &lt; 3){
+		if (goi.argc &lt; 3) {
 			Jim_WrongNumArgs(goi.interp, goi.argc, goi.argv, &quot;?name  ... config options ...&quot;);
 			return JIM_ERR;
 		}
 		return target_create(&amp;goi);
 		break;
 	case TG_CMD_NUMBER:
-		if (goi.argc != 1){
+		if (goi.argc != 1) {
 			Jim_SetResult_sprintf(goi.interp, &quot;expected: target number ?NUMBER?&quot;);
 			return JIM_ERR;
 		}
 		e = Jim_GetOpt_Wide(&amp;goi, &amp;w);
-		if (e != JIM_OK){
+		if (e != JIM_OK) {
 			return JIM_ERR;
 		}
 		{
 			target_t *t;
 			t = get_target_by_num(w);
-			if (t == NULL){
+			if (t == NULL) {
 				Jim_SetResult_sprintf(goi.interp,&quot;Target: number %d does not exist&quot;, (int)(w));
 				return JIM_ERR;
 			}
@@ -4360,7 +4360,7 @@
 			return JIM_OK;
 		}
 	case TG_CMD_COUNT:
-		if (goi.argc != 0){
+		if (goi.argc != 0) {
 			Jim_WrongNumArgs(goi.interp, 0, goi.argv, &quot;&lt;no parameters&gt;&quot;);
 			return JIM_ERR;
 		}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001161.html">[Openocd-svn] r2377 - in trunk/src: . flash flash/ocl/at91sam7x	helper jtag jtag/rlink jtag/zy1000 pld server svf target xsvf
</A></li>
	<LI>Next message: <A HREF="001163.html">[Openocd-svn] r2379 - in trunk/src: flash flash/ocl/at91sam7x	target target/xscale
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1162">[ date ]</a>
              <a href="thread.html#1162">[ thread ]</a>
              <a href="subject.html#1162">[ subject ]</a>
              <a href="author.html#1162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
