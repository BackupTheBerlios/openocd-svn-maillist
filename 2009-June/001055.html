<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-svn] r2271 - trunk/doc
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2271%20-%20trunk/doc&In-Reply-To=%3C200906180029.n5I0Tg0x026614%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001054.html">
   <LINK REL="Next"  HREF="001056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-svn] r2271 - trunk/doc</H1>
    <B>zwelch at mail.berlios.de</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r2271%20-%20trunk/doc&In-Reply-To=%3C200906180029.n5I0Tg0x026614%40sheep.berlios.de%3E"
       TITLE="[Openocd-svn] r2271 - trunk/doc">zwelch at mail.berlios.de
       </A><BR>
    <I>Thu Jun 18 02:29:42 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001054.html">[Openocd-svn] r2270 - in trunk/doc/manual: . primer
</A></li>
        <LI>Next message: <A HREF="001056.html">[Openocd-svn] r2272 - trunk/src/pld
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1055">[ date ]</a>
              <a href="thread.html#1055">[ thread ]</a>
              <a href="subject.html#1055">[ subject ]</a>
              <a href="author.html#1055">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zwelch
Date: 2009-06-18 02:29:39 +0200 (Thu, 18 Jun 2009)
New Revision: 2271

Modified:
   trunk/doc/openocd.texi
Log:
David Brownell &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">david-b at pacbell.net</A>&gt;:

Various bits of cleanup, mostly to match the style hints
I just got around to writing up.

 - Various @cindex improvements

 - Cross reference the command line options in a few spots,
   notably for @command{debug_level}

 - Clean the config file guidelines a bit:
    * They're for all users, not just integrators
    * Reference the interface config chapter
    * Don't emphasize command line usage here
    * Tweak board and target config introductory text

Plus two minor bits of cleanup:  remove most date references,
and refer to the reader as &quot;you&quot; not &quot;the user&quot;.


Modified: trunk/doc/openocd.texi
===================================================================
--- trunk/doc/openocd.texi	2009-06-18 00:29:33 UTC (rev 2270)
+++ trunk/doc/openocd.texi	2009-06-18 00:29:39 UTC (rev 2271)
@@ -104,6 +104,8 @@
 around the world.
 
 @section What is OpenOCD?
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> TAP
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> JTAG
 
 The Open On-Chip Debugger (OpenOCD) aims to provide debugging,
 in-system programming and boundary-scan testing for embedded target
@@ -356,7 +358,11 @@
 @option{--with-ftd2xx-linux-tardir=PATH} - If using FTDICHIP.COM ft2232c driver
 on Linux, give the directory where the Linux driver's TAR.GZ file was unpacked.
 @item
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at option</A>{--with-ftd2xx-lib=shared|static} - Linux only. Default: static. Specifies how the FTDICHIP.COM libftd2xx driver should be linked. Note: 'static' only works in conjunction with @option{--with-ftd2xx-linux-tardir}. The 'shared' value is supported (12/26/2008), however you must manually install the required header files and shared libraries in an appropriate place. This uses ``libusb'' internally.
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at option</A>{--with-ftd2xx-lib=shared|static} - Linux only. Default: static.
+Specifies how the FTDICHIP.COM libftd2xx driver should be linked.
+Note: 'static' only works in conjunction with @option{--with-ftd2xx-linux-tardir}.
+The 'shared' value is supported, however you must manually install the required
+header files and shared libraries in an appropriate place.
 @item
 @option{--enable-presto_libftdi} - Enable building support for ASIX Presto programmer using the libftdi driver.
 @item
@@ -398,8 +404,9 @@
 
 The FTDICHIP drivers come as either a (win32) ZIP file, or a (Linux)
 TAR.GZ file. You must unpack them ``some where'' convient. As of this
-writing (12/26/2008) FTDICHIP does not supply means to install these
-files ``in an appropriate place'' As a result, there are two
+writing FTDICHIP does not supply means to install these
+files ``in an appropriate place''.
+As a result, there are two
 ``./configure'' options that help. 
 
 Below is an example build process:
@@ -476,7 +483,7 @@
 @cindex zy1000
 @cindex printer port
 @cindex USB Adapter
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> rtck
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> RTCK
 
 Defined: @b{dongle}: A small device that plugins into a computer and serves as
 an adapter .... [snip]
@@ -518,8 +525,6 @@
 In summer 2009, USB high speed (480 Mbps) versions of these FTDI
 chips are starting to become available in JTAG adapters.
 
-As of 28/Nov/2008, the following are supported:
-
 @itemize @bullet
 @item @b{usbjtag}
 @* Link @url{<A HREF="http://www.hs-augsburg.de/~hhoegl/proj/usbjtag/usbjtag.html">http://www.hs-augsburg.de/~hhoegl/proj/usbjtag/usbjtag.html</A>}
@@ -654,11 +659,9 @@
 
 @node Running
 @chapter Running
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> running OpenOCD
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> --configfile
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> --debug_level
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> --logfile
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> --search
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> command line options
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> logfile
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> directory search
 
 The @option{--help} option shows:
 @verbatim
@@ -696,8 +699,8 @@
 @option{debug_level} to &quot;3&quot;, outputting the most information,
 including debug messages. The default setting is &quot;2&quot;, outputting only
 informational messages, warnings and errors. You can also change this
-setting from within a telnet or gdb session using @option{debug_level
-&lt;n&gt;} @xref{debug_level}.
+setting from within a telnet or gdb session using @command{debug_level
+&lt;n&gt;} (@pxref{debug_level}).
 
 You can redirect all output from the daemon to a file using the
 @option{-l &lt;logfile&gt;} switch.
@@ -851,8 +854,9 @@
 to simplify your work.
 
 @section User Config Files
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> config file
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> config file, user
 @cindex user config file
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> config file, overview
 
 A user configuration file ties together all the parts of a project
 in one place.
@@ -862,8 +866,10 @@
 @item Ideally almost everything comes from configuration files
 provided by someone else.
 For example, OpenOCD distributes a @file{scripts} directory
-(probably in @file{/usr/share/openocd/scripts} on Linux);
-board and tool vendors can provide these too.
+(probably in @file{/usr/share/openocd/scripts} on Linux).
+Board and tool vendors can provide these too, as can individual
+user sites; the @option{-s} command line option lets you say
+where to find these files.  (@xref{Running}.)
 The AT91SAM7X256 example above works this way.
 
 Three main types of non-user configuration file each have their
@@ -1003,16 +1009,13 @@
 @node Config File Guidelines
 @chapter Config File Guidelines
 
-This section/chapter is aimed at developers and integrators of
-OpenOCD. These are guidelines for creating new boards and new target
-configurations as of 28/Nov/2008.
+This chapter is aimed at any user who needs to write a config file,
+including developers and integrators of OpenOCD and any user who
+needs to get a new board working smoothly.
+It provides guidelines for creating those files.
 
-However, you, the user of OpenOCD, should be somewhat familiar with
-this section as it should help explain some of the internals of what
-you might be looking at.
+You should find the following directories under @t{$(INSTALLDIR)/lib/openocd} :
 
-The user should find the following directories under @t{$(INSTALLDIR)/lib/openocd} :
-
 @itemize @bullet
 @item @b{interface}
 @*Think JTAG Dongle. Files that configure the JTAG dongle go here.
@@ -1033,43 +1036,43 @@
 the target config file defines all of them.
 @end itemize
 
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at b</A>{If needed...} The user in their ``openocd.cfg'' file or the board
-file might override a specific feature in any of the above files by
-setting a variable or two before sourcing the target file. Or adding
-various commands specific to their situation.
+The @file{openocd.cfg} user config
+file may override features in any of the above files by
+setting variables before sourcing the target file, or by adding
+commands specific to their situation.
 
 @section Interface Config Files
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> config file
 
-The user should be able to source one of these files via a command like this:
+The user config file
+should be able to source one of these files via a command like this:
 
 @example
-  source [find interface/FOOBAR.cfg]
-Or:
-  openocd -f interface/FOOBAR.cfg
+source [find interface/FOOBAR.cfg]
 @end example
 
 A preconfigured interface file should exist for every interface in use
 today, that said, perhaps some interfaces have only been used by the
 sole developer who created it.
 
+A separate chapter gives information about how to set these up.
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at xref</A>{Interface - Dongle Configuration}.
+Read the OpenOCD source code if you have a new kind of hardware interface
+and need to provide a driver for it.
+
 Interface files should be found in @t{$(INSTALLDIR)/lib/openocd/interface}
 
 @section Board Config Files
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> config file
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> config file, board
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> board config file
 
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at b</A>{Note: BOARD directory NEW as of 28/nov/2008} 
+The user config file
+should be able to source one of these files via a command like this:
 
-The user should be able to source one of these files via a command like this:
-
 @example
-  source [find board/FOOBAR.cfg]
-Or:
-  openocd -f board/FOOBAR.cfg
+source [find board/FOOBAR.cfg]
 @end example
 
-
-The board file should contain one or more @t{source [find
+The board config file should contain one or more @command{source [find
 target/FOO.cfg]} statements along with any board specific things.
 
 In summary the board files should contain (if present)
@@ -1085,14 +1088,14 @@
 @end enumerate
 
 @section Target Config Files
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at cindex</A> config file
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> config file, target
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> target config file
 
-The user should be able to source one of these files via a command like this:
+Board config files should be able to source one or more
+target config files via a command like this:
 
 @example
-  source [find target/FOOBAR.cfg]
-Or:
-  openocd -f target/FOOBAR.cfg
+source [find target/FOOBAR.cfg]
 @end example
 
 In summary the target files should contain
@@ -1100,23 +1103,41 @@
 @enumerate 
 @item Set defaults
 @item Add TAPs to the scan chain
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at item</A> Add CPU targets
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at item</A> Add CPU targets (includes GDB support)
 @item CPU/Chip/CPU-Core specific features
 @item On-Chip flash
 @end enumerate
 
+As a rule of thumb, a target file sets up only one chip.
+For a microcontroller, that will often include a single TAP,
+which is a CPU needing a GDB target; and its on-chip flash.
+
+More complex chips may include multiple TAPs, and the target
+config file may need to define them all before OpenOCD
+can talk to the chip.
+For example, some phone chips have JTAG scan chains that include
+an ARM core for operating system use, a DSP,
+another ARM core embedded in an image processing engine,
+and other processing engines.
+
 @subsection Important variable names
 
-By default, the end user should never need to set these
-variables. However, if the user needs to override a setting they only
-need to set the variable in a simple way.
+Most boards will have only one instance of a chip.
+However, it should be easy to create a board with more than
+one such chip.
+Accordingly, we encourage some conventions for naming
+variables associated with different TAPs, to promote
+consistency and
+so that board files can override target defaults, and
 
 @itemize @bullet
 @item @b{CHIPNAME}
 @* This gives a name to the overall chip, and is used as part of the
 tap identifier dotted name.
+It's normally provided by the chip manufacturer.
 @item @b{ENDIAN}
 @* By default little - unless the chip or board is not normally used that way.
+Chips that can't change endianness don't need to use this variable.
 @item @b{CPUTAPID}
 @* When OpenOCD examines the JTAG chain, it will attempt to identify
 every chip. If the @t{-expected-id} is nonzero, OpenOCD attempts
@@ -1142,22 +1163,15 @@
 If the chip has 2 targets, use the names @b{_TARGETNAME0},
 @b{_TARGETNAME1}, ... etc.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at b</A>{Remember:} The ``board file'' may include multiple targets.
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at emph</A>{Remember:} The ``board file'' may include multiple targets.
+The user (or board) config file should reasonably be able to:
 
-At no time should the name ``target0'' (the default target name if
-none was specified) be used. The name ``target0'' is a hard coded name
-- the next target on the board will be some other number.
-In the same way, avoid using target numbers even when they are
-permitted; use the right target name(s) for your board.
-
-The user (or board file) should reasonably be able to:
-
 @example
-   source [find target/FOO.cfg]
-   $_TARGETNAME configure ... FOO specific parameters
+source [find target/FOO.cfg]
+$_TARGETNAME configure ... FOO specific parameters
 
-   source [find target/BAR.cfg]
-   $_TARGETNAME configure ... BAR specific parameters
+source [find target/BAR.cfg]
+$_TARGETNAME configure ... BAR specific parameters
 @end example
 
 @end itemize
@@ -1169,7 +1183,7 @@
 a leading underscore are temporary in nature, and can be modified and
 used at will within a ?TARGET? configuration file.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at b</A>{EXAMPLE:} The user should be able to do this:
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at b</A>{EXAMPLE:} The user config file should be able to do this:
 
 @example
    # Board has 3 chips,
@@ -1359,7 +1373,7 @@
 
 @item @b{Scripts}
 @* OpenOCD configuration scripts are JIM Tcl Scripts. OpenOCD's
-command interpreter today (28/nov/2008) is a mixture of (newer)
+command interpreter today is a mixture of (newer)
 JIM-Tcl commands, and (older) the orginal command interpreter.
 
 @item @b{Commands}
@@ -1566,6 +1580,9 @@
 
 @node Interface - Dongle Configuration
 @chapter Interface - Dongle Configuration
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> config file, interface
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> interface config file
+
 JTAG Adapters/Interfaces/Dongles are normally configured
 through commands in an interface configuration
 file which is sourced by your @file{openocd.cfg} file, or
@@ -2138,6 +2155,7 @@
 probes flash memory, performs low-level JTAG operations, and more.
 
 @section Scan Chains
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> scan chain
 
 TAPs are part of a hardware @dfn{scan chain},
 which is daisy chain of TAPs.
@@ -2232,6 +2250,7 @@
 @c (on entry to RESET state).
 
 @section TAP Names
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> dotted name
 
 When TAP objects are declared with @command{jtag newtap},
 a @dfn{dotted.name} is created for the TAP, combining the
@@ -2330,6 +2349,8 @@
 @anchor{Enabling and Disabling TAPs}
 @section Enabling and Disabling TAPs
 @cindex TAP events
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> JTAG Route Controller
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> jrc
 
 In some systems, a @dfn{JTAG Route Controller} (JRC)
 is used to enable and/or disable specific JTAG TAPs.
@@ -2422,6 +2443,8 @@
 then look at how to add one more target and how to configure it.
 
 @section Target List
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> target, current
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> target, list
 
 All targets that have been set up are part of a list,
 where each member has a name.
@@ -2498,6 +2521,9 @@
 @end deffn
 
 @section Target CPU Types and Variants
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> target type
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> CPU type
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at cindex</A> CPU variant
 
 Each target has a @dfn{CPU type}, as shown in the output of
 the @command{targets} command.  You need to specify that type
@@ -2979,12 +3005,6 @@
 However, the documentation also uses ``flash'' as a generic term;
 for example, ``Put flash configuration in board-specific files''.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at quotation</A> Note
-As of 28-nov-2008 OpenOCD does not know how to program a SPI
-flash that a micro may boot from. Perhaps you, the reader, would like to
-contribute support for this.
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">- at end</A> quotation
-
 Flash Steps:
 @enumerate
 @item Configure via the command @command{flash bank}
@@ -4012,8 +4032,12 @@
 This affects the kind of messages sent to the server log.
 Level 0 is error messages only;
 level 1 adds warnings;
-level 2 (the default) adds informational messages;
+level 2 adds informational messages;
 and level 3 adds debugging messages.
+The default is level 2, but that can be overridden on
+the command line along with the location of that log
+file (which is normally the server's standard output).
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at xref</A>{Running}.
 @end deffn
 
 @deffn Command fast (@option{enable}|@option{disable})
@@ -4057,7 +4081,7 @@
 In this section ``target'' refers to a CPU configured as
 shown earlier (@pxref{CPU Configuration}).
 These commands, like many, implicitly refer to
-a @dfn{current target} which is used to perform the
+a current target which is used to perform the
 various operations.  The current target may be changed
 by using @command{targets} command with the name of the
 target which should become current.
@@ -5743,8 +5767,8 @@
 parsed, but are NOT expanded or executed. @{Curly-Braces@} are like
 'single-quote' operators in BASH shell scripts, with the added
 feature: @{curly-braces@} can be nested, single quotes can not.  @{@{@{this is
-nested 3 times@}@}@} NOTE: [date] is perhaps a bad example, as of
-28/nov/2008, Jim/OpenOCD does not have a date command.
+nested 3 times@}@}@} NOTE: [date] is a bad example;
+at this writing, Jim/OpenOCD does not have a date command.
 @end itemize
 
 @section Consequences of Rule 1/2/3/4
@@ -5967,7 +5991,7 @@
 and the text is evaluated. In case #4, they are replaced before the
 ``Target Object Command'' is executed. This occurs at the same time
 $_TARGETNAME is replaced. In case #4 the date will never
-change. @{BTW: [date] is perhaps a bad example, as of 28/nov/2008,
+change. @{BTW: [date] is a bad example; at this writing,
 Jim/OpenOCD does not have a date command@}
 @end enumerate
 @subsection Global Variables


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001054.html">[Openocd-svn] r2270 - in trunk/doc/manual: . primer
</A></li>
	<LI>Next message: <A HREF="001056.html">[Openocd-svn] r2272 - trunk/src/pld
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1055">[ date ]</a>
              <a href="thread.html#1055">[ thread ]</a>
              <a href="subject.html#1055">[ subject ]</a>
              <a href="author.html#1055">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
