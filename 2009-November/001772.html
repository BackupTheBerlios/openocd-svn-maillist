<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-163-ge8e94ab
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenocd-svn%5D%20Main%20OpenOCD%20repository%20branch%2C%20master%2C%0A%09updated.%20v0.3.0-163-ge8e94ab&In-Reply-To=%3CE1N8q1b-00010h-IN%409j8yhf1.ch3.sourceforge.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001771.html">
   <LINK REL="Next"  HREF="001773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-163-ge8e94ab</H1>
    <B>Zach Welch</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenocd-svn%5D%20Main%20OpenOCD%20repository%20branch%2C%20master%2C%0A%09updated.%20v0.3.0-163-ge8e94ab&In-Reply-To=%3CE1N8q1b-00010h-IN%409j8yhf1.ch3.sourceforge.com%3E"
       TITLE="[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-163-ge8e94ab">zwelch at users.sourceforge.net
       </A><BR>
    <I>Fri Nov 13 07:52:50 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001771.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-162-gd47764f
</A></li>
        <LI>Next message: <A HREF="001773.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-164-g5eb638c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Main OpenOCD repository&quot;.

The branch, master has been updated
       via  e8e94ab2454566fb9a226693e5c1de2264634a48 (commit)
      from  d47764ff7176b6e3d97b49e82d4db7fe17c8e552 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit e8e94ab2454566fb9a226693e5c1de2264634a48
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Thu Nov 12 21:19:41 2009 -0800

    nand: rename device to nand
    
    To be more informative (and consistent with flash and pld trees), change
    'device' parameter name to 'nand' in NAND source files.  This change
    eliminates confusing 'device-&gt;device-&gt;' instance from the code, and
    it simplifies the forthcoming command handler patches.

diff --git a/src/flash/lpc3180_nand_controller.c b/src/flash/lpc3180_nand_controller.c
index 309890c..f02c880 100644
--- a/src/flash/lpc3180_nand_controller.c
+++ b/src/flash/lpc3180_nand_controller.c
@@ -24,12 +24,12 @@
 #include &quot;lpc3180_nand_controller.h&quot;
 #include &quot;nand.h&quot;
 
-static int lpc3180_reset(struct nand_device_s *device);
-static int lpc3180_controller_ready(struct nand_device_s *device, int timeout);
+static int lpc3180_reset(struct nand_device_s *nand);
+static int lpc3180_controller_ready(struct nand_device_s *nand, int timeout);
 
 /* nand device lpc3180 &lt;target#&gt; &lt;oscillator_frequency&gt;
  */
-static int lpc3180_nand_device_command(struct command_context_s *cmd_ctx, char *cmd, char **args, int argc, struct nand_device_s *device)
+static int lpc3180_nand_device_command(struct command_context_s *cmd_ctx, char *cmd, char **args, int argc, struct nand_device_s *nand)
 {
 	if (argc &lt; 3)
 	{
@@ -49,7 +49,7 @@ static int lpc3180_nand_device_command(struct command_context_s *cmd_ctx, char *
 
 	lpc3180_nand_controller_t *lpc3180_info;
 	lpc3180_info = malloc(sizeof(lpc3180_nand_controller_t));
-	device-&gt;controller_priv = lpc3180_info;
+	nand-&gt;controller_priv = lpc3180_info;
 
 	lpc3180_info-&gt;target = target;
 	lpc3180_info-&gt;osc_freq = osc_freq;
@@ -144,13 +144,13 @@ static float lpc3180_cycle_time(lpc3180_nand_controller_t *lpc3180_info)
 	return cycle;
 }
 
-static int lpc3180_init(struct nand_device_s *device)
+static int lpc3180_init(struct nand_device_s *nand)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
-	int bus_width = (device-&gt;bus_width) ? (device-&gt;bus_width) : 8;
-	int address_cycles = (device-&gt;address_cycles) ? (device-&gt;address_cycles) : 3;
-	int page_size = (device-&gt;page_size) ? (device-&gt;page_size) : 512;
+	int bus_width = nand-&gt;bus_width ? : 8;
+	int address_cycles = nand-&gt;address_cycles ? : 3;
+	int page_size = nand-&gt;page_size ? : 512;
 
 	if (target-&gt;state != TARGET_HALTED)
 	{
@@ -174,7 +174,7 @@ static int lpc3180_init(struct nand_device_s *device)
 	}
 
 	/* inform calling code about selected bus width */
-	device-&gt;bus_width = bus_width;
+	nand-&gt;bus_width = bus_width;
 
 	if ((address_cycles != 3) &amp;&amp; (address_cycles != 4))
 	{
@@ -240,7 +240,7 @@ static int lpc3180_init(struct nand_device_s *device)
 			((trp &amp; 0xf) &lt;&lt; 8) | ((treh &amp; 0xf) &lt;&lt; 12) | ((trhz &amp; 0x7) &lt;&lt; 16) |
 			((trbwb &amp; 0x1f) &lt;&lt; 19) | ((tcea &amp; 0x3) &lt;&lt; 24));
 
-		lpc3180_reset(device);
+		lpc3180_reset(nand);
 	}
 	else if (lpc3180_info-&gt;selected_controller == LPC3180_SLC_CONTROLLER)
 	{
@@ -268,15 +268,15 @@ static int lpc3180_init(struct nand_device_s *device)
 			((r_width &amp; 0xf) &lt;&lt; 8) | ((r_rdy &amp; 0xf) &lt;&lt; 12) |  ((w_setup &amp; 0xf) &lt;&lt; 16) |
 			((w_hold &amp; 0xf) &lt;&lt; 20) | ((w_width &amp; 0xf) &lt;&lt; 24) | ((w_rdy &amp; 0xf) &lt;&lt; 28));
 
-		lpc3180_reset(device);
+		lpc3180_reset(nand);
 	}
 
 	return ERROR_OK;
 }
 
-static int lpc3180_reset(struct nand_device_s *device)
+static int lpc3180_reset(struct nand_device_s *nand)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -295,7 +295,7 @@ static int lpc3180_reset(struct nand_device_s *device)
 		/* MLC_CMD = 0xff (reset controller and NAND device) */
 		target_write_u32(target, 0x200b8000, 0xff);
 
-		if (!lpc3180_controller_ready(device, 100))
+		if (!lpc3180_controller_ready(nand, 100))
 		{
 			LOG_ERROR(&quot;LPC3180 NAND controller timed out after reset&quot;);
 			return ERROR_NAND_OPERATION_TIMEOUT;
@@ -306,7 +306,7 @@ static int lpc3180_reset(struct nand_device_s *device)
 		/* SLC_CTRL = 0x6 (ECC_CLEAR, SW_RESET) */
 		target_write_u32(target, 0x20020010, 0x6);
 
-		if (!lpc3180_controller_ready(device, 100))
+		if (!lpc3180_controller_ready(nand, 100))
 		{
 			LOG_ERROR(&quot;LPC3180 NAND controller timed out after reset&quot;);
 			return ERROR_NAND_OPERATION_TIMEOUT;
@@ -316,9 +316,9 @@ static int lpc3180_reset(struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-static int lpc3180_command(struct nand_device_s *device, uint8_t command)
+static int lpc3180_command(struct nand_device_s *nand, uint8_t command)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -346,9 +346,9 @@ static int lpc3180_command(struct nand_device_s *device, uint8_t command)
 	return ERROR_OK;
 }
 
-static int lpc3180_address(struct nand_device_s *device, uint8_t address)
+static int lpc3180_address(struct nand_device_s *nand, uint8_t address)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -376,9 +376,9 @@ static int lpc3180_address(struct nand_device_s *device, uint8_t address)
 	return ERROR_OK;
 }
 
-static int lpc3180_write_data(struct nand_device_s *device, uint16_t data)
+static int lpc3180_write_data(struct nand_device_s *nand, uint16_t data)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -406,9 +406,9 @@ static int lpc3180_write_data(struct nand_device_s *device, uint16_t data)
 	return ERROR_OK;
 }
 
-static int lpc3180_read_data(struct nand_device_s *device, void *data)
+static int lpc3180_read_data(struct nand_device_s *nand, void *data)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -425,12 +425,12 @@ static int lpc3180_read_data(struct nand_device_s *device, void *data)
 	else if (lpc3180_info-&gt;selected_controller == LPC3180_MLC_CONTROLLER)
 	{
 		/* data = MLC_DATA, use sized access */
-		if (device-&gt;bus_width == 8)
+		if (nand-&gt;bus_width == 8)
 		{
 			uint8_t *data8 = data;
 			target_read_u8(target, 0x200b0000, data8);
 		}
-		else if (device-&gt;bus_width == 16)
+		else if (nand-&gt;bus_width == 16)
 		{
 			uint16_t *data16 = data;
 			target_read_u16(target, 0x200b0000, data16);
@@ -448,12 +448,12 @@ static int lpc3180_read_data(struct nand_device_s *device, void *data)
 		/* data = SLC_DATA, must use 32-bit access */
 		target_read_u32(target, 0x20020000, &amp;data32);
 
-		if (device-&gt;bus_width == 8)
+		if (nand-&gt;bus_width == 8)
 		{
 			uint8_t *data8 = data;
 			*data8 = data32 &amp; 0xff;
 		}
-		else if (device-&gt;bus_width == 16)
+		else if (nand-&gt;bus_width == 16)
 		{
 			uint16_t *data16 = data;
 			*data16 = data32 &amp; 0xffff;
@@ -468,9 +468,9 @@ static int lpc3180_read_data(struct nand_device_s *device, void *data)
 	return ERROR_OK;
 }
 
-static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+static int lpc3180_write_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 	int retval;
 	uint8_t status;
@@ -504,7 +504,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 			return ERROR_NAND_OPERATION_NOT_SUPPORTED;
 		}
 
-		if (data_size &gt; (uint32_t)device-&gt;page_size)
+		if (data_size &gt; (uint32_t)nand-&gt;page_size)
 		{
 			LOG_ERROR(&quot;data size exceeds page size&quot;);
 			return ERROR_NAND_OPERATION_NOT_SUPPORTED;
@@ -516,7 +516,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 		page_buffer = malloc(512);
 		oob_buffer = malloc(6);
 
-		if (device-&gt;page_size == 512)
+		if (nand-&gt;page_size == 512)
 		{
 			/* MLC_ADDR = 0x0 (one column cycle) */
 			target_write_u32(target, 0x200b8004, 0x0);
@@ -525,7 +525,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 			target_write_u32(target, 0x200b8004, page &amp; 0xff);
 			target_write_u32(target, 0x200b8004, (page &gt;&gt; 8) &amp; 0xff);
 
-			if (device-&gt;address_cycles == 4)
+			if (nand-&gt;address_cycles == 4)
 				target_write_u32(target, 0x200b8004, (page &gt;&gt; 16) &amp; 0xff);
 		}
 		else
@@ -542,7 +542,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 		/* when using the MLC controller, we have to treat a large page device
 		 * as being made out of four quarters, each the size of a small page device
 		 */
-		num_quarters = (device-&gt;page_size == 2048) ? 4 : 1;
+		num_quarters = (nand-&gt;page_size == 2048) ? 4 : 1;
 
 		for (quarter = 0; quarter &lt; num_quarters; quarter++)
 		{
@@ -557,7 +557,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 				data += thisrun_data_size;
 			}
 
-			memset(oob_buffer, 0xff, (device-&gt;page_size == 512) ? 6 : 24);
+			memset(oob_buffer, 0xff, (nand-&gt;page_size == 512) ? 6 : 24);
 			if (oob)
 			{
 				memcpy(page_buffer, oob, thisrun_oob_size);
@@ -574,7 +574,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 			/* write MLC_ECC_AUTO_ENC_REG to start auto encode */
 			target_write_u32(target, 0x200b8010, 0x0);
 
-			if (!lpc3180_controller_ready(device, 1000))
+			if (!lpc3180_controller_ready(nand, 1000))
 			{
 				LOG_ERROR(&quot;timeout while waiting for completion of auto encode cycle&quot;);
 				return ERROR_NAND_OPERATION_FAILED;
@@ -584,7 +584,7 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 		/* MLC_CMD = auto program command */
 		target_write_u32(target, 0x200b8000, NAND_CMD_PAGEPROG);
 
-		if ((retval = nand_read_status(device, &amp;status)) != ERROR_OK)
+		if ((retval = nand_read_status(nand, &amp;status)) != ERROR_OK)
 		{
 			LOG_ERROR(&quot;couldn't read status&quot;);
 			return ERROR_NAND_OPERATION_FAILED;
@@ -601,15 +601,15 @@ static int lpc3180_write_page(struct nand_device_s *device, uint32_t page, uint8
 	}
 	else if (lpc3180_info-&gt;selected_controller == LPC3180_SLC_CONTROLLER)
 	{
-		return nand_write_page_raw(device, page, data, data_size, oob, oob_size);
+		return nand_write_page_raw(nand, page, data, data_size, oob, oob_size);
 	}
 
 	return ERROR_OK;
 }
 
-static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+static int lpc3180_read_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -639,13 +639,13 @@ static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_
 		}
 #endif
 
-		if (data_size &gt; (uint32_t)device-&gt;page_size)
+		if (data_size &gt; (uint32_t)nand-&gt;page_size)
 		{
 			LOG_ERROR(&quot;data size exceeds page size&quot;);
 			return ERROR_NAND_OPERATION_NOT_SUPPORTED;
 		}
 
-		if (device-&gt;page_size == 2048)
+		if (nand-&gt;page_size == 2048)
 		{
 			page_buffer = malloc(2048);
 			oob_buffer = malloc(64);
@@ -671,7 +671,7 @@ static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_
 			target_write_u32(target, 0x200b8000, NAND_CMD_READ0);
 		}
 
-		if (device-&gt;page_size == 512)
+		if (nand-&gt;page_size == 512)
 		{
 			/* small page device */
 			/* MLC_ADDR = 0x0 (one column cycle) */
@@ -681,7 +681,7 @@ static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_
 			target_write_u32(target, 0x200b8004, page &amp; 0xff);
 			target_write_u32(target, 0x200b8004, (page &gt;&gt; 8) &amp; 0xff);
 
-			if (device-&gt;address_cycles == 4)
+			if (nand-&gt;address_cycles == 4)
 				target_write_u32(target, 0x200b8004, (page &gt;&gt; 16) &amp; 0xff);
 		}
 		else
@@ -699,12 +699,12 @@ static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_
 			target_write_u32(target, 0x200b8000, NAND_CMD_READSTART);
 		}
 
-		while (page_bytes_done &lt; (uint32_t)device-&gt;page_size)
+		while (page_bytes_done &lt; (uint32_t)nand-&gt;page_size)
 		{
 			/* MLC_ECC_AUTO_DEC_REG = dummy */
 			target_write_u32(target, 0x200b8014, 0xaa55aa55);
 
-			if (!lpc3180_controller_ready(device, 1000))
+			if (!lpc3180_controller_ready(nand, 1000))
 			{
 				LOG_ERROR(&quot;timeout while waiting for completion of auto decode cycle&quot;);
 				return ERROR_NAND_OPERATION_FAILED;
@@ -748,15 +748,15 @@ static int lpc3180_read_page(struct nand_device_s *device, uint32_t page, uint8_
 	}
 	else if (lpc3180_info-&gt;selected_controller == LPC3180_SLC_CONTROLLER)
 	{
-		return nand_read_page_raw(device, page, data, data_size, oob, oob_size);
+		return nand_read_page_raw(nand, page, data, data_size, oob, oob_size);
 	}
 
 	return ERROR_OK;
 }
 
-static int lpc3180_controller_ready(struct nand_device_s *device, int timeout)
+static int lpc3180_controller_ready(struct nand_device_s *nand, int timeout)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 	uint8_t status = 0x0;
 
@@ -788,9 +788,9 @@ static int lpc3180_controller_ready(struct nand_device_s *device, int timeout)
 	return 0;
 }
 
-static int lpc3180_nand_ready(struct nand_device_s *device, int timeout)
+static int lpc3180_nand_ready(struct nand_device_s *nand, int timeout)
 {
-	lpc3180_nand_controller_t *lpc3180_info = device-&gt;controller_priv;
+	lpc3180_nand_controller_t *lpc3180_info = nand-&gt;controller_priv;
 	target_t *target = lpc3180_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -843,14 +843,14 @@ static int handle_lpc3180_select_command(struct command_context_s *cmd_ctx, char
 
 	unsigned num;
 	COMMAND_PARSE_NUMBER(uint, args[1], num);
-	nand_device_t *device = get_nand_device_by_num(num);
-	if (!device)
+	nand_device_t *nand = get_nand_device_by_num(num);
+	if (!nand)
 	{
 		command_print(cmd_ctx, &quot;nand device '#%s' is out of bounds&quot;, args[0]);
 		return ERROR_OK;
 	}
 
-	lpc3180_info = device-&gt;controller_priv;
+	lpc3180_info = nand-&gt;controller_priv;
 
 	if (argc == 2)
 	{
diff --git a/src/flash/mx3_nand.c b/src/flash/mx3_nand.c
index 62603d9..f6a75ef 100644
--- a/src/flash/mx3_nand.c
+++ b/src/flash/mx3_nand.c
@@ -49,21 +49,21 @@ unsigned char sign_of_sequental_byte_read;
 
 static int test_iomux_settings (target_t * target, uint32_t value,
 				uint32_t mask, const char *text);
-static int initialize_nf_controller (struct nand_device_s *device);
+static int initialize_nf_controller (struct nand_device_s *nand);
 static int get_next_byte_from_sram_buffer (target_t * target, uint8_t * value);
 static int get_next_halfword_from_sram_buffer (target_t * target,
 					       uint16_t * value);
 static int poll_for_complete_op (target_t * target, const char *text);
-static int validate_target_state (struct nand_device_s *device);
-static int do_data_output (struct nand_device_s *device);
+static int validate_target_state (struct nand_device_s *nand);
+static int do_data_output (struct nand_device_s *nand);
 
-static int imx31_command (struct nand_device_s *device, uint8_t command);
-static int imx31_address (struct nand_device_s *device, uint8_t address);
-static int imx31_controller_ready (struct nand_device_s *device, int tout);
+static int imx31_command (struct nand_device_s *nand, uint8_t command);
+static int imx31_address (struct nand_device_s *nand, uint8_t address);
+static int imx31_controller_ready (struct nand_device_s *nand, int tout);
 
 static int imx31_nand_device_command (struct command_context_s *cmd_ctx,
 				      char *cmd, char **args, int argc,
-				      struct nand_device_s *device)
+				      struct nand_device_s *nand)
 {
 	mx3_nf_controller_t *mx3_nf_info;
 	mx3_nf_info = malloc (sizeof (mx3_nf_controller_t));
@@ -73,7 +73,7 @@ static int imx31_nand_device_command (struct command_context_s *cmd_ctx,
 	    return ERROR_FAIL;
 	}
 
-	device-&gt;controller_priv = mx3_nf_info;
+	nand-&gt;controller_priv = mx3_nf_info;
 
 	mx3_nf_info-&gt;target = get_target (args[1]);
 	if (mx3_nf_info-&gt;target == NULL)
@@ -123,9 +123,9 @@ static int imx31_nand_device_command (struct command_context_s *cmd_ctx,
 	return ERROR_OK;
 }
 
-static int imx31_init (struct nand_device_s *device)
+static int imx31_init (struct nand_device_s *nand)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 
 	{
@@ -133,7 +133,7 @@ static int imx31_init (struct nand_device_s *device)
 	 * validate target state
 	 */
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state(nand);
 	if (validate_target_result != ERROR_OK)
 	    {
 		return validate_target_result;
@@ -149,30 +149,30 @@ static int imx31_init (struct nand_device_s *device)
 	{
 	uint32_t pcsr_register_content;
 	target_read_u32 (target, MX3_PCSR, &amp;pcsr_register_content);
-	if (!device-&gt;bus_width)
+	if (!nand-&gt;bus_width)
 	    {
-		device-&gt;bus_width =
+		nand-&gt;bus_width =
 		    (pcsr_register_content &amp; 0x80000000) ? 16 : 8;
 	    }
 	else
 	    {
 		pcsr_register_content |=
-		    ((device-&gt;bus_width == 16) ? 0x80000000 : 0x00000000);
+		    ((nand-&gt;bus_width == 16) ? 0x80000000 : 0x00000000);
 		target_write_u32 (target, MX3_PCSR, pcsr_register_content);
 	    }
 
-	if (!device-&gt;page_size)
+	if (!nand-&gt;page_size)
 	    {
-		device-&gt;page_size =
+		nand-&gt;page_size =
 		    (pcsr_register_content &amp; 0x40000000) ? 2048 : 512;
 	    }
 	else
 	    {
 		pcsr_register_content |=
-		    ((device-&gt;page_size == 2048) ? 0x40000000 : 0x00000000);
+		    ((nand-&gt;page_size == 2048) ? 0x40000000 : 0x00000000);
 		target_write_u32 (target, MX3_PCSR, pcsr_register_content);
 	    }
-	if (mx3_nf_info-&gt;flags.one_kb_sram &amp;&amp; (device-&gt;page_size == 2048))
+	if (mx3_nf_info-&gt;flags.one_kb_sram &amp;&amp; (nand-&gt;page_size == 2048))
 	    {
 		LOG_ERROR
 		    (&quot;NAND controller have only 1 kb SRAM, so pagesize 2048 is incompatible with it&quot;);
@@ -212,7 +212,7 @@ static int imx31_init (struct nand_device_s *device)
 	    test_iomux_settings (target, 0x43fac0c4, 0x7f7f7f7f, &quot;d3,d4,d5,d6&quot;);
 	test_iomux |=
 	    test_iomux_settings (target, 0x43fac0c8, 0x0000007f, &quot;d7&quot;);
-	if (device-&gt;bus_width == 16)
+	if (nand-&gt;bus_width == 16)
 	    {
 		test_iomux |=
 		    test_iomux_settings (target, 0x43fac0c8, 0x7f7f7f00,
@@ -235,15 +235,15 @@ static int imx31_init (struct nand_device_s *device)
 	    }
 	}
 
-	initialize_nf_controller (device);
+	initialize_nf_controller (nand);
 
 	{
 	int retval;
 	uint16_t nand_status_content;
 	retval = ERROR_OK;
-	retval |= imx31_command (device, NAND_CMD_STATUS);
-	retval |= imx31_address (device, 0x00);
-	retval |= do_data_output (device);
+	retval |= imx31_command (nand, NAND_CMD_STATUS);
+	retval |= imx31_address (nand, 0x00);
+	retval |= do_data_output (nand);
 	if (retval != ERROR_OK)
 	    {
 		LOG_ERROR (get_status_register_err_msg);
@@ -266,16 +266,16 @@ static int imx31_init (struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-static int imx31_read_data (struct nand_device_s *device, void *data)
+static int imx31_read_data (struct nand_device_s *nand, void *data)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 	{
 	/*
 	 * validate target state
 	 */
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state (nand);
 	if (validate_target_result != ERROR_OK)
 	    {
 		return validate_target_result;
@@ -287,14 +287,14 @@ static int imx31_read_data (struct nand_device_s *device, void *data)
 	 * get data from nand chip
 	 */
 	int try_data_output_from_nand_chip;
-	try_data_output_from_nand_chip = do_data_output (device);
+	try_data_output_from_nand_chip = do_data_output (nand);
 	if (try_data_output_from_nand_chip != ERROR_OK)
 	    {
 		return try_data_output_from_nand_chip;
 	    }
 	}
 
-	if (device-&gt;bus_width == 16)
+	if (nand-&gt;bus_width == 16)
 	{
 	    get_next_halfword_from_sram_buffer (target, data);
 	}
@@ -306,15 +306,15 @@ static int imx31_read_data (struct nand_device_s *device, void *data)
 	return ERROR_OK;
 }
 
-static int imx31_write_data (struct nand_device_s *device, uint16_t data)
+static int imx31_write_data (struct nand_device_s *nand, uint16_t data)
 {
 	LOG_ERROR (&quot;write_data() not implemented&quot;);
 	return ERROR_NAND_OPERATION_FAILED;
 }
 
-static int imx31_nand_ready (struct nand_device_s *device, int timeout)
+static int imx31_nand_ready (struct nand_device_s *nand, int timeout)
 {
-	return imx31_controller_ready (device, timeout);
+	return imx31_controller_ready (nand, timeout);
 }
 
 static int imx31_register_commands (struct command_context_s *cmd_ctx)
@@ -322,31 +322,31 @@ static int imx31_register_commands (struct command_context_s *cmd_ctx)
 	return ERROR_OK;
 }
 
-static int imx31_reset (struct nand_device_s *device)
+static int imx31_reset (struct nand_device_s *nand)
 {
 	/*
 	* validate target state
 	*/
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state (nand);
 	if (validate_target_result != ERROR_OK)
 	{
 	    return validate_target_result;
 	}
-	initialize_nf_controller (device);
+	initialize_nf_controller (nand);
 	return ERROR_OK;
 }
 
-static int imx31_command (struct nand_device_s *device, uint8_t command)
+static int imx31_command (struct nand_device_s *nand, uint8_t command)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 	{
 	/*
 	 * validate target state
 	 */
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state (nand);
 	if (validate_target_result != ERROR_OK)
 	    {
 		return validate_target_result;
@@ -369,7 +369,7 @@ static int imx31_command (struct nand_device_s *device, uint8_t command)
 		 * offset == one half of page size
 		 */
 		in_sram_address =
-		    MX3_NF_MAIN_BUFFER0 + (device-&gt;page_size &gt;&gt; 1);
+		    MX3_NF_MAIN_BUFFER0 + (nand-&gt;page_size &gt;&gt; 1);
 	    default:
 		in_sram_address = MX3_NF_MAIN_BUFFER0;
 	}
@@ -411,16 +411,16 @@ static int imx31_command (struct nand_device_s *device, uint8_t command)
 	return ERROR_OK;
 }
 
-static int imx31_address (struct nand_device_s *device, uint8_t address)
+static int imx31_address (struct nand_device_s *nand, uint8_t address)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 	{
 	/*
 	 * validate target state
 	 */
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state (nand);
 	if (validate_target_result != ERROR_OK)
 	    {
 		return validate_target_result;
@@ -443,10 +443,10 @@ static int imx31_address (struct nand_device_s *device, uint8_t address)
 	return ERROR_OK;
 }
 
-static int imx31_controller_ready (struct nand_device_s *device, int tout)
+static int imx31_controller_ready (struct nand_device_s *nand, int tout)
 {
 	uint16_t poll_complete_status;
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 
 	{
@@ -454,7 +454,7 @@ static int imx31_controller_ready (struct nand_device_s *device, int tout)
 	 * validate target state
 	 */
 	int validate_target_result;
-	validate_target_result = validate_target_state (device);
+	validate_target_result = validate_target_state (nand);
 	if (validate_target_result != ERROR_OK)
 	    {
 		return validate_target_result;
@@ -474,11 +474,11 @@ static int imx31_controller_ready (struct nand_device_s *device, int tout)
 	return tout;
 }
 
-static int imx31_write_page (struct nand_device_s *device, uint32_t page,
+static int imx31_write_page (struct nand_device_s *nand, uint32_t page,
 			     uint8_t * data, uint32_t data_size, uint8_t * oob,
 			     uint32_t oob_size)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 
 	if (data_size % 2)
@@ -501,7 +501,7 @@ static int imx31_write_page (struct nand_device_s *device, uint32_t page,
 	 * validate target state
 	 */
 	int retval;
-	retval = validate_target_state (device);
+	retval = validate_target_state (nand);
 	if (retval != ERROR_OK)
 	    {
 		return retval;
@@ -509,16 +509,16 @@ static int imx31_write_page (struct nand_device_s *device, uint32_t page,
 	}
 	{
 	int retval = ERROR_OK;
-	retval |= imx31_command (device, NAND_CMD_SEQIN);
-	retval |= imx31_address (device, 0x00);
-	retval |= imx31_address (device, page &amp; 0xff);
-	retval |= imx31_address (device, (page &gt;&gt; 8) &amp; 0xff);
-	if (device-&gt;address_cycles &gt;= 4)
-	    {
-		retval |= imx31_address (device, (page &gt;&gt; 16) &amp; 0xff);
-		if (device-&gt;address_cycles &gt;= 5)
+	retval |= imx31_command(nand, NAND_CMD_SEQIN);
+	retval |= imx31_address(nand, 0x00);
+	retval |= imx31_address(nand, page &amp; 0xff);
+	retval |= imx31_address(nand, (page &gt;&gt; 8) &amp; 0xff);
+	if (nand-&gt;address_cycles &gt;= 4)
+	    {
+		retval |= imx31_address (nand, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
 		    {
-			retval |= imx31_address (device, (page &gt;&gt; 24) &amp; 0xff);
+			retval |= imx31_address (nand, (page &gt;&gt; 24) &amp; 0xff);
 		    }
 	    }
 	target_write_buffer (target, MX3_NF_MAIN_BUFFER0, data_size, data);
@@ -548,7 +548,7 @@ static int imx31_write_page (struct nand_device_s *device, uint32_t page,
 		    return poll_result;
 		}
 	}
-	retval |= imx31_command (device, NAND_CMD_PAGEPROG);
+	retval |= imx31_command (nand, NAND_CMD_PAGEPROG);
 	if (retval != ERROR_OK)
 	    {
 		return retval;
@@ -560,9 +560,9 @@ static int imx31_write_page (struct nand_device_s *device, uint32_t page,
 	{
 	    uint16_t nand_status_content;
 	    retval = ERROR_OK;
-	    retval |= imx31_command (device, NAND_CMD_STATUS);
-	    retval |= imx31_address (device, 0x00);
-	    retval |= do_data_output (device);
+	    retval |= imx31_command(nand, NAND_CMD_STATUS);
+	    retval |= imx31_address(nand, 0x00);
+	    retval |= do_data_output(nand);
 	    if (retval != ERROR_OK)
 		{
 		    LOG_ERROR (get_status_register_err_msg);
@@ -581,11 +581,11 @@ static int imx31_write_page (struct nand_device_s *device, uint32_t page,
 	return ERROR_OK;
 }
 
-static int imx31_read_page (struct nand_device_s *device, uint32_t page,
+static int imx31_read_page (struct nand_device_s *nand, uint32_t page,
 			    uint8_t * data, uint32_t data_size, uint8_t * oob,
 			    uint32_t oob_size)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 
 	if (data_size % 2)
@@ -604,7 +604,7 @@ static int imx31_read_page (struct nand_device_s *device, uint32_t page,
 	 * validate target state
 	 */
 	int retval;
-	retval = validate_target_state (device);
+	retval = validate_target_state(nand);
 	if (retval != ERROR_OK)
 	    {
 		return retval;
@@ -612,20 +612,20 @@ static int imx31_read_page (struct nand_device_s *device, uint32_t page,
 	}
 	{
 	int retval = ERROR_OK;
-	retval |= imx31_command (device, NAND_CMD_READ0);
-	retval |= imx31_address (device, 0x00);
-	retval |= imx31_address (device, page &amp; 0xff);
-	retval |= imx31_address (device, (page &gt;&gt; 8) &amp; 0xff);
-	if (device-&gt;address_cycles &gt;= 4)
-	    {
-		retval |= imx31_address (device, (page &gt;&gt; 16) &amp; 0xff);
-		if (device-&gt;address_cycles &gt;= 5)
+	retval |= imx31_command(nand, NAND_CMD_READ0);
+	retval |= imx31_address(nand, 0x00);
+	retval |= imx31_address(nand, page &amp; 0xff);
+	retval |= imx31_address(nand, (page &gt;&gt; 8) &amp; 0xff);
+	if (nand-&gt;address_cycles &gt;= 4)
+	    {
+		retval |= imx31_address(nand, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
 		    {
-			retval |= imx31_address (device, (page &gt;&gt; 24) &amp; 0xff);
-			retval |= imx31_command (device, NAND_CMD_READSTART);
+			retval |= imx31_address(nand, (page &gt;&gt; 24) &amp; 0xff);
+			retval |= imx31_command(nand, NAND_CMD_READSTART);
 		    }
 	    }
-	retval |= do_data_output (device);
+	retval |= do_data_output (nand);
 	if (retval != ERROR_OK)
 	    {
 		return retval;
@@ -658,9 +658,9 @@ static int test_iomux_settings (target_t * target, uint32_t address,
 	return ERROR_OK;
 }
 
-static int initialize_nf_controller (struct nand_device_s *device)
+static int initialize_nf_controller (struct nand_device_s *nand)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 	/*
 	* resets NAND flash controller in zero time ? I dont know.
@@ -786,9 +786,9 @@ static int poll_for_complete_op (target_t * target, const char *text)
 	return ERROR_OK;
 }
 
-static int validate_target_state (struct nand_device_s *device)
+static int validate_target_state (struct nand_device_s *nand)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED)
@@ -808,9 +808,9 @@ static int validate_target_state (struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-static int do_data_output (struct nand_device_s *device)
+static int do_data_output (struct nand_device_s *nand)
 {
-	mx3_nf_controller_t *mx3_nf_info = device-&gt;controller_priv;
+	mx3_nf_controller_t *mx3_nf_info = nand-&gt;controller_priv;
 	target_t *target = mx3_nf_info-&gt;target;
 	switch (mx3_nf_info-&gt;fin)
 	{
diff --git a/src/flash/nand.c b/src/flash/nand.c
index c1be276..4d32d25 100644
--- a/src/flash/nand.c
+++ b/src/flash/nand.c
@@ -28,10 +28,10 @@
 #include &quot;time_support.h&quot;
 #include &quot;fileio.h&quot;
 
-static int nand_read_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
-//static int nand_read_plain(struct nand_device_s *device, uint32_t address, uint8_t *data, uint32_t data_size);
+static int nand_read_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
+//static int nand_read_plain(struct nand_device_s *nand, uint32_t address, uint8_t *data, uint32_t data_size);
 
-static int nand_write_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
+static int nand_write_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
 
 /* NAND flash controller
  */
@@ -304,89 +304,89 @@ nand_device_t *get_nand_device_by_num(int num)
 }
 
 int nand_command_get_device_by_num(struct command_context_s *cmd_ctx,
-		const char *str, nand_device_t **device)
+		const char *str, nand_device_t **nand)
 {
 	unsigned num;
 	COMMAND_PARSE_NUMBER(uint, str, num);
-	*device = get_nand_device_by_num(num);
-	if (!*device) {
+	*nand = get_nand_device_by_num(num);
+	if (!*nand) {
 		command_print(cmd_ctx, &quot;NAND flash device '#%s' is out of bounds&quot;, str);
 		return ERROR_INVALID_ARGUMENTS;
 	}
 	return ERROR_OK;
 }
 
-static int nand_build_bbt(struct nand_device_s *device, int first, int last)
+static int nand_build_bbt(struct nand_device_s *nand, int first, int last)
 {
 	uint32_t page = 0x0;
 	int i;
 	uint8_t oob[6];
 
-	if ((first &lt; 0) || (first &gt;= device-&gt;num_blocks))
+	if ((first &lt; 0) || (first &gt;= nand-&gt;num_blocks))
 		first = 0;
 
-	if ((last &gt;= device-&gt;num_blocks) || (last == -1))
-		last = device-&gt;num_blocks - 1;
+	if ((last &gt;= nand-&gt;num_blocks) || (last == -1))
+		last = nand-&gt;num_blocks - 1;
 
 	for (i = first; i &lt; last; i++)
 	{
-		nand_read_page(device, page, NULL, 0, oob, 6);
+		nand_read_page(nand, page, NULL, 0, oob, 6);
 
-		if (((device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16) &amp;&amp; ((oob[0] &amp; oob[1]) != 0xff))
-			|| (((device-&gt;page_size == 512) &amp;&amp; (oob[5] != 0xff)) ||
-				((device-&gt;page_size == 2048) &amp;&amp; (oob[0] != 0xff))))
+		if (((nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16) &amp;&amp; ((oob[0] &amp; oob[1]) != 0xff))
+			|| (((nand-&gt;page_size == 512) &amp;&amp; (oob[5] != 0xff)) ||
+				((nand-&gt;page_size == 2048) &amp;&amp; (oob[0] != 0xff))))
 		{
 			LOG_WARNING(&quot;bad block: %i&quot;, i);
-			device-&gt;blocks[i].is_bad = 1;
+			nand-&gt;blocks[i].is_bad = 1;
 		}
 		else
 		{
-			device-&gt;blocks[i].is_bad = 0;
+			nand-&gt;blocks[i].is_bad = 0;
 		}
 
-		page += (device-&gt;erase_size / device-&gt;page_size);
+		page += (nand-&gt;erase_size / nand-&gt;page_size);
 	}
 
 	return ERROR_OK;
 }
 
-int nand_read_status(struct nand_device_s *device, uint8_t *status)
+int nand_read_status(struct nand_device_s *nand, uint8_t *status)
 {
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
 	/* Send read status command */
-	device-&gt;controller-&gt;command(device, NAND_CMD_STATUS);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_STATUS);
 
 	alive_sleep(1);
 
 	/* read status */
-	if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+	if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
 	{
 		uint16_t data;
-		device-&gt;controller-&gt;read_data(device, &amp;data);
+		nand-&gt;controller-&gt;read_data(nand, &amp;data);
 		*status = data &amp; 0xff;
 	}
 	else
 	{
-		device-&gt;controller-&gt;read_data(device, status);
+		nand-&gt;controller-&gt;read_data(nand, status);
 	}
 
 	return ERROR_OK;
 }
 
-static int nand_poll_ready(struct nand_device_s *device, int timeout)
+static int nand_poll_ready(struct nand_device_s *nand, int timeout)
 {
 	uint8_t status;
 
-	device-&gt;controller-&gt;command(device, NAND_CMD_STATUS);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_STATUS);
 	do {
-		if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16) {
+		if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16) {
 			uint16_t data;
-			device-&gt;controller-&gt;read_data(device, &amp;data);
+			nand-&gt;controller-&gt;read_data(nand, &amp;data);
 			status = data &amp; 0xff;
 		} else {
-			device-&gt;controller-&gt;read_data(device, &amp;status);
+			nand-&gt;controller-&gt;read_data(nand, &amp;status);
 		}
 		if (status &amp; NAND_STATUS_READY)
 			break;
@@ -396,7 +396,7 @@ static int nand_poll_ready(struct nand_device_s *device, int timeout)
 	return (status &amp; NAND_STATUS_READY) != 0;
 }
 
-int nand_probe(struct nand_device_s *device)
+int nand_probe(struct nand_device_s *nand)
 {
 	uint8_t manufacturer_id, device_id;
 	uint8_t id_buff[6];
@@ -404,17 +404,17 @@ int nand_probe(struct nand_device_s *device)
 	int i;
 
 	/* clear device data */
-	device-&gt;device = NULL;
-	device-&gt;manufacturer = NULL;
+	nand-&gt;device = NULL;
+	nand-&gt;manufacturer = NULL;
 
 	/* clear device parameters */
-	device-&gt;bus_width = 0;
-	device-&gt;address_cycles = 0;
-	device-&gt;page_size = 0;
-	device-&gt;erase_size = 0;
+	nand-&gt;bus_width = 0;
+	nand-&gt;address_cycles = 0;
+	nand-&gt;page_size = 0;
+	nand-&gt;erase_size = 0;
 
 	/* initialize controller (device parameters are zero, use controller default) */
-	if ((retval = device-&gt;controller-&gt;init(device) != ERROR_OK))
+	if ((retval = nand-&gt;controller-&gt;init(nand) != ERROR_OK))
 	{
 		switch (retval)
 		{
@@ -430,23 +430,23 @@ int nand_probe(struct nand_device_s *device)
 		}
 	}
 
-	device-&gt;controller-&gt;command(device, NAND_CMD_RESET);
-	device-&gt;controller-&gt;reset(device);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_RESET);
+	nand-&gt;controller-&gt;reset(nand);
 
-	device-&gt;controller-&gt;command(device, NAND_CMD_READID);
-	device-&gt;controller-&gt;address(device, 0x0);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_READID);
+	nand-&gt;controller-&gt;address(nand, 0x0);
 
-	if (device-&gt;bus_width == 8)
+	if (nand-&gt;bus_width == 8)
 	{
-		device-&gt;controller-&gt;read_data(device, &amp;manufacturer_id);
-		device-&gt;controller-&gt;read_data(device, &amp;device_id);
+		nand-&gt;controller-&gt;read_data(nand, &amp;manufacturer_id);
+		nand-&gt;controller-&gt;read_data(nand, &amp;device_id);
 	}
 	else
 	{
 		uint16_t data_buf;
-		device-&gt;controller-&gt;read_data(device, &amp;data_buf);
+		nand-&gt;controller-&gt;read_data(nand, &amp;data_buf);
 		manufacturer_id = data_buf &amp; 0xff;
-		device-&gt;controller-&gt;read_data(device, &amp;data_buf);
+		nand-&gt;controller-&gt;read_data(nand, &amp;data_buf);
 		device_id = data_buf &amp; 0xff;
 	}
 
@@ -454,7 +454,7 @@ int nand_probe(struct nand_device_s *device)
 	{
 		if (nand_flash_ids[i].id == device_id)
 		{
-			device-&gt;device = &amp;nand_flash_ids[i];
+			nand-&gt;device = &amp;nand_flash_ids[i];
 			break;
 		}
 	}
@@ -463,127 +463,127 @@ int nand_probe(struct nand_device_s *device)
 	{
 		if (nand_manuf_ids[i].id == manufacturer_id)
 		{
-			device-&gt;manufacturer = &amp;nand_manuf_ids[i];
+			nand-&gt;manufacturer = &amp;nand_manuf_ids[i];
 			break;
 		}
 	}
 
-	if (!device-&gt;manufacturer)
+	if (!nand-&gt;manufacturer)
 	{
-		device-&gt;manufacturer = &amp;nand_manuf_ids[0];
-		device-&gt;manufacturer-&gt;id = manufacturer_id;
+		nand-&gt;manufacturer = &amp;nand_manuf_ids[0];
+		nand-&gt;manufacturer-&gt;id = manufacturer_id;
 	}
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 	{
 		LOG_ERROR(&quot;unknown NAND flash device found, manufacturer id: 0x%2.2x device id: 0x%2.2x&quot;,
 			manufacturer_id, device_id);
 		return ERROR_NAND_OPERATION_FAILED;
 	}
 
-	LOG_DEBUG(&quot;found %s (%s)&quot;, device-&gt;device-&gt;name, device-&gt;manufacturer-&gt;name);
+	LOG_DEBUG(&quot;found %s (%s)&quot;, nand-&gt;device-&gt;name, nand-&gt;manufacturer-&gt;name);
 
 	/* initialize device parameters */
 
 	/* bus width */
-	if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
-		device-&gt;bus_width = 16;
+	if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+		nand-&gt;bus_width = 16;
 	else
-		device-&gt;bus_width = 8;
+		nand-&gt;bus_width = 8;
 
 	/* Do we need extended device probe information? */
-	if (device-&gt;device-&gt;page_size == 0 ||
-	    device-&gt;device-&gt;erase_size == 0)
+	if (nand-&gt;device-&gt;page_size == 0 ||
+	    nand-&gt;device-&gt;erase_size == 0)
 	{
-		if (device-&gt;bus_width == 8)
+		if (nand-&gt;bus_width == 8)
 		{
-			device-&gt;controller-&gt;read_data(device, id_buff + 3);
-			device-&gt;controller-&gt;read_data(device, id_buff + 4);
-			device-&gt;controller-&gt;read_data(device, id_buff + 5);
+			nand-&gt;controller-&gt;read_data(nand, id_buff + 3);
+			nand-&gt;controller-&gt;read_data(nand, id_buff + 4);
+			nand-&gt;controller-&gt;read_data(nand, id_buff + 5);
 		}
 		else
 		{
 			uint16_t data_buf;
 
-			device-&gt;controller-&gt;read_data(device, &amp;data_buf);
+			nand-&gt;controller-&gt;read_data(nand, &amp;data_buf);
 			id_buff[3] = data_buf;
 
-			device-&gt;controller-&gt;read_data(device, &amp;data_buf);
+			nand-&gt;controller-&gt;read_data(nand, &amp;data_buf);
 			id_buff[4] = data_buf;
 
-			device-&gt;controller-&gt;read_data(device, &amp;data_buf);
+			nand-&gt;controller-&gt;read_data(nand, &amp;data_buf);
 			id_buff[5] = data_buf &gt;&gt; 8;
 		}
 	}
 
 	/* page size */
-	if (device-&gt;device-&gt;page_size == 0)
+	if (nand-&gt;device-&gt;page_size == 0)
 	{
-		device-&gt;page_size = 1 &lt;&lt; (10 + (id_buff[4] &amp; 3));
+		nand-&gt;page_size = 1 &lt;&lt; (10 + (id_buff[4] &amp; 3));
 	}
-	else if (device-&gt;device-&gt;page_size == 256)
+	else if (nand-&gt;device-&gt;page_size == 256)
 	{
 		LOG_ERROR(&quot;NAND flashes with 256 byte pagesize are not supported&quot;);
 		return ERROR_NAND_OPERATION_FAILED;
 	}
 	else
 	{
-		device-&gt;page_size = device-&gt;device-&gt;page_size;
+		nand-&gt;page_size = nand-&gt;device-&gt;page_size;
 	}
 
 	/* number of address cycles */
-	if (device-&gt;page_size &lt;= 512)
+	if (nand-&gt;page_size &lt;= 512)
 	{
 		/* small page devices */
-		if (device-&gt;device-&gt;chip_size &lt;= 32)
-			device-&gt;address_cycles = 3;
-		else if (device-&gt;device-&gt;chip_size &lt;= 8*1024)
-			device-&gt;address_cycles = 4;
+		if (nand-&gt;device-&gt;chip_size &lt;= 32)
+			nand-&gt;address_cycles = 3;
+		else if (nand-&gt;device-&gt;chip_size &lt;= 8*1024)
+			nand-&gt;address_cycles = 4;
 		else
 		{
 			LOG_ERROR(&quot;BUG: small page NAND device with more than 8 GiB encountered&quot;);
-			device-&gt;address_cycles = 5;
+			nand-&gt;address_cycles = 5;
 		}
 	}
 	else
 	{
 		/* large page devices */
-		if (device-&gt;device-&gt;chip_size &lt;= 128)
-			device-&gt;address_cycles = 4;
-		else if (device-&gt;device-&gt;chip_size &lt;= 32*1024)
-			device-&gt;address_cycles = 5;
+		if (nand-&gt;device-&gt;chip_size &lt;= 128)
+			nand-&gt;address_cycles = 4;
+		else if (nand-&gt;device-&gt;chip_size &lt;= 32*1024)
+			nand-&gt;address_cycles = 5;
 		else
 		{
 			LOG_ERROR(&quot;BUG: large page NAND device with more than 32 GiB encountered&quot;);
-			device-&gt;address_cycles = 6;
+			nand-&gt;address_cycles = 6;
 		}
 	}
 
 	/* erase size */
-	if (device-&gt;device-&gt;erase_size == 0)
+	if (nand-&gt;device-&gt;erase_size == 0)
 	{
 		switch ((id_buff[4] &gt;&gt; 4) &amp; 3) {
 		case 0:
-			device-&gt;erase_size = 64 &lt;&lt; 10;
+			nand-&gt;erase_size = 64 &lt;&lt; 10;
 			break;
 		case 1:
-			device-&gt;erase_size = 128 &lt;&lt; 10;
+			nand-&gt;erase_size = 128 &lt;&lt; 10;
 			break;
 		case 2:
-			device-&gt;erase_size = 256 &lt;&lt; 10;
+			nand-&gt;erase_size = 256 &lt;&lt; 10;
 			break;
 		case 3:
-			device-&gt;erase_size =512 &lt;&lt; 10;
+			nand-&gt;erase_size =512 &lt;&lt; 10;
 			break;
 		}
 	}
 	else
 	{
-		device-&gt;erase_size = device-&gt;device-&gt;erase_size;
+		nand-&gt;erase_size = nand-&gt;device-&gt;erase_size;
 	}
 
 	/* initialize controller, but leave parameters at the controllers default */
-	if ((retval = device-&gt;controller-&gt;init(device) != ERROR_OK))
+	if ((retval = nand-&gt;controller-&gt;init(nand) != ERROR_OK))
 	{
 		switch (retval)
 		{
@@ -592,7 +592,7 @@ int nand_probe(struct nand_device_s *device)
 				return ERROR_NAND_OPERATION_FAILED;
 			case ERROR_NAND_OPERATION_NOT_SUPPORTED:
 				LOG_ERROR(&quot;controller doesn't support requested parameters (buswidth: %i, address cycles: %i, page size: %i)&quot;,
-					device-&gt;bus_width, device-&gt;address_cycles, device-&gt;page_size);
+					nand-&gt;bus_width, nand-&gt;address_cycles, nand-&gt;page_size);
 				return ERROR_NAND_OPERATION_FAILED;
 			default:
 				LOG_ERROR(&quot;BUG: unknown controller initialization failure&quot;);
@@ -600,39 +600,39 @@ int nand_probe(struct nand_device_s *device)
 		}
 	}
 
-	device-&gt;num_blocks = (device-&gt;device-&gt;chip_size * 1024) / (device-&gt;erase_size / 1024);
-	device-&gt;blocks = malloc(sizeof(nand_block_t) * device-&gt;num_blocks);
+	nand-&gt;num_blocks = (nand-&gt;device-&gt;chip_size * 1024) / (nand-&gt;erase_size / 1024);
+	nand-&gt;blocks = malloc(sizeof(nand_block_t) * nand-&gt;num_blocks);
 
-	for (i = 0; i &lt; device-&gt;num_blocks; i++)
+	for (i = 0; i &lt; nand-&gt;num_blocks; i++)
 	{
-		device-&gt;blocks[i].size = device-&gt;erase_size;
-		device-&gt;blocks[i].offset = i * device-&gt;erase_size;
-		device-&gt;blocks[i].is_erased = -1;
-		device-&gt;blocks[i].is_bad = -1;
+		nand-&gt;blocks[i].size = nand-&gt;erase_size;
+		nand-&gt;blocks[i].offset = i * nand-&gt;erase_size;
+		nand-&gt;blocks[i].is_erased = -1;
+		nand-&gt;blocks[i].is_bad = -1;
 	}
 
 	return ERROR_OK;
 }
 
-static int nand_erase(struct nand_device_s *device, int first_block, int last_block)
+static int nand_erase(struct nand_device_s *nand, int first_block, int last_block)
 {
 	int i;
 	uint32_t page;
 	uint8_t status;
 	int retval;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	if ((first_block &lt; 0) || (last_block &gt; device-&gt;num_blocks))
+	if ((first_block &lt; 0) || (last_block &gt; nand-&gt;num_blocks))
 		return ERROR_INVALID_ARGUMENTS;
 
 	/* make sure we know if a block is bad before erasing it */
 	for (i = first_block; i &lt;= last_block; i++)
 	{
-		if (device-&gt;blocks[i].is_bad == -1)
+		if (nand-&gt;blocks[i].is_bad == -1)
 		{
-			nand_build_bbt(device, i, last_block);
+			nand_build_bbt(nand, i, last_block);
 			break;
 		}
 	}
@@ -640,48 +640,48 @@ static int nand_erase(struct nand_device_s *device, int first_block, int last_bl
 	for (i = first_block; i &lt;= last_block; i++)
 	{
 		/* Send erase setup command */
-		device-&gt;controller-&gt;command(device, NAND_CMD_ERASE1);
+		nand-&gt;controller-&gt;command(nand, NAND_CMD_ERASE1);
 
-		page = i * (device-&gt;erase_size / device-&gt;page_size);
+		page = i * (nand-&gt;erase_size / nand-&gt;page_size);
 
 		/* Send page address */
-		if (device-&gt;page_size &lt;= 512)
+		if (nand-&gt;page_size &lt;= 512)
 		{
 			/* row */
-			device-&gt;controller-&gt;address(device, page &amp; 0xff);
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+			nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 			/* 3rd cycle only on devices with more than 32 MiB */
-			if (device-&gt;address_cycles &gt;= 4)
-				device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+			if (nand-&gt;address_cycles &gt;= 4)
+				nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 
 			/* 4th cycle only on devices with more than 8 GiB */
-			if (device-&gt;address_cycles &gt;= 5)
-				device-&gt;controller-&gt;address(device, (page &gt;&gt; 24) &amp; 0xff);
+			if (nand-&gt;address_cycles &gt;= 5)
+				nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 24) &amp; 0xff);
 		}
 		else
 		{
 			/* row */
-			device-&gt;controller-&gt;address(device, page &amp; 0xff);
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+			nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 			/* 3rd cycle only on devices with more than 128 MiB */
-			if (device-&gt;address_cycles &gt;= 5)
-				device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+			if (nand-&gt;address_cycles &gt;= 5)
+				nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 		}
 
 		/* Send erase confirm command */
-		device-&gt;controller-&gt;command(device, NAND_CMD_ERASE2);
+		nand-&gt;controller-&gt;command(nand, NAND_CMD_ERASE2);
 
-		retval = device-&gt;controller-&gt;nand_ready ?
-				device-&gt;controller-&gt;nand_ready(device, 1000) :
-				nand_poll_ready(device, 1000);
+		retval = nand-&gt;controller-&gt;nand_ready ?
+				nand-&gt;controller-&gt;nand_ready(nand, 1000) :
+				nand_poll_ready(nand, 1000);
 		if (!retval) {
 			LOG_ERROR(&quot;timeout waiting for NAND flash block erase to complete&quot;);
 			return ERROR_NAND_OPERATION_TIMEOUT;
 		}
 
-		if ((retval = nand_read_status(device, &amp;status)) != ERROR_OK)
+		if ((retval = nand_read_status(nand, &amp;status)) != ERROR_OK)
 		{
 			LOG_ERROR(&quot;couldn't read status&quot;);
 			return ERROR_NAND_OPERATION_FAILED;
@@ -690,43 +690,43 @@ static int nand_erase(struct nand_device_s *device, int first_block, int last_bl
 		if (status &amp; 0x1)
 		{
 			LOG_ERROR(&quot;didn't erase %sblock %d; status: 0x%2.2x&quot;,
-					(device-&gt;blocks[i].is_bad == 1)
+					(nand-&gt;blocks[i].is_bad == 1)
 						? &quot;bad &quot; : &quot;&quot;,
 					i, status);
 			/* continue; other blocks might still be erasable */
 		}
 
-		device-&gt;blocks[i].is_erased = 1;
+		nand-&gt;blocks[i].is_erased = 1;
 	}
 
 	return ERROR_OK;
 }
 
 #if 0
-static int nand_read_plain(struct nand_device_s *device, uint32_t address, uint8_t *data, uint32_t data_size)
+static int nand_read_plain(struct nand_device_s *nand, uint32_t address, uint8_t *data, uint32_t data_size)
 {
 	uint8_t *page;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	if (address % device-&gt;page_size)
+	if (address % nand-&gt;page_size)
 	{
 		LOG_ERROR(&quot;reads need to be page aligned&quot;);
 		return ERROR_NAND_OPERATION_FAILED;
 	}
 
-	page = malloc(device-&gt;page_size);
+	page = malloc(nand-&gt;page_size);
 
 	while (data_size &gt; 0)
 	{
-		uint32_t thisrun_size = (data_size &gt; device-&gt;page_size) ? device-&gt;page_size : data_size;
+		uint32_t thisrun_size = (data_size &gt; nand-&gt;page_size) ? nand-&gt;page_size : data_size;
 		uint32_t page_address;
 
 
-		page_address = address / device-&gt;page_size;
+		page_address = address / nand-&gt;page_size;
 
-		nand_read_page(device, page_address, page, device-&gt;page_size, NULL, 0);
+		nand_read_page(nand, page_address, page, nand-&gt;page_size, NULL, 0);
 
 		memcpy(data, page, thisrun_size);
 
@@ -740,32 +740,32 @@ static int nand_read_plain(struct nand_device_s *device, uint32_t address, uint8
 	return ERROR_OK;
 }
 
-static int nand_write_plain(struct nand_device_s *device, uint32_t address, uint8_t *data, uint32_t data_size)
+static int nand_write_plain(struct nand_device_s *nand, uint32_t address, uint8_t *data, uint32_t data_size)
 {
 	uint8_t *page;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	if (address % device-&gt;page_size)
+	if (address % nand-&gt;page_size)
 	{
 		LOG_ERROR(&quot;writes need to be page aligned&quot;);
 		return ERROR_NAND_OPERATION_FAILED;
 	}
 
-	page = malloc(device-&gt;page_size);
+	page = malloc(nand-&gt;page_size);
 
 	while (data_size &gt; 0)
 	{
-		uint32_t thisrun_size = (data_size &gt; device-&gt;page_size) ? device-&gt;page_size : data_size;
+		uint32_t thisrun_size = (data_size &gt; nand-&gt;page_size) ? nand-&gt;page_size : data_size;
 		uint32_t page_address;
 
-		memset(page, 0xff, device-&gt;page_size);
+		memset(page, 0xff, nand-&gt;page_size);
 		memcpy(page, data, thisrun_size);
 
-		page_address = address / device-&gt;page_size;
+		page_address = address / nand-&gt;page_size;
 
-		nand_write_page(device, page_address, page, device-&gt;page_size, NULL, 0);
+		nand_write_page(nand, page_address, page, nand-&gt;page_size, NULL, 0);
 
 		address += thisrun_size;
 		data += thisrun_size;
@@ -778,92 +778,92 @@ static int nand_write_plain(struct nand_device_s *device, uint32_t address, uint
 }
 #endif
 
-int nand_write_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+int nand_write_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
 	uint32_t block;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	block = page / (device-&gt;erase_size / device-&gt;page_size);
-	if (device-&gt;blocks[block].is_erased == 1)
-		device-&gt;blocks[block].is_erased = 0;
+	block = page / (nand-&gt;erase_size / nand-&gt;page_size);
+	if (nand-&gt;blocks[block].is_erased == 1)
+		nand-&gt;blocks[block].is_erased = 0;
 
-	if (device-&gt;use_raw || device-&gt;controller-&gt;write_page == NULL)
-		return nand_write_page_raw(device, page, data, data_size, oob, oob_size);
+	if (nand-&gt;use_raw || nand-&gt;controller-&gt;write_page == NULL)
+		return nand_write_page_raw(nand, page, data, data_size, oob, oob_size);
 	else
-		return device-&gt;controller-&gt;write_page(device, page, data, data_size, oob, oob_size);
+		return nand-&gt;controller-&gt;write_page(nand, page, data, data_size, oob, oob_size);
 }
 
-static int nand_read_page(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+static int nand_read_page(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	if (device-&gt;use_raw || device-&gt;controller-&gt;read_page == NULL)
-		return nand_read_page_raw(device, page, data, data_size, oob, oob_size);
+	if (nand-&gt;use_raw || nand-&gt;controller-&gt;read_page == NULL)
+		return nand_read_page_raw(nand, page, data, data_size, oob, oob_size);
 	else
-		return device-&gt;controller-&gt;read_page(device, page, data, data_size, oob, oob_size);
+		return nand-&gt;controller-&gt;read_page(nand, page, data, data_size, oob, oob_size);
 }
 
-int nand_read_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+int nand_read_page_raw(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
 	uint32_t i;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	if (device-&gt;page_size &lt;= 512)
+	if (nand-&gt;page_size &lt;= 512)
 	{
 		/* small page device */
 		if (data)
-			device-&gt;controller-&gt;command(device, NAND_CMD_READ0);
+			nand-&gt;controller-&gt;command(nand, NAND_CMD_READ0);
 		else
-			device-&gt;controller-&gt;command(device, NAND_CMD_READOOB);
+			nand-&gt;controller-&gt;command(nand, NAND_CMD_READOOB);
 
 		/* column (always 0, we start at the beginning of a page/OOB area) */
-		device-&gt;controller-&gt;address(device, 0x0);
+		nand-&gt;controller-&gt;address(nand, 0x0);
 
 		/* row */
-		device-&gt;controller-&gt;address(device, page &amp; 0xff);
-		device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 		/* 4th cycle only on devices with more than 32 MiB */
-		if (device-&gt;address_cycles &gt;= 4)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 4)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 
 		/* 5th cycle only on devices with more than 8 GiB */
-		if (device-&gt;address_cycles &gt;= 5)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 24) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 24) &amp; 0xff);
 	}
 	else
 	{
 		/* large page device */
-		device-&gt;controller-&gt;command(device, NAND_CMD_READ0);
+		nand-&gt;controller-&gt;command(nand, NAND_CMD_READ0);
 
 		/* column (0 when we start at the beginning of a page,
 		 * or 2048 for the beginning of OOB area)
 		 */
-		device-&gt;controller-&gt;address(device, 0x0);
+		nand-&gt;controller-&gt;address(nand, 0x0);
 		if (data)
-			device-&gt;controller-&gt;address(device, 0x0);
+			nand-&gt;controller-&gt;address(nand, 0x0);
 		else
-			device-&gt;controller-&gt;address(device, 0x8);
+			nand-&gt;controller-&gt;address(nand, 0x8);
 
 		/* row */
-		device-&gt;controller-&gt;address(device, page &amp; 0xff);
-		device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 		/* 5th cycle only on devices with more than 128 MiB */
-		if (device-&gt;address_cycles &gt;= 5)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 
 		/* large page devices need a start command */
-		device-&gt;controller-&gt;command(device, NAND_CMD_READSTART);
+		nand-&gt;controller-&gt;command(nand, NAND_CMD_READSTART);
 	}
 
-	if (device-&gt;controller-&gt;nand_ready) {
-		if (!device-&gt;controller-&gt;nand_ready(device, 100))
+	if (nand-&gt;controller-&gt;nand_ready) {
+		if (!nand-&gt;controller-&gt;nand_ready(nand, 100))
 			return ERROR_NAND_OPERATION_TIMEOUT;
 	} else {
 		alive_sleep(1);
@@ -871,21 +871,21 @@ int nand_read_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *dat
 
 	if (data)
 	{
-		if (device-&gt;controller-&gt;read_block_data != NULL)
-			(device-&gt;controller-&gt;read_block_data)(device, data, data_size);
+		if (nand-&gt;controller-&gt;read_block_data != NULL)
+			(nand-&gt;controller-&gt;read_block_data)(nand, data, data_size);
 		else
 		{
 			for (i = 0; i &lt; data_size;)
 			{
-				if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+				if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
 				{
-					device-&gt;controller-&gt;read_data(device, data);
+					nand-&gt;controller-&gt;read_data(nand, data);
 					data += 2;
 					i += 2;
 				}
 				else
 				{
-					device-&gt;controller-&gt;read_data(device, data);
+					nand-&gt;controller-&gt;read_data(nand, data);
 					data += 1;
 					i += 1;
 				}
@@ -895,21 +895,21 @@ int nand_read_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *dat
 
 	if (oob)
 	{
-		if (device-&gt;controller-&gt;read_block_data != NULL)
-			(device-&gt;controller-&gt;read_block_data)(device, oob, oob_size);
+		if (nand-&gt;controller-&gt;read_block_data != NULL)
+			(nand-&gt;controller-&gt;read_block_data)(nand, oob, oob_size);
 		else
 		{
 			for (i = 0; i &lt; oob_size;)
 			{
-				if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+				if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
 				{
-					device-&gt;controller-&gt;read_data(device, oob);
+					nand-&gt;controller-&gt;read_data(nand, oob);
 					oob += 2;
 					i += 2;
 				}
 				else
 				{
-					device-&gt;controller-&gt;read_data(device, oob);
+					nand-&gt;controller-&gt;read_data(nand, oob);
 					oob += 1;
 					i += 1;
 				}
@@ -920,72 +920,72 @@ int nand_read_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *dat
 	return ERROR_OK;
 }
 
-int nand_write_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
+int nand_write_page_raw(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size)
 {
 	uint32_t i;
 	int retval;
 	uint8_t status;
 
-	if (!device-&gt;device)
+	if (!nand-&gt;device)
 		return ERROR_NAND_DEVICE_NOT_PROBED;
 
-	device-&gt;controller-&gt;command(device, NAND_CMD_SEQIN);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_SEQIN);
 
-	if (device-&gt;page_size &lt;= 512)
+	if (nand-&gt;page_size &lt;= 512)
 	{
 		/* column (always 0, we start at the beginning of a page/OOB area) */
-		device-&gt;controller-&gt;address(device, 0x0);
+		nand-&gt;controller-&gt;address(nand, 0x0);
 
 		/* row */
-		device-&gt;controller-&gt;address(device, page &amp; 0xff);
-		device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 		/* 4th cycle only on devices with more than 32 MiB */
-		if (device-&gt;address_cycles &gt;= 4)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 4)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 
 		/* 5th cycle only on devices with more than 8 GiB */
-		if (device-&gt;address_cycles &gt;= 5)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 24) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 24) &amp; 0xff);
 	}
 	else
 	{
 		/* column (0 when we start at the beginning of a page,
 		 * or 2048 for the beginning of OOB area)
 		 */
-		device-&gt;controller-&gt;address(device, 0x0);
+		nand-&gt;controller-&gt;address(nand, 0x0);
 		if (data)
-			device-&gt;controller-&gt;address(device, 0x0);
+			nand-&gt;controller-&gt;address(nand, 0x0);
 		else
-			device-&gt;controller-&gt;address(device, 0x8);
+			nand-&gt;controller-&gt;address(nand, 0x8);
 
 		/* row */
-		device-&gt;controller-&gt;address(device, page &amp; 0xff);
-		device-&gt;controller-&gt;address(device, (page &gt;&gt; 8) &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, page &amp; 0xff);
+		nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 8) &amp; 0xff);
 
 		/* 5th cycle only on devices with more than 128 MiB */
-		if (device-&gt;address_cycles &gt;= 5)
-			device-&gt;controller-&gt;address(device, (page &gt;&gt; 16) &amp; 0xff);
+		if (nand-&gt;address_cycles &gt;= 5)
+			nand-&gt;controller-&gt;address(nand, (page &gt;&gt; 16) &amp; 0xff);
 	}
 
 	if (data)
 	{
-		if (device-&gt;controller-&gt;write_block_data != NULL)
-			(device-&gt;controller-&gt;write_block_data)(device, data, data_size);
+		if (nand-&gt;controller-&gt;write_block_data != NULL)
+			(nand-&gt;controller-&gt;write_block_data)(nand, data, data_size);
 		else
 		{
 			for (i = 0; i &lt; data_size;)
 			{
-				if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+				if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
 				{
 					uint16_t data_buf = le_to_h_u16(data);
-					device-&gt;controller-&gt;write_data(device, data_buf);
+					nand-&gt;controller-&gt;write_data(nand, data_buf);
 					data += 2;
 					i += 2;
 				}
 				else
 				{
-					device-&gt;controller-&gt;write_data(device, *data);
+					nand-&gt;controller-&gt;write_data(nand, *data);
 					data += 1;
 					i += 1;
 				}
@@ -995,22 +995,22 @@ int nand_write_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *da
 
 	if (oob)
 	{
-		if (device-&gt;controller-&gt;write_block_data != NULL)
-			(device-&gt;controller-&gt;write_block_data)(device, oob, oob_size);
+		if (nand-&gt;controller-&gt;write_block_data != NULL)
+			(nand-&gt;controller-&gt;write_block_data)(nand, oob, oob_size);
 		else
 		{
 			for (i = 0; i &lt; oob_size;)
 			{
-				if (device-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
+				if (nand-&gt;device-&gt;options &amp; NAND_BUSWIDTH_16)
 				{
 					uint16_t oob_buf = le_to_h_u16(data);
-					device-&gt;controller-&gt;write_data(device, oob_buf);
+					nand-&gt;controller-&gt;write_data(nand, oob_buf);
 					oob += 2;
 					i += 2;
 				}
 				else
 				{
-					device-&gt;controller-&gt;write_data(device, *oob);
+					nand-&gt;controller-&gt;write_data(nand, *oob);
 					oob += 1;
 					i += 1;
 				}
@@ -1018,15 +1018,15 @@ int nand_write_page_raw(struct nand_device_s *device, uint32_t page, uint8_t *da
 		}
 	}
 
-	device-&gt;controller-&gt;command(device, NAND_CMD_PAGEPROG);
+	nand-&gt;controller-&gt;command(nand, NAND_CMD_PAGEPROG);
 
-	retval = device-&gt;controller-&gt;nand_ready ?
-			device-&gt;controller-&gt;nand_ready(device, 100) :
-			nand_poll_ready(device, 100);
+	retval = nand-&gt;controller-&gt;nand_ready ?
+			nand-&gt;controller-&gt;nand_ready(nand, 100) :
+			nand_poll_ready(nand, 100);
 	if (!retval)
 		return ERROR_NAND_OPERATION_TIMEOUT;
 
-	if ((retval = nand_read_status(device, &amp;status)) != ERROR_OK)
+	if ((retval = nand_read_status(nand, &amp;status)) != ERROR_OK)
 	{
 		LOG_ERROR(&quot;couldn't read status&quot;);
 		return ERROR_NAND_OPERATION_FAILED;
diff --git a/src/flash/nand.h b/src/flash/nand.h
index 5b19d5a..d96e288 100644
--- a/src/flash/nand.h
+++ b/src/flash/nand.h
@@ -32,20 +32,20 @@ struct nand_device_s;
 typedef struct nand_flash_controller_s
 {
 	char *name;
-	int (*nand_device_command)(struct command_context_s *cmd_ctx, char *cmd, char **args, int argc, struct nand_device_s *device);
+	int (*nand_device_command)(struct command_context_s *cmd_ctx, char *cmd, char **args, int argc, struct nand_device_s *nand);
 	int (*register_commands)(struct command_context_s *cmd_ctx);
-	int (*init)(struct nand_device_s *device);
-	int (*reset)(struct nand_device_s *device);
-	int (*command)(struct nand_device_s *device, uint8_t command);
-	int (*address)(struct nand_device_s *device, uint8_t address);
-	int (*write_data)(struct nand_device_s *device, uint16_t data);
-	int (*read_data)(struct nand_device_s *device, void *data);
-	int (*write_block_data)(struct nand_device_s *device, uint8_t *data, int size);
-	int (*read_block_data)(struct nand_device_s *device, uint8_t *data, int size);
-	int (*write_page)(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
-	int (*read_page)(struct nand_device_s *device, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
-	int (*controller_ready)(struct nand_device_s *device, int timeout);
-	int (*nand_ready)(struct nand_device_s *device, int timeout);
+	int (*init)(struct nand_device_s *nand);
+	int (*reset)(struct nand_device_s *nand);
+	int (*command)(struct nand_device_s *nand, uint8_t command);
+	int (*address)(struct nand_device_s *nand, uint8_t address);
+	int (*write_data)(struct nand_device_s *nand, uint16_t data);
+	int (*read_data)(struct nand_device_s *nand, void *data);
+	int (*write_block_data)(struct nand_device_s *nand, uint8_t *data, int size);
+	int (*read_block_data)(struct nand_device_s *nand, uint8_t *data, int size);
+	int (*write_page)(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
+	int (*read_page)(struct nand_device_s *nand, uint32_t page, uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
+	int (*controller_ready)(struct nand_device_s *nand, int timeout);
+	int (*nand_ready)(struct nand_device_s *nand, int timeout);
 } nand_flash_controller_t;
 
 typedef struct nand_block_s
@@ -209,16 +209,16 @@ enum oob_formats
 
 nand_device_t *get_nand_device_by_num(int num);
 
-int nand_read_page_raw(struct nand_device_s *device, uint32_t page,
+int nand_read_page_raw(struct nand_device_s *nand, uint32_t page,
 		uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
-int nand_write_page_raw(struct nand_device_s *device, uint32_t page,
+int nand_write_page_raw(struct nand_device_s *nand, uint32_t page,
 		uint8_t *data, uint32_t data_size, uint8_t *oob, uint32_t oob_size);
 
-int nand_read_status(struct nand_device_s *device, uint8_t *status);
+int nand_read_status(struct nand_device_s *nand, uint8_t *status);
 
-int nand_calculate_ecc(struct nand_device_s *device,
+int nand_calculate_ecc(struct nand_device_s *nand,
 		const uint8_t *dat, uint8_t *ecc_code);
-int nand_calculate_ecc_kw(struct nand_device_s *device,
+int nand_calculate_ecc_kw(struct nand_device_s *nand,
 		const uint8_t *dat, uint8_t *ecc_code);
 
 int nand_register_commands(struct command_context_s *cmd_ctx);
@@ -226,7 +226,7 @@ int nand_init(struct command_context_s *cmd_ctx);
 
 /// helper for parsing a nand device command argument string
 int nand_command_get_device_by_num(struct command_context_s *cmd_ctx,
-		const char *str, nand_device_t **device);
+		const char *str, nand_device_t **nand);
 
 
 #define		ERROR_NAND_DEVICE_INVALID		(-1100)
diff --git a/src/flash/nand_ecc.c b/src/flash/nand_ecc.c
index c154d69..81d2beb 100644
--- a/src/flash/nand_ecc.c
+++ b/src/flash/nand_ecc.c
@@ -68,7 +68,7 @@ static const uint8_t nand_ecc_precalc_table[] = {
 /*
  * nand_calculate_ecc - Calculate 3-byte ECC for 256-byte block
  */
-int nand_calculate_ecc(struct nand_device_s *device, const uint8_t *dat, uint8_t *ecc_code)
+int nand_calculate_ecc(struct nand_device_s *nand, const uint8_t *dat, uint8_t *ecc_code)
 {
 	uint8_t idx, reg1, reg2, reg3, tmp1, tmp2;
 	int i;
diff --git a/src/flash/nand_ecc_kw.c b/src/flash/nand_ecc_kw.c
index b2ab6b2..2f6fc4a 100644
--- a/src/flash/nand_ecc_kw.c
+++ b/src/flash/nand_ecc_kw.c
@@ -100,7 +100,7 @@ static void gf_build_log_exp_table(void)
  * expects the ECC to be computed backward, i.e. from the last byte down
  * to the first one.
  */
-int nand_calculate_ecc_kw(struct nand_device_s *device, const uint8_t *data, uint8_t *ecc)
+int nand_calculate_ecc_kw(struct nand_device_s *nand, const uint8_t *data, uint8_t *ecc)
 {
 	unsigned int r7, r6, r5, r4, r3, r2, r1, r0;
 	int i;
diff --git a/src/flash/orion_nand.c b/src/flash/orion_nand.c
index 6e88f82..471c562 100644
--- a/src/flash/orion_nand.c
+++ b/src/flash/orion_nand.c
@@ -49,9 +49,9 @@ typedef struct orion_nand_controller_s
 		} \
 	} while (0)
 
-static int orion_nand_command(struct nand_device_s *device, uint8_t command)
+static int orion_nand_command(struct nand_device_s *nand, uint8_t command)
 {
-	orion_nand_controller_t *hw = device-&gt;controller_priv;
+	orion_nand_controller_t *hw = nand-&gt;controller_priv;
 	target_t *target = hw-&gt;target;
 
 	CHECK_HALTED;
@@ -59,9 +59,9 @@ static int orion_nand_command(struct nand_device_s *device, uint8_t command)
 	return ERROR_OK;
 }
 
-static int orion_nand_address(struct nand_device_s *device, uint8_t address)
+static int orion_nand_address(struct nand_device_s *nand, uint8_t address)
 {
-	orion_nand_controller_t *hw = device-&gt;controller_priv;
+	orion_nand_controller_t *hw = nand-&gt;controller_priv;
 	target_t *target = hw-&gt;target;
 
 	CHECK_HALTED;
@@ -69,9 +69,9 @@ static int orion_nand_address(struct nand_device_s *device, uint8_t address)
 	return ERROR_OK;
 }
 
-static int orion_nand_read(struct nand_device_s *device, void *data)
+static int orion_nand_read(struct nand_device_s *nand, void *data)
 {
-	orion_nand_controller_t *hw = device-&gt;controller_priv;
+	orion_nand_controller_t *hw = nand-&gt;controller_priv;
 	target_t *target = hw-&gt;target;
 
 	CHECK_HALTED;
@@ -79,9 +79,9 @@ static int orion_nand_read(struct nand_device_s *device, void *data)
 	return ERROR_OK;
 }
 
-static int orion_nand_write(struct nand_device_s *device, uint16_t data)
+static int orion_nand_write(struct nand_device_s *nand, uint16_t data)
 {
-	orion_nand_controller_t *hw = device-&gt;controller_priv;
+	orion_nand_controller_t *hw = nand-&gt;controller_priv;
 	target_t *target = hw-&gt;target;
 
 	CHECK_HALTED;
@@ -89,33 +89,33 @@ static int orion_nand_write(struct nand_device_s *device, uint16_t data)
 	return ERROR_OK;
 }
 
-static int orion_nand_slow_block_write(struct nand_device_s *device, uint8_t *data, int size)
+static int orion_nand_slow_block_write(struct nand_device_s *nand, uint8_t *data, int size)
 {
 	while (size--)
-		orion_nand_write(device, *data++);
+		orion_nand_write(nand, *data++);
 	return ERROR_OK;
 }
 
-static int orion_nand_fast_block_write(struct nand_device_s *device, uint8_t *data, int size)
+static int orion_nand_fast_block_write(struct nand_device_s *nand, uint8_t *data, int size)
 {
-	orion_nand_controller_t *hw = device-&gt;controller_priv;
+	orion_nand_controller_t *hw = nand-&gt;controller_priv;
 	int retval;
 
-	hw-&gt;io.chunk_size = device-&gt;page_size;
+	hw-&gt;io.chunk_size = nand-&gt;page_size;
 
 	retval = arm_nandwrite(&amp;hw-&gt;io, data, size);
 	if (retval == ERROR_NAND_NO_BUFFER)
-		retval = orion_nand_slow_block_write(device, data, size);
+		retval = orion_nand_slow_block_write(nand, data, size);
 
 	return retval;
 }
 
-static int orion_nand_reset(struct nand_device_s *device)
+static int orion_nand_reset(struct nand_device_s *nand)
 {
-	return orion_nand_command(device, NAND_CMD_RESET);
+	return orion_nand_command(nand, NAND_CMD_RESET);
 }
 
-static int orion_nand_controller_ready(struct nand_device_s *device, int timeout)
+static int orion_nand_controller_ready(struct nand_device_s *nand, int timeout)
 {
 	return 1;
 }
@@ -127,7 +127,7 @@ static int orion_nand_register_commands(struct command_context_s *cmd_ctx)
 
 int orion_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 			      char **args, int argc,
-			      struct nand_device_s *device)
+			      struct nand_device_s *nand)
 {
 	ori
on_nand_controller_t *hw;
 	uint32_t base;
@@ -144,7 +144,7 @@ int orion_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 		return ERROR_NAND_DEVICE_INVALID;
 	}
 
-	device-&gt;controller_priv = hw;
+	nand-&gt;controller_priv = hw;
 	hw-&gt;target = get_target(args[1]);
 	if (!hw-&gt;target) {
 		LOG_ERROR(&quot;target '%s' not defined&quot;, args[1]);
@@ -166,7 +166,7 @@ int orion_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 	return ERROR_OK;
 }
 
-static int orion_nand_init(struct nand_device_s *device)
+static int orion_nand_init(struct nand_device_s *nand)
 {
 	return ERROR_OK;
 }
diff --git a/src/flash/s3c2410_nand.c b/src/flash/s3c2410_nand.c
index 4ec4f23..e663507 100644
--- a/src/flash/s3c2410_nand.c
+++ b/src/flash/s3c2410_nand.c
@@ -32,11 +32,11 @@
 
 static int s3c2410_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 				char **args, int argc,
-				struct nand_device_s *device)
+				struct nand_device_s *nand)
 {
 	s3c24xx_nand_controller_t *info;
 
-	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, device);
+	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, nand);
 	if (info == NULL) {
 		return ERROR_NAND_DEVICE_INVALID;
 	}
@@ -50,9 +50,9 @@ static int s3c2410_nand_device_command(struct command_context_s *cmd_ctx, char *
 	return ERROR_OK;
 }
 
-static int s3c2410_init(struct nand_device_s *device)
+static int s3c2410_init(struct nand_device_s *nand)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	target_write_u32(target, S3C2410_NFCONF,
@@ -62,9 +62,9 @@ static int s3c2410_init(struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-static int s3c2410_write_data(struct nand_device_s *device, uint16_t data)
+static int s3c2410_write_data(struct nand_device_s *nand, uint16_t data)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -76,9 +76,9 @@ static int s3c2410_write_data(struct nand_device_s *device, uint16_t data)
 	return ERROR_OK;
 }
 
-static int s3c2410_read_data(struct nand_device_s *device, void *data)
+static int s3c2410_read_data(struct nand_device_s *nand, void *data)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -90,9 +90,9 @@ static int s3c2410_read_data(struct nand_device_s *device, void *data)
 	return ERROR_OK;
 }
 
-static int s3c2410_nand_ready(struct nand_device_s *device, int timeout)
+static int s3c2410_nand_ready(struct nand_device_s *nand, int timeout)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 	uint8_t status;
 
diff --git a/src/flash/s3c2412_nand.c b/src/flash/s3c2412_nand.c
index a995acc..5c9d319 100644
--- a/src/flash/s3c2412_nand.c
+++ b/src/flash/s3c2412_nand.c
@@ -32,11 +32,11 @@
 
 static int s3c2412_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 				char **args, int argc,
-				struct nand_device_s *device)
+				struct nand_device_s *nand)
 {
 	s3c24xx_nand_controller_t *info;
 
-	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, device);
+	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, nand);
 	if (info == NULL) {
 		return ERROR_NAND_DEVICE_INVALID;
 	}
@@ -50,9 +50,9 @@ static int s3c2412_nand_device_command(struct command_context_s *cmd_ctx, char *
 	return ERROR_OK;
 }
 
-static int s3c2412_init(struct nand_device_s *device)
+static int s3c2412_init(struct nand_device_s *nand)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	target_write_u32(target, S3C2410_NFCONF,
diff --git a/src/flash/s3c2440_nand.c b/src/flash/s3c2440_nand.c
index 2321382..fd1fbd0 100644
--- a/src/flash/s3c2440_nand.c
+++ b/src/flash/s3c2440_nand.c
@@ -33,11 +33,11 @@
 
 static int s3c2440_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 				char **args, int argc,
-				struct nand_device_s *device)
+				struct nand_device_s *nand)
 {
 	s3c24xx_nand_controller_t *info;
 
-	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, device);
+	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, nand);
 	if (info == NULL) {
 		return ERROR_NAND_DEVICE_INVALID;
 	}
@@ -51,9 +51,9 @@ static int s3c2440_nand_device_command(struct command_context_s *cmd_ctx, char *
 	return ERROR_OK;
 }
 
-static int s3c2440_init(struct nand_device_s *device)
+static int s3c2440_init(struct nand_device_s *nand)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	target_write_u32(target, S3C2410_NFCONF,
@@ -67,9 +67,9 @@ static int s3c2440_init(struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-int s3c2440_nand_ready(struct nand_device_s *device, int timeout)
+int s3c2440_nand_ready(struct nand_device_s *nand, int timeout)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 	uint8_t status;
 
@@ -93,14 +93,14 @@ int s3c2440_nand_ready(struct nand_device_s *device, int timeout)
 
 /* use the fact we can read/write 4 bytes in one go via a single 32bit op */
 
-int s3c2440_read_block_data(struct nand_device_s *device, uint8_t *data, int data_size)
+int s3c2440_read_block_data(struct nand_device_s *nand, uint8_t *data, int data_size)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 	uint32_t nfdata = s3c24xx_info-&gt;data;
 	uint32_t tmp;
 
-	LOG_INFO(&quot;%s: reading data: %p, %p, %d\n&quot;, __func__, device, data, data_size);
+	LOG_INFO(&quot;%s: reading data: %p, %p, %d\n&quot;, __func__, nand, data, data_size);
 
 	if (target-&gt;state != TARGET_HALTED) {
 		LOG_ERROR(&quot;target must be halted to use S3C24XX NAND flash controller&quot;);
@@ -129,9 +129,9 @@ int s3c2440_read_block_data(struct nand_device_s *device, uint8_t *data, int dat
 	return ERROR_OK;
 }
 
-int s3c2440_write_block_data(struct nand_device_s *device, uint8_t *data, int data_size)
+int s3c2440_write_block_data(struct nand_device_s *nand, uint8_t *data, int data_size)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 	uint32_t nfdata = s3c24xx_info-&gt;data;
 	uint32_t tmp;
diff --git a/src/flash/s3c2443_nand.c b/src/flash/s3c2443_nand.c
index c6effdf..82d9b8e 100644
--- a/src/flash/s3c2443_nand.c
+++ b/src/flash/s3c2443_nand.c
@@ -33,11 +33,11 @@
 
 static int s3c2443_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 				char **args, int argc,
-				struct nand_device_s *device)
+				struct nand_device_s *nand)
 {
 	s3c24xx_nand_controller_t *info;
 
-	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, device);
+	info = s3c24xx_nand_device_command(cmd_ctx, cmd, args, argc, nand);
 	if (info == NULL) {
 		return ERROR_NAND_DEVICE_INVALID;
 	}
@@ -51,9 +51,9 @@ static int s3c2443_nand_device_command(struct command_context_s *cmd_ctx, char *
 	return ERROR_OK;
 }
 
-static int s3c2443_init(struct nand_device_s *device)
+static int s3c2443_init(struct nand_device_s *nand)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	target_write_u32(target, S3C2410_NFCONF,
diff --git a/src/flash/s3c24xx_nand.c b/src/flash/s3c24xx_nand.c
index 478d268..59d4d5b 100644
--- a/src/flash/s3c24xx_nand.c
+++ b/src/flash/s3c24xx_nand.c
@@ -34,7 +34,7 @@
 s3c24xx_nand_controller_t *
 s3c24xx_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 			    char **args, int argc,
-			    struct nand_device_s *device)
+			    struct nand_device_s *nand)
 {
 	s3c24xx_nand_controller_t *s3c24xx_info;
 
@@ -44,7 +44,7 @@ s3c24xx_nand_device_command(struct command_context_s *cmd_ctx, char *cmd,
 		return NULL;
 	}
 
-	device-&gt;controller_priv = s3c24xx_info;
+	nand-&gt;controller_priv = s3c24xx_info;
 
 	s3c24xx_info-&gt;target = get_target(args[1]);
 	if (s3c24xx_info-&gt;target == NULL) {
@@ -60,9 +60,9 @@ int s3c24xx_register_commands(struct command_context_s *cmd_ctx)
 	return ERROR_OK;
 }
 
-int s3c24xx_reset(struct nand_device_s *device)
+int s3c24xx_reset(struct nand_device_s *nand)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -75,9 +75,9 @@ int s3c24xx_reset(struct nand_device_s *device)
 	return ERROR_OK;
 }
 
-int s3c24xx_command(struct nand_device_s *device, uint8_t command)
+int s3c24xx_command(struct nand_device_s *nand, uint8_t command)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -90,9 +90,9 @@ int s3c24xx_command(struct nand_device_s *device, uint8_t command)
 }
 
 
-int s3c24xx_address(struct nand_device_s *device, uint8_t address)
+int s3c24xx_address(struct nand_device_s *nand, uint8_t address)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -104,9 +104,9 @@ int s3c24xx_address(struct nand_device_s *device, uint8_t address)
 	return ERROR_OK;
 }
 
-int s3c24xx_write_data(struct nand_device_s *device, uint16_t data)
+int s3c24xx_write_data(struct nand_device_s *nand, uint16_t data)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -118,9 +118,9 @@ int s3c24xx_write_data(struct nand_device_s *device, uint16_t data)
 	return ERROR_OK;
 }
 
-int s3c24xx_read_data(struct nand_device_s *device, void *data)
+int s3c24xx_read_data(struct nand_device_s *nand, void *data)
 {
-	s3c24xx_nand_controller_t *s3c24xx_info = device-&gt;controller_priv;
+	s3c24xx_nand_controller_t *s3c24xx_info = nand-&gt;controller_priv;
 	target_t *target = s3c24xx_info-&gt;target;
 
 	if (target-&gt;state != TARGET_HALTED) {
@@ -132,7 +132,7 @@ int s3c24xx_read_data(struct nand_device_s *device, void *data)
 	return ERROR_OK;
 }
 
-int s3c24xx_controller_ready(struct nand_device_s *device, int timeout)
+int s3c24xx_controller_ready(struct nand_device_s *nand, int timeout)
 {
 	return 1;
 }
diff --git a/src/flash/s3c24xx_nand.h b/src/flash/s3c24xx_nand.h
index 0213df3..ed14295 100644
--- a/src/flash/s3c24xx_nand.h
+++ b/src/flash/s3c24xx_nand.h
@@ -47,30 +47,30 @@ typedef struct s3c24xx_nand_controller_s
 
 s3c24xx_nand_controller_t *s3c24xx_nand_device_command(
 			struct command_context_s *cmd_ctx, char *cmd,
-			char **args, int argc, struct nand_device_s *device);
+			char **args, int argc, struct nand_device_s *nand);
 
 int s3c24xx_register_commands(struct command_context_s *cmd_ctx);
 
-int s3c24xx_reset(struct nand_device_s *device);
+int s3c24xx_reset(struct nand_device_s *nand);
 
-int s3c24xx_command(struct nand_device_s *device, uint8_t command);
-int s3c24xx_address(struct nand_device_s *device, uint8_t address);
+int s3c24xx_command(struct nand_device_s *nand, uint8_t command);
+int s3c24xx_address(struct nand_device_s *nand, uint8_t address);
 
-int s3c24xx_write_data(struct nand_device_s *device, uint16_t data);
-int s3c24xx_read_data(struct nand_device_s *device, void *data);
+int s3c24xx_write_data(struct nand_device_s *nand, uint16_t data);
+int s3c24xx_read_data(struct nand_device_s *nand, void *data);
 
-int s3c24xx_controller_ready(struct nand_device_s *device, int tout);
+int s3c24xx_controller_ready(struct nand_device_s *nand, int tout);
 
 #define s3c24xx_write_page NULL
 #define s3c24xx_read_page NULL
 
 /* code shared between different controllers */
 
-int s3c2440_nand_ready(struct nand_device_s *device, int timeout);
+int s3c2440_nand_ready(struct nand_device_s *nand, int timeout);
 
-int s3c2440_read_block_data(struct nand_device_s *device,
+int s3c2440_read_block_data(struct nand_device_s *nand,
 		uint8_t *data, int data_size);
-int s3c2440_write_block_data(struct nand_device_s *device,
+int s3c2440_write_block_data(struct nand_device_s *nand,
 		uint8_t *data, int data_size);
 
 #endif // S3C24xx_NAND_H

-----------------------------------------------------------------------

Summary of changes:
 src/flash/lpc3180_nand_controller.c |  108 +++++-----
 src/flash/mx3_nand.c                |  160 +++++++-------
 src/flash/nand.c                    |  426 +++++++++++++++++-----------------
 src/flash/nand.h                    |   38 ++--
 src/flash/nand_ecc.c                |    2 +-
 src/flash/nand_ecc_kw.c             |    2 +-
 src/flash/orion_nand.c              |   40 ++--
 src/flash/s3c2410_nand.c            |   20 +-
 src/flash/s3c2412_nand.c            |    8 +-
 src/flash/s3c2440_nand.c            |   22 +-
 src/flash/s3c2443_nand.c            |    8 +-
 src/flash/s3c24xx_nand.c            |   26 +-
 src/flash/s3c24xx_nand.h            |   20 +-
 13 files changed, 440 insertions(+), 440 deletions(-)


hooks/post-receive
-- 
Main OpenOCD repository

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001771.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-162-gd47764f
</A></li>
	<LI>Next message: <A HREF="001773.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-164-g5eb638c
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
