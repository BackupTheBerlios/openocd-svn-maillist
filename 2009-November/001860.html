<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-595-g8d46720
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenocd-svn%5D%20Main%20OpenOCD%20repository%20branch%2C%20master%2C%0A%09updated.%20v0.3.0-595-g8d46720&In-Reply-To=%3CE1NDN2r-0008H2-Sx%40sfp-scmshell-4.v30.ch3.sourceforge.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001859.html">
   <LINK REL="Next"  HREF="001861.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-595-g8d46720</H1>
    <B>Zach Welch</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5Bopenocd-svn%5D%20Main%20OpenOCD%20repository%20branch%2C%20master%2C%0A%09updated.%20v0.3.0-595-g8d46720&In-Reply-To=%3CE1NDN2r-0008H2-Sx%40sfp-scmshell-4.v30.ch3.sourceforge.com%3E"
       TITLE="[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-595-g8d46720">zwelch at users.sourceforge.net
       </A><BR>
    <I>Wed Nov 25 19:56:52 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001859.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-584-ge2f23c5
</A></li>
        <LI>Next message: <A HREF="001861.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-615-g90d09e3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1860">[ date ]</a>
              <a href="thread.html#1860">[ thread ]</a>
              <a href="subject.html#1860">[ subject ]</a>
              <a href="author.html#1860">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Main OpenOCD repository&quot;.

The branch, master has been updated
       via  8d46720cda288f498787a706bb2518e6f852b9f1 (commit)
       via  fc2d9f87615b7a5562cb9cd58fb95953e5d89818 (commit)
       via  355a67303206fb8954827ab7e413f1d882149c90 (commit)
       via  9a31d66b3ff4b877d1f1125d24cbf127234f153a (commit)
       via  339e08baa5d000b1efe8c85ddd516d0b967992b2 (commit)
       via  b1d034bf2f665cfa5633c8c6b46570d7ce6064a4 (commit)
       via  779bdbe797b9c25b9f297b4f29500e847baf28c3 (commit)
       via  3ab599a7e43af7350b380e7ffcc5fdcd75b42a65 (commit)
       via  30be874de8ee9d8269ce3441c92a15b96c68a398 (commit)
       via  0af32bb9381c9fe3f6be425c7fedfc88d4590178 (commit)
       via  48429dcfad4c05dc03fd94484da1078b30afd4f3 (commit)
      from  e2f23c54373097098ef0b59377299d7382f4c58a (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 8d46720cda288f498787a706bb2518e6f852b9f1
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 22:01:59 2009 -0800

    remove register_callbacks from jtag interface
    
    Changes the jtag_interface-&gt;register_callbacks field to a list of
    commands to be registered.  Changes callback to invocation of
    register_commands() with that command registration list.  Removes all
    JTAG interface driver register_command callback functions, which the
    previous commits had converted into identical calls.

diff --git a/src/jtag/amt_jtagaccel.c b/src/jtag/amt_jtagaccel.c
index c3f3279..d26482a 100644
--- a/src/jtag/amt_jtagaccel.c
+++ b/src/jtag/amt_jtagaccel.c
@@ -558,14 +558,9 @@ static const struct command_registration amtjtagaccel_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int amt_jtagaccel_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, amtjtagaccel_command_handlers);
-}
-
 struct jtag_interface amt_jtagaccel_interface = {
 		.name = &quot;amt_jtagaccel&quot;,
-		.register_commands = &amp;amt_jtagaccel_register_commands,
+		.commands = amtjtagaccel_command_handlers,
 		.init = &amp;amt_jtagaccel_init,
 		.quit = &amp;amt_jtagaccel_quit,
 		.speed = &amp;amt_jtagaccel_speed,
diff --git a/src/jtag/arm-jtag-ew.c b/src/jtag/arm-jtag-ew.c
index ef2b04f..46c3107 100644
--- a/src/jtag/arm-jtag-ew.c
+++ b/src/jtag/arm-jtag-ew.c
@@ -512,17 +512,15 @@ static const struct command_registration armjtagew_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int armjtagew_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, armjtagew_command_handlers);
-}
-
 struct jtag_interface armjtagew_interface = {
 		.name = &quot;arm-jtag-ew&quot;,
+
+		.commands = armjtagew_command_handlers,
+
 		.execute_queue = &amp;armjtagew_execute_queue,
 		.speed = &amp;armjtagew_speed,
 		.khz = &amp;armjtagew_khz,
-		.register_commands = &amp;armjtagew_register_commands,
+
 		.init = &amp;armjtagew_init,
 		.quit = &amp;armjtagew_quit,
 	};
diff --git a/src/jtag/dummy.c b/src/jtag/dummy.c
index 0516790..11b6f71 100644
--- a/src/jtag/dummy.c
+++ b/src/jtag/dummy.c
@@ -134,11 +134,6 @@ static int dummy_speed(int speed)
 	return ERROR_OK;
 }
 
-static int dummy_register_commands(struct command_context *cmd_ctx)
-{
-	return ERROR_OK;
-}
-
 static int dummy_init(void)
 {
 	bitbang_interface = &amp;dummy_bitbang;
@@ -160,7 +155,6 @@ struct jtag_interface dummy_interface = {
 		.execute_queue = &amp;bitbang_execute_queue,
 
 		.speed = &amp;dummy_speed,
-		.register_commands = &amp;dummy_register_commands,
 		.khz = &amp;dummy_khz,
 		.speed_div = &amp;dummy_speed_div,
 
diff --git a/src/jtag/ft2232.c b/src/jtag/ft2232.c
index d145505..73cbaf3 100644
--- a/src/jtag/ft2232.c
+++ b/src/jtag/ft2232.c
@@ -4009,15 +4009,9 @@ static const struct command_registration ft2232_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int ft2232_register_commands(struct command_context* cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, ft2232_command_handlers);
-}
-
-
 struct jtag_interface ft2232_interface = {
 		.name = &quot;ft2232&quot;,
-		.register_commands = &amp;ft2232_register_commands,
+		.commands = ft2232_command_handlers,
 		.init = &amp;ft2232_init,
 		.quit = &amp;ft2232_quit,
 		.speed = &amp;ft2232_speed,
diff --git a/src/jtag/gw16012.c b/src/jtag/gw16012.c
index 0e495f9..b827fd5 100644
--- a/src/jtag/gw16012.c
+++ b/src/jtag/gw16012.c
@@ -573,14 +573,9 @@ static const struct command_registration gw16012_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int gw16012_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, gw16012_command_handlers);
-}
-
 struct jtag_interface gw16012_interface = {
 		.name = &quot;gw16012&quot;,
-		.register_commands = &amp;gw16012_register_commands,
+		.commands = gw16012_command_handlers,
 		.init = &amp;gw16012_init,
 		.quit = &amp;gw16012_quit,
 		.speed = &amp;gw16012_speed,
diff --git a/src/jtag/interface.h b/src/jtag/interface.h
index 05e4048..d55782a 100644
--- a/src/jtag/interface.h
+++ b/src/jtag/interface.h
@@ -204,10 +204,8 @@ struct jtag_interface {
 	/**
 	 * The interface driver may register additional commands to expose
 	 * additional features not covered by the standard command set.
-	 * @param cmd_ctx The context in which commands should be registered.
-	 * @returns ERROR_OK on success, or an error code on failure.
 	 */
-	int (*register_commands)(struct command_context* cmd_ctx);
+	const struct command_registration *commands;
 
 	/**
 	 * Interface driver must initalize any resources and connect to a
diff --git a/src/jtag/jlink.c b/src/jtag/jlink.c
index 24fb0e8..9b2326b 100644
--- a/src/jtag/jlink.c
+++ b/src/jtag/jlink.c
@@ -644,18 +644,16 @@ static const struct command_registration jlink_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int jlink_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, jlink_command_handlers);
-}
-
 struct jtag_interface jlink_interface = {
 		.name = &quot;jlink&quot;,
+
+		.commands = jlink_command_handlers,
+
 		.execute_queue = &amp;jlink_execute_queue,
 		.speed = &amp;jlink_speed,
 		.speed_div = &amp;jlink_speed_div,
 		.khz = &amp;jlink_khz,
-		.register_commands = &amp;jlink_register_commands,
+
 		.init = &amp;jlink_init,
 		.quit = &amp;jlink_quit,
 	};
diff --git a/src/jtag/parport.c b/src/jtag/parport.c
index abf0d29..e5f5611 100644
--- a/src/jtag/parport.c
+++ b/src/jtag/parport.c
@@ -517,19 +517,17 @@ static const struct command_registration parport_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
+struct jtag_interface parport_interface = {
+		.name = &quot;parport&quot;,
 
-static int parport_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, parport_command_handlers);
-}
+		.commands = parport_command_handlers,
 
-struct jtag_interface parport_interface = {
-	.name =			&quot;parport&quot;,
-	.register_commands =	parport_register_commands,
-	.init =			parport_init,
-	.quit =			parport_quit,
-	.khz =			parport_khz,
-	.speed_div =		parport_speed_div,
-	.speed =		parport_speed,
-	.execute_queue =	bitbang_execute_queue,
-};
+		.init = &amp;parport_init,
+		.quit = &amp;parport_quit,
+
+		.khz = &amp;parport_khz,
+		.speed_div = &amp;parport_speed_div,
+		.speed = &amp;parport_speed,
+
+		.execute_queue = &amp;bitbang_execute_queue,
+	};
diff --git a/src/jtag/presto.c b/src/jtag/presto.c
index dc40750..f4e689c 100644
--- a/src/jtag/presto.c
+++ b/src/jtag/presto.c
@@ -750,11 +750,6 @@ static const struct command_registration presto_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int presto_jtag_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, presto_command_handlers);
-}
-
 static int presto_jtag_init(void)
 {
 	if (presto_open(presto_serial) != ERROR_OK)
@@ -792,11 +787,14 @@ static int presto_jtag_quit(void)
 
 struct jtag_interface presto_interface = {
 		.name = &quot;presto&quot;,
+
+		.commands = presto_command_handlers,
+
 		.execute_queue = &amp;bitq_execute_queue,
 		.speed = &amp;presto_jtag_speed,
 		.khz = &amp;presto_jtag_khz,
 		.speed_div = &amp;presto_jtag_speed_div,
-		.register_commands = &amp;presto_jtag_register_commands,
+
 		.init = &amp;presto_jtag_init,
 		.quit = &amp;presto_jtag_quit,
 	};
diff --git a/src/jtag/rlink/rlink.c b/src/jtag/rlink/rlink.c
index 6fb721d..bb33ad8 100644
--- a/src/jtag/rlink/rlink.c
+++ b/src/jtag/rlink/rlink.c
@@ -1568,49 +1568,6 @@ int rlink_khz(
 }
 
 
-#if 0
-static
-int
-handle_dtc_directory_command(
-	struct command_context *cmd_ctx,
-	char *cmd,
-	char **args,
-	int argc
-) {
-	if (argc != 1) {
-		LOG_ERROR(&quot;expected exactly one argument to rlink_dtc_directory &lt;directory-path&gt;&quot;);
-		return(ERROR_INVALID_ARGUMENTS);
-	}
-
-	printf(&quot;handle_dtc_directory_command called with \&quot;%s\&quot;\n&quot;, args[0]);
-
-	return(ERROR_OK);
-}
-#endif
-
-
-static
-int rlink_register_commands(struct command_context *cmd_ctx)
-{
-
-#ifdef _DEBUG_JTAG_IO_
-	LOG_DEBUG(&quot;rlink_register_commands called with cmd_ctx=%p\n&quot;, cmd_ctx);
-#endif
-
-#if 0
-	register_command(
-		cmd_ctx, NULL,
-		&quot;rlink_dtc_directory&quot;,
-		handle_dtc_directory_command,
-		COMMAND_CONFIG,
-		&quot;The directory in which to search for DTC load images&quot;
-);
-#endif
-
-	return ERROR_OK;
-}
-
-
 static
 int rlink_init(void)
 {
@@ -1848,7 +1805,6 @@ struct jtag_interface rlink_interface =
 	.name = &quot;rlink&quot;,
 	.init = rlink_init,
 	.quit = rlink_quit,
-	.register_commands = rlink_register_commands,
 	.speed = rlink_speed,
 	.speed_div = rlink_speed_div,
 	.khz = rlink_khz,
diff --git a/src/jtag/tcl.c b/src/jtag/tcl.c
index 81dbdb5..6b42021 100644
--- a/src/jtag/tcl.c
+++ b/src/jtag/tcl.c
@@ -636,9 +636,10 @@ COMMAND_HANDLER(handle_interface_command)
 		if (strcmp(CMD_ARGV[0], jtag_interfaces[i]-&gt;name) != 0)
 			continue;
 
-		if (NULL != jtag_interfaces[i]-&gt;register_commands)
+		if (NULL != jtag_interfaces[i]-&gt;commands)
 		{
-			int retval = jtag_interfaces[i]-&gt;register_commands(CMD_CTX);
+			int retval = register_commands(CMD_CTX, NULL,
+					jtag_interfaces[i]-&gt;commands);
 			if (ERROR_OK != retval)
 				return retval;
 		}
diff --git a/src/jtag/vsllink.c b/src/jtag/vsllink.c
index 8287e84..cc3308f 100644
--- a/src/jtag/vsllink.c
+++ b/src/jtag/vsllink.c
@@ -1890,14 +1890,10 @@ static const struct command_registration vsllink_command_handlers[] = {
 	COMMAND_REGISTRATION_DONE
 };
 
-static int vsllink_register_commands(struct command_context *cmd_ctx)
-{
-	return register_commands(cmd_ctx, NULL, vsllink_command_handlers);
-}
-
 struct jtag_interface vsllink_interface = {
 		.name = &quot;vsllink&quot;,
-		.register_commands = &amp;vsllink_register_commands,
+		.commands = vsllink_command_handlers,
+
 		.init = &amp;vsllink_init,
 		.quit = &amp;vsllink_quit,
 		.khz = &amp;vsllink_khz,

commit fc2d9f87615b7a5562cb9cd58fb95953e5d89818
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 21:06:28 2009 -0800

    vsllink: use register_commands()
    
    Use register_commands() with command registration array.

diff --git a/src/jtag/vsllink.c b/src/jtag/vsllink.c
index 3526198..8287e84 100644
--- a/src/jtag/vsllink.c
+++ b/src/jtag/vsllink.c
@@ -1856,28 +1856,43 @@ static void vsllink_debug_buffer(uint8_t *buffer, int length)
 }
 #endif // _DEBUG_USB_COMMS_ || _DEBUG_JTAG_IO_
 
+static const struct command_registration vsllink_command_handlers[] = {
+	{
+		.name = &quot;vsllink_usb_vid&quot;,
+		.handler = &amp;vsllink_handle_usb_vid_command,
+		.mode = COMMAND_CONFIG,
+	},
+	{
+		.name = &quot;vsllink_usb_pid&quot;,
+		.handler = &amp;vsllink_handle_usb_pid_command,
+		.mode = COMMAND_CONFIG,
+	},
+	{
+		.name = &quot;vsllink_usb_bulkin&quot;,
+		.handler = &amp;vsllink_handle_usb_bulkin_command,
+		.mode = COMMAND_CONFIG,
+	},
+	{
+		.name = &quot;vsllink_usb_bulkout&quot;,
+		.handler = &amp;vsllink_handle_usb_bulkout_command,
+		.mode = COMMAND_CONFIG,
+	},
+	{
+		.name = &quot;vsllink_usb_interface&quot;,
+		.handler = &amp;vsllink_handle_usb_interface_command,
+		.mode = COMMAND_CONFIG,
+	},
+	{
+		.name = &quot;vsllink_mode&quot;,
+		.handler = &amp;vsllink_handle_mode_command,
+		.mode = COMMAND_CONFIG,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int vsllink_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_usb_vid&quot;,
-			vsllink_handle_usb_vid_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_usb_pid&quot;,
-			vsllink_handle_usb_pid_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_usb_bulkin&quot;,
-			vsllink_handle_usb_bulkin_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_usb_bulkout&quot;,
-			vsllink_handle_usb_bulkout_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_usb_interface&quot;,
-			vsllink_handle_usb_interface_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;vsllink_mode&quot;,
-			vsllink_handle_mode_command, COMMAND_CONFIG,
-			NULL);
-
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, vsllink_command_handlers);
 }
 
 struct jtag_interface vsllink_interface = {

commit 355a67303206fb8954827ab7e413f1d882149c90
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 21:02:28 2009 -0800

    jtag: use register_commands()
    
    Use register commands with command registration array.

diff --git a/src/jtag/tcl.c b/src/jtag/tcl.c
index bd672b6..81dbdb5 100644
--- a/src/jtag/tcl.c
+++ b/src/jtag/tcl.c
@@ -1413,66 +1413,129 @@ COMMAND_HANDLER(handle_tms_sequence_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration jtag_command_handlers[] = {
+	{
+		.name = &quot;interface&quot;,
+		.handler = &amp;handle_interface_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;select a JTAG interface&quot;,
+		.usage = &quot;&lt;driver_name&gt;&quot;,
+	},
+	{
+		.name = &quot;interface_list&quot;,
+		.handler = &amp;handle_interface_list_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;list all built-in interfaces&quot;,
+	},
+	{
+		.name = &quot;jtag_khz&quot;,
+		.handler = &amp;handle_jtag_khz_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;set maximum jtag speed (if supported)&quot;,
+		.usage = &quot;&lt;khz:0=rtck&gt;&quot;,
+	},
+	{
+		.name = &quot;jtag_rclk&quot;,
+		.handler = &amp;handle_jtag_rclk_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;set JTAG speed to RCLK or use fallback speed&quot;,
+		.usage = &quot;&lt;fallback_speed_khz&gt;&quot;,
+	},
+	{
+		.name = &quot;reset_config&quot;,
+		.handler = &amp;handle_reset_config_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;configure JTAG reset behavior&quot;,
+		.usage = &quot;[none|trst_only|srst_only|trst_and_srst] &quot;
+			&quot;[srst_pulls_trst|trst_pulls_srst|combined|separate] &quot;
+			&quot;[srst_gates_jtag|srst_nogate] &quot;
+			&quot;[trst_push_pull|trst_open_drain] &quot;
+			&quot;[srst_push_pull|srst_open_drain]&quot;,
+	},
+	{
+		.name = &quot;jtag_nsrst_delay&quot;,
+		.handler = &amp;handle_jtag_nsrst_delay_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;delay after deasserting srst in ms&quot;,
+		.usage = &quot;&lt;ms&gt;&quot;,
+	},
+	{
+		.name = &quot;jtag_ntrst_delay&quot;,
+		.handler = &amp;handle_jtag_ntrst_delay_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;delay after deasserting trst in ms&quot;,
+		.usage = &quot;&lt;ms&gt;&quot;
+	},
+	{
+		.name = &quot;jtag_nsrst_assert_width&quot;,
+		.handler = &amp;handle_jtag_nsrst_assert_width_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;delay after asserting srst in ms&quot;,
+		.usage = &quot;&lt;ms&gt;&quot;
+	},
+	{
+		.name = &quot;jtag_ntrst_assert_width&quot;,
+		.handler = &amp;handle_jtag_ntrst_assert_width_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;delay after asserting trst in ms&quot;,
+		.usage = &quot;&lt;ms&gt;&quot;
+	},
+	{
+		.name = &quot;scan_chain&quot;,
+		.handler = &amp;handle_scan_chain_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;print current scan chain configuration&quot;,
+	},
+	{
+		.name = &quot;jtag_reset&quot;,
+		.handler = &amp;handle_jtag_reset_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;toggle reset lines&quot;,
+		.usage = &quot;&lt;trst&gt; &lt;srst&gt;&quot;,
+	},
+	{
+		.name = &quot;runtest&quot;,
+		.handler = &amp;handle_runtest_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;move to Run-Test/Idle, and execute &lt;num_cycles&gt;&quot;,
+		.usage = &quot;&lt;num_cycles&gt;&quot;
+	},
+	{
+		.name = &quot;irscan&quot;,
+		.handler = &amp;handle_irscan_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;execute IR scan&quot;,
+		.usage = &quot;&lt;device&gt; &lt;instr&gt; [dev2] [instr2] ...&quot;,
+	},
+	{
+		.name = &quot;verify_ircapture&quot;,
+		.handler = &amp;handle_verify_ircapture_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;verify value captured during Capture-IR&quot;,
+		.usage = &quot;&lt;enable | disable&gt;&quot;,
+	},
+	{
+		.name = &quot;verify_jtag&quot;,
+		.handler = &amp;handle_verify_jtag_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;verify value capture&quot;,
+		.usage = &quot;&lt;enable | disable&gt;&quot;,
+	},
+	{
+		.name = &quot;tms_sequence&quot;,
+		.handler = &amp;handle_tms_sequence_command,
+		.mode = COMMAND_ANY,
+		.help = &quot;choose short(default) or long tms_sequence&quot;,
+		.usage = &quot;&lt;short | long&gt;&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 int jtag_register_commands(struct command_context *cmd_ctx)
 {
 	register_jim(cmd_ctx, &quot;jtag&quot;, jim_jtag_command,
 			&quot;perform jtag tap actions&quot;);
 
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;interface&quot;,
-			handle_interface_command, COMMAND_CONFIG,
-			&quot;try to configure interface&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;interface_list&quot;,
-			&amp;handle_interface_list_command, COMMAND_ANY,
-			&quot;list all built-in interfaces&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_khz&quot;,
-			handle_jtag_khz_command, COMMAND_ANY,
-			&quot;set maximum jtag speed (if supported); &quot;
-			&quot;parameter is maximum khz, or 0 for adaptive clocking (RTCK).&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_rclk&quot;,
-			handle_jtag_rclk_command, COMMAND_ANY,
-			&quot;fallback_speed_khz - set JTAG speed to RCLK or use fallback speed&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;reset_config&quot;,
-			handle_reset_config_command, COMMAND_ANY,
-			&quot;reset_config &quot;
-			&quot;[none|trst_only|srst_only|trst_and_srst] &quot;
-			&quot;[srst_pulls_trst|trst_pulls_srst|combined|separate] &quot;
-			&quot;[srst_gates_jtag|srst_nogate] &quot;
-			&quot;[trst_push_pull|trst_open_drain] &quot;
-			&quot;[srst_push_pull|srst_open_drain]&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_nsrst_delay&quot;,
-			handle_jtag_nsrst_delay_command, COMMAND_ANY,
-			&quot;jtag_nsrst_delay &lt;ms&gt; &quot;
-			&quot;- delay after deasserting srst in ms&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_ntrst_delay&quot;,
-			handle_jtag_ntrst_delay_command, COMMAND_ANY,
-			&quot;jtag_ntrst_delay &lt;ms&gt; &quot;
-			&quot;- delay after deasserting trst in ms&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_nsrst_assert_width&quot;,
-			handle_jtag_nsrst_assert_width_command, COMMAND_ANY,
-			&quot;jtag_nsrst_assert_width &lt;ms&gt; &quot;
-			&quot;- delay after asserting srst in ms&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_ntrst_assert_width&quot;,
-			handle_jtag_ntrst_assert_width_command, COMMAND_ANY,
-			&quot;jtag_ntrst_assert_width &lt;ms&gt; &quot;
-			&quot;- delay after asserting trst in ms&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;scan_chain&quot;,
-			handle_scan_chain_command, COMMAND_EXEC,
-			&quot;print current scan chain configuration&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jtag_reset&quot;,
-			handle_jtag_reset_command, COMMAND_EXEC,
-			&quot;toggle reset lines &lt;trst&gt; &lt;srst&gt;&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;runtest&quot;,
-			handle_runtest_command, COMMAND_EXEC,
-			&quot;move to Run-Test/Idle, and execute &lt;num_cycles&gt;&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;irscan&quot;,
-			handle_irscan_command, COMMAND_EXEC,
-			&quot;execute IR scan &lt;device&gt; &lt;instr&gt; [dev2] [instr2] ...&quot;);
-
 	register_jim(cmd_ctx, &quot;drscan&quot;, Jim_Command_drscan,
 			&quot;execute DR scan &lt;device&gt; &quot;
 			&quot;&lt;num_bits&gt; &lt;value&gt; &lt;num_bits1&gt; &lt;value2&gt; ...&quot;);
@@ -1484,18 +1547,7 @@ int jtag_register_commands(struct command_context *cmd_ctx)
 			&quot;&lt;state1&gt;,&lt;state2&gt;,&lt;state3&gt;... &quot;
 			&quot;- move JTAG to state1 then to state2, state3, etc.&quot;);
 
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;verify_ircapture&quot;,
-			handle_verify_ircapture_command, COMMAND_ANY,
-			&quot;verify value captured during Capture-IR &lt;enable | disable&gt;&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;verify_jtag&quot;,
-			handle_verify_jtag_command, COMMAND_ANY,
-			&quot;verify value capture &lt;enable | disable&gt;&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;tms_sequence&quot;,
-			handle_tms_sequence_command, COMMAND_ANY,
-			&quot;choose short(default) or long tms_sequence &lt;short | long&gt;&quot;);
-
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, jtag_command_handlers);
 }
 
 

commit 9a31d66b3ff4b877d1f1125d24cbf127234f153a
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 21:00:23 2009 -0800

    presto: use register_commands()
    
    Use register_commands() with command registration array.

diff --git a/src/jtag/presto.c b/src/jtag/presto.c
index f22bd9e..dc40750 100644
--- a/src/jtag/presto.c
+++ b/src/jtag/presto.c
@@ -739,11 +739,20 @@ COMMAND_HANDLER(presto_handle_serial_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration presto_command_handlers[] = {
+	{
+		.name = &quot;presto_serial&quot;,
+		.handler = &amp;presto_handle_serial_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;configure serial port&quot;,
+		.usage = &quot;&lt;devname&gt;&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int presto_jtag_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;presto_serial&quot;, presto_handle_serial_command,
-		COMMAND_CONFIG, NULL);
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, presto_command_handlers);
 }
 
 static int presto_jtag_init(void)

commit 339e08baa5d000b1efe8c85ddd516d0b967992b2
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 20:17:52 2009 -0800

    parport: use register_commands()
    
    Use register_commands() with a command registration array.

diff --git a/src/jtag/parport.c b/src/jtag/parport.c
index 4b4df09..abf0d29 100644
--- a/src/jtag/parport.c
+++ b/src/jtag/parport.c
@@ -482,28 +482,45 @@ COMMAND_HANDLER(parport_handle_parport_toggling_time_command)
 	return ERROR_OK;
 }
 
-static int parport_register_commands(struct command_context *cmd_ctx)
-{
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_port&quot;,
-			parport_handle_parport_port_command, COMMAND_CONFIG,
-			&quot;either the address of the I/O port &quot;
-			&quot;or the number of the '/dev/parport' device&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_cable&quot;,
-			parport_handle_parport_cable_command, COMMAND_CONFIG,
-			&quot;the layout of the parallel port cable &quot;
-			&quot;used to connect to the target&quot;);
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_write_on_exit&quot;,
-			parport_handle_write_on_exit_command, COMMAND_CONFIG,
-			&quot;configure the parallel driver to write &quot;
-			&quot;a known value to the parallel interface&quot;);
+static const struct command_registration parport_command_handlers[] = {
+	{
+		.name = &quot;parport_port&quot;,
+		.handler = &amp;parport_handle_parport_port_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;either the address of the I/O port &quot;
+			&quot;or the number of the '/dev/parport' device&quot;,
+		.usage = &quot;[&lt;port|devname&gt;]&quot;,
+	},
+	{
+		.name = &quot;parport_cable&quot;,
+		.handler = &amp;parport_handle_parport_cable_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;the layout of the parallel port cable &quot;
+			&quot;used to connect to the target&quot;,
+		.usage = &quot;[&lt;layout&gt;]&quot;,
+	},
+	{
+		.name = &quot;parport_write_on_exit&quot;,
+		.handler = &amp;parport_handle_write_on_exit_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;configure the parallel driver to write &quot;
+			&quot;a known value to the parallel interface&quot;,
+		.usage = &quot;[&lt;on|off&gt;]&quot;,
+	},
+	{
+		.name = &quot;parport_toggling_time&quot;,
+		.handler = &amp;parport_handle_parport_toggling_time_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;time &lt;ns&gt; it takes for the hardware to toggle TCK&quot;,
+		.usage = &quot;[&lt;ns&gt;]&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
 
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_toggling_time&quot;,
-			parport_handle_parport_toggling_time_command, COMMAND_ANY,
-			&quot;time &lt;ns&gt; it takes for the hardware to toggle TCK&quot;);
 
-	return ERROR_OK;
+static int parport_register_commands(struct command_context *cmd_ctx)
+{
+	return register_commands(cmd_ctx, NULL, parport_command_handlers);
 }
 
 struct jtag_interface parport_interface = {

commit b1d034bf2f665cfa5633c8c6b46570d7ce6064a4
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 20:12:21 2009 -0800

    jlink: use register_commands()
    
    Use register_commands() with command registration array.

diff --git a/src/jtag/jlink.c b/src/jtag/jlink.c
index 1ca9c39..24fb0e8 100644
--- a/src/jtag/jlink.c
+++ b/src/jtag/jlink.c
@@ -627,16 +627,26 @@ COMMAND_HANDLER(jlink_handle_jlink_hw_jtag_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration jlink_command_handlers[] = {
+	{
+		.name = &quot;jlink_info&quot;,
+		.handler = &amp;jlink_handle_jlink_info_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;show jlink info&quot;,
+	},
+	{
+		.name = &quot;jlink_hw_jtag&quot;,
+		.handler = &amp;jlink_handle_jlink_hw_jtag_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;access J-Link HW JTAG command version&quot;,
+		.usage = &quot;[2|3]&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int jlink_register_commands(struct command_context *cmd_ctx)
 {
-
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jlink_info&quot;,
-		&amp;jlink_handle_jlink_info_command, COMMAND_EXEC,
-		&quot;query jlink info&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;jlink_hw_jtag&quot;,
-		&amp;jlink_handle_jlink_hw_jtag_command, COMMAND_EXEC,
-		&quot;set/get jlink hw jtag command version [2 | 3]&quot;);
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, jlink_command_handlers);
 }
 
 struct jtag_interface jlink_interface = {

commit 779bdbe797b9c25b9f297b4f29500e847baf28c3
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 20:11:58 2009 -0800

    gw16012: use register_commands()
    
    Use register_commands() with command registration array.

diff --git a/src/jtag/gw16012.c b/src/jtag/gw16012.c
index bc0e472..0e495f9 100644
--- a/src/jtag/gw16012.c
+++ b/src/jtag/gw16012.c
@@ -562,13 +562,20 @@ COMMAND_HANDLER(gw16012_handle_parport_port_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration gw16012_command_handlers[] = {
+	{
+		.name = &quot;parport_port&quot;,
+		.handler = &amp;gw16012_handle_parport_port_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;configure the parallel port to use&quot;,
+		.usage = &quot;&lt;port_num&gt;&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int gw16012_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_port&quot;,
-			gw16012_handle_parport_port_command, COMMAND_CONFIG,
-			NULL);
-
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, gw16012_command_handlers);
 }
 
 struct jtag_interface gw16012_interface = {

commit 3ab599a7e43af7350b380e7ffcc5fdcd75b42a65
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 20:06:50 2009 -0800

    ft2232: use register_commands()
    
    Use register_commands() with a command registration array.

diff --git a/src/jtag/ft2232.c b/src/jtag/ft2232.c
index e560b22..d145505 100644
--- a/src/jtag/ft2232.c
+++ b/src/jtag/ft2232.c
@@ -3969,26 +3969,49 @@ static void ktlink_blink(void)
 	buffer_write(high_direction);
 }
 
+static const struct command_registration ft2232_command_handlers[] = {
+	{
+		.name = &quot;ft2232_device_desc&quot;,
+		.handler = &amp;ft2232_handle_device_desc_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;set the USB device description of the FTDI FT2232 device&quot;,
+		.usage = &quot;&lt;description&gt;&quot;,
+	},
+	{
+		.name = &quot;ft2232_serial&quot;,
+		.handler = &amp;ft2232_handle_serial_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;set the serial number of the FTDI FT2232 device&quot;,
+		.usage = &quot;&lt;serial#&gt;&quot;,
+	},
+	{
+		.name = &quot;ft2232_layout&quot;,
+		.handler = &amp;ft2232_handle_layout_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;set the layout of the FT2232 GPIO signals used &quot;
+			&quot;to control output-enables and reset signals&quot;,
+		.usage = &quot;&lt;layout&gt;&quot;,
+	},
+	{
+		.name = &quot;ft2232_vid_pid&quot;,
+		.handler = &amp;ft2232_handle_vid_pid_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;the vendor ID and product ID of the FTDI FT2232 device&quot;,
+		.usage = &quot;&lt;vid&gt; &lt;pid&gt; [...]&quot;,
+	},
+	{
+		.name = &quot;ft2232_latency&quot;,
+		.handler = &amp;ft2232_handle_latency_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;set the FT2232 latency timer to a new value&quot;,
+		.usage = &quot;&lt;vid&gt; &lt;pid&gt; [...]&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int ft2232_register_commands(struct command_context* cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;ft2232_device_desc&quot;,
-			ft2232_handle_device_desc_command, COMMAND_CONFIG,
-			&quot;the USB device description of the FTDI FT2232 device&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;ft2232_serial&quot;,
-			ft2232_handle_serial_command, COMMAND_CONFIG,
-			&quot;the serial number of the FTDI FT2232 device&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;ft2232_layout&quot;,
-			ft2232_handle_layout_command, COMMAND_CONFIG,
-			&quot;the layout of the FT2232 GPIO signals used &quot;
-			&quot;to control output-enables and reset signals&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;ft2232_vid_pid&quot;,
-			ft2232_handle_vid_pid_command, COMMAND_CONFIG,
-			&quot;the vendor ID and product ID of the FTDI FT2232 device&quot;);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;ft2232_latency&quot;,
-			ft2232_handle_latency_command, COMMAND_CONFIG,
-			&quot;set the FT2232 latency timer to a new value&quot;);
-
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, ft2232_command_handlers);
 }
 
 

commit 30be874de8ee9d8269ce3441c92a15b96c68a398
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 19:58:07 2009 -0800

    at91rm9200: use register_commands()
    
    Use register_commands() with command registration array.
    ---
    This module was broken by previous changes, but no one has complained.
    Are there still users for this modules?

diff --git a/src/jtag/at91rm9200.c b/src/jtag/at91rm9200.c
index 024dd6d..ff9f7a4 100644
--- a/src/jtag/at91rm9200.c
+++ b/src/jtag/at91rm9200.c
@@ -200,11 +200,18 @@ static int at91rm9200_handle_device_command(struct command_context *cmd_ctx, cha
 	return ERROR_OK;
 }
 
+static const struct command_registration at91rm9200_command_handlers[] = {
+	{
+		.name = &quot;at91rm9200_device&quot;,
+		.handler = &amp;at91rm9200_handle_device_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;query armjtagew info&quot;,
+	},
+};
+
 static int at91rm9200_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;at91rm9200_device&quot;, at91rm9200_handle_device_command,
-		COMMAND_CONFIG, NULL);
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, at91rm9200_command_handlers);
 }
 
 static int at91rm9200_init(void)

commit 0af32bb9381c9fe3f6be425c7fedfc88d4590178
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 19:56:02 2009 -0800

    arm-jtag-ew: use register_commands()
    
    Uses register_commands() with command registration array.

diff --git a/src/jtag/arm-jtag-ew.c b/src/jtag/arm-jtag-ew.c
index f239371..ef2b04f 100644
--- a/src/jtag/arm-jtag-ew.c
+++ b/src/jtag/arm-jtag-ew.c
@@ -502,12 +502,19 @@ COMMAND_HANDLER(armjtagew_handle_armjtagew_info_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration armjtagew_command_handlers[] = {
+	{
+		.name = &quot;armjtagew_info&quot;,
+		.handler = &amp;armjtagew_handle_armjtagew_info_command,
+		.mode = COMMAND_EXEC,
+		.help = &quot;query armjtagew info&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int armjtagew_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;armjtagew_info&quot;,
-			&amp;armjtagew_handle_armjtagew_info_command, COMMAND_EXEC,
-			&quot;query armjtagew info&quot;);
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, armjtagew_command_handlers);
 }
 
 struct jtag_interface armjtagew_interface = {

commit 48429dcfad4c05dc03fd94484da1078b30afd4f3
Author: Zachary T Welch &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">zw at superlucidity.net</A>&gt;
Date:   Fri Nov 20 19:53:28 2009 -0800

    amt_jtagaccel: use register_commands()
    
    Use register_commands() with command_registration array.

diff --git a/src/jtag/amt_jtagaccel.c b/src/jtag/amt_jtagaccel.c
index 0aabdc9..c3f3279 100644
--- a/src/jtag/amt_jtagaccel.c
+++ b/src/jtag/amt_jtagaccel.c
@@ -540,16 +540,27 @@ COMMAND_HANDLER(amt_jtagaccel_handle_rtck_command)
 	return ERROR_OK;
 }
 
+static const struct command_registration amtjtagaccel_command_handlers[] = {
+	{
+		.name = &quot;parport_port&quot;,
+		.handler = &amp;amt_jtagaccel_handle_parport_port_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;configure the parallel port to use&quot;,
+		.usage = &quot;&lt;port_num&gt;&quot;,
+	},
+	{
+		.name = &quot;parport_port&quot;,
+		.handler = &amp;amt_jtagaccel_handle_rtck_command,
+		.mode = COMMAND_CONFIG,
+		.help = &quot;enable RTCK&quot;,
+		.usage = &quot;&lt;enable|disable&gt;&quot;,
+	},
+	COMMAND_REGISTRATION_DONE
+};
+
 static int amt_jtagaccel_register_commands(struct command_context *cmd_ctx)
 {
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;parport_port&quot;,
-			amt_jtagaccel_handle_parport_port_command, COMMAND_CONFIG,
-			NULL);
-	COMMAND_REGISTER(cmd_ctx, NULL, &quot;rtck&quot;,
-			amt_jtagaccel_handle_rtck_command, COMMAND_CONFIG,
-			NULL);
-
-	return ERROR_OK;
+	return register_commands(cmd_ctx, NULL, amtjtagaccel_command_handlers);
 }
 
 struct jtag_interface amt_jtagaccel_interface = {

-----------------------------------------------------------------------

Summary of changes:
 src/jtag/amt_jtagaccel.c |   30 +++++---
 src/jtag/arm-jtag-ew.c   |   21 +++--
 src/jtag/at91rm9200.c    |   13 +++-
 src/jtag/dummy.c         |    6 --
 src/jtag/ft2232.c        |   63 ++++++++++------
 src/jtag/gw16012.c       |   20 +++--
 src/jtag/interface.h     |    4 +-
 src/jtag/jlink.c         |   32 +++++---
 src/jtag/parport.c       |   73 +++++++++++-------
 src/jtag/presto.c        |   21 ++++--
 src/jtag/rlink/rlink.c   |   44 -----------
 src/jtag/tcl.c           |  191 +++++++++++++++++++++++++++++-----------------
 src/jtag/vsllink.c       |   59 +++++++++------
 13 files changed, 328 insertions(+), 249 deletions(-)


hooks/post-receive
-- 
Main OpenOCD repository

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001859.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-584-ge2f23c5
</A></li>
	<LI>Next message: <A HREF="001861.html">[openocd-svn] Main OpenOCD repository branch, master,	updated. v0.3.0-615-g90d09e3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1860">[ date ]</a>
              <a href="thread.html#1860">[ thread ]</a>
              <a href="subject.html#1860">[ subject ]</a>
              <a href="author.html#1860">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
