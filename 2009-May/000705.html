<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Openocd-svn] r1921 - trunk/doc/manual/primer
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/openocd-svn/2009-May/index.html" >
   <LINK REL="made" HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r1921%20-%20trunk/doc/manual/primer&In-Reply-To=%3C200905271027.n4RARZqk010326%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000704.html">
   <LINK REL="Next"  HREF="000706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Openocd-svn] r1921 - trunk/doc/manual/primer</H1>
    <B>zwelch at mail.berlios.de</B> 
    <A HREF="mailto:openocd-svn%40lists.berlios.de?Subject=Re%3A%20%5BOpenocd-svn%5D%20r1921%20-%20trunk/doc/manual/primer&In-Reply-To=%3C200905271027.n4RARZqk010326%40sheep.berlios.de%3E"
       TITLE="[Openocd-svn] r1921 - trunk/doc/manual/primer">zwelch at mail.berlios.de
       </A><BR>
    <I>Wed May 27 12:27:35 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000704.html">[Openocd-svn] r1920 - in trunk/src: . helper server
</A></li>
        <LI>Next message: <A HREF="000706.html">[Openocd-svn] r1922 - trunk/doc/manual/primer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#705">[ date ]</a>
              <a href="thread.html#705">[ thread ]</a>
              <a href="subject.html#705">[ subject ]</a>
              <a href="author.html#705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: zwelch
Date: 2009-05-27 12:27:32 +0200 (Wed, 27 May 2009)
New Revision: 1921

Added:
   trunk/doc/manual/primer/autotools.txt
Log:
Add draft of Autotools Primer to The Manual.

Added: trunk/doc/manual/primer/autotools.txt
===================================================================
--- trunk/doc/manual/primer/autotools.txt	2009-05-27 07:49:58 UTC (rev 1920)
+++ trunk/doc/manual/primer/autotools.txt	2009-05-27 10:27:32 UTC (rev 1921)
@@ -0,0 +1,167 @@
+/** @page primerautotools OpenOCD Autotools Primer
+
+This page provides an overview to OpenOCD's use of the GNU autotool suite:
+- @ref primerautoconf
+- @ref primerautomake
+- @ref primerlibtool
+
+Most developers do not need to concern themselves with these tools, as
+the @ref primerbootstrap script runs these tools in the required sequence.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at section</A> primerbootstrap Autotools Bootstrap
+
+The @c bootstrap script should be used by developers to run the
+autotools in the correct sequence.
+
+When run after a fresh checkout, this script generates the build files
+required to compile the project, producing the project configure script.
+After running @c configure, the @ref primermaintainermode settings will
+handle most situations that require running these tools again.  In some
+cases, a fresh bootstrap may be still required.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primerbootstrapcures Problems Solved By Bootstrap
+
+For example, the build system can fail in unexpected ways after running
+&lt;code&gt;svn update&lt;/code&gt;.  Here, the &lt;code&gt;make maintainer-clean&lt;/code&gt;
+should be used to remove all of the files generated by the @c bootstrap
+script and subsequent build processes.
+
+In this particular case, one may also need to remove stray files by hand
+after running this command to ensure everything is rebuilt properly.
+This step should be necessary only if the @c maintainer-clean was run
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at b</A> after altering the build system files with Subversion. If it is run
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at b</A> before any updates, the build system should never leave artifacts
+in the tree.
+
+Without such precautions, changes can be introduced that leave the tree
+timestamps in an inconsistent state, producing strange compile errors
+that are resolve after such diligence.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primermaintainerclean Autotools Cleaning
+
+Normally, all files generated by the bootstrap script, configure
+process, and build system should be removed after running &lt;code&gt;make
+maintainer-clean&lt;/code&gt;.  Automatically generated files that remain
+after this should be listed in @c MAINTAINERCLEANFILES,
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at c</A> DISTCLEANFILES, or @c CLEANFILES, depending on which stage of the
+build process they are produced.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at section</A> primerautoconf Autoconf Configuration Script
+
+The @c autoconf program generates the @c configure script from
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at c</A> configure.in, using serious Perl voodoo.  The resulting script is
+included in the project distribution packages and run by users to
+configure the build process for their system.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primermaintainermode Maintainer Mode
+
+After a fresh checkout, @c bootstrap, and a simple @c configure, you may
+experience errors when running @c make that some files cannot be found
+(e.g. @c version.texi), and a second @c make will &quot;mysteriously&quot; solve
+the problems.  The isssue is well-known and expected, if unfortunate.
+
+The OpenOCD project requires that all developers building from  the
+Subversion repository use the @c --enable-maintainer-mode option when
+running the @c configure script.  This option ensures that certain files
+are created during the build process that would normally be packaged in
+the distribution tarball.  The @c bootstrap script will remind you of
+this requirement when it runs.
+
+In addition to solving these problems, this option enables Makefile
+rules (provided by automake) that allow the normal @c make process to
+rebuild the autotools outputs, included the automake-generated Makefiles
+themselves.  This avoids the heavy-handed approach of running the
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at c</A> bootstrap script after changing one of these files.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at section</A> primerautomake Automake Makefiles
+
+The @c automake program generates @c Makefile.in files (from @c
+Makefile.am files).  These files are later processed by the configure
+script produced by @c autoconf.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primerautomakenewfiles Creating Makefile.am Files
+
+This section shows how to add a @c Makefile.am in a new directory (or
+one that lacks one).
+-# The new directory must be listed in the @c SUBDIRS variable in the
+parent directory's Makefile.am:
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at code</A>
+$ echo 'SUBDIRS += directory' &gt;&gt;../Makefile.am
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at endcode</A>
+-# Create an bare-bones Makefile.am file in directory that needs it:
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at code</A>
+$ echo &quot;MAINTAINERCLEANFILES = Makefile.in&quot; &gt;Makefile.am
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at endcode</A>
+-# The @c configure.in script must be updated, so it generates the required
+Makefile when the @a configure script is run by the user:
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at verbatim</A>
+AC_OUTPUT([
+		...
+		path/to/new/Makefile
+	])
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at endverbatim</A>
+
+Note: these instructions are @b not meant to be used literally, rather
+they are shown for demonstration purposes.
+
+The default MAINTAINERCLEANFILES rule ensures that the
+automake-generated @c Makefile.in file will be removed when developers
+run &lt;code&gt;make maintainer-clean&lt;/code&gt;.  Additional rules may be added
+after this; however, the project should bootstrap and tear down cleanly
+after taking these minimal steps, with the new directory being visited
+during the @c make sequence.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primerautomaketweaks Updating Makefile.am Files
+
+Adding, removing, and renaming files from the project tree usually
+requires updating the autotools inputs. This section will help describe
+how to do this as questions arise.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at section</A> primerlibtool Libtool and Libraries
+
+The @c libtool program provides the means of generating libraries in a
+portable and painless manner (relatively speaking).
+
+This section will contain an answer to &quot;what does libtool give OpenOCD?&quot;
+and &quot;what do developers need to consider in new code?&quot;
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at section</A> primerautotoolsmation Autotools Automation
+
+This section outlines three ways the autotools provides automation to
+assist with testing and distribution:
+- @ref primerautocheck -- automatic unit and smoke tests
+- @ref primerautodistcheck -- automatic distribution and packaging tests
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primerautocheck make check
+
+The &lt;code&gt;make check&lt;/code&gt; command will run the OpenOCD test suite,
+once it has been integrated as such.  This section will contain
+information about how to extend the testing build system components to
+implement new checks.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/openocd-svn">+ at subsection</A> primerautodistcheck make distcheck
+
+The &lt;code&gt;make distcheck&lt;/code&gt; command produces an archive of the
+project deliverables (using &lt;code&gt;make dist&lt;/code&gt;) and verifies its
+integrity for distribution by attemptng to use the package in the same
+manner as a user.  
+
+These checks includes the following steps:
+-# Unpack the project archive into its expected directory.
+-# Configure and build the project in a temporary out-of-tree directory.
+-# Run &lt;code&gt;make check&lt;/code&gt; to ensure the distributed code passes all tests.
+-# Run &lt;code&gt;make install&lt;/code&gt; into a temporary installation directory.
+-# Check that &lt;code&gt;make uninstall&lt;/code&gt; removes all files that were installed.
+-# Check that &lt;code&gt;make distclean&lt;/code&gt; removes all files created
+during all other steps (except the first).
+
+If all of these steps complete successfully, the @c make process will
+output a friendly message indicating the archive is ready to be
+distributed.
+
+ */
+/** @file
+
+This file contains the @ref primerautotools page.
+
+ */


Property changes on: trunk/doc/manual/primer/autotools.txt
___________________________________________________________________
Name: svn:eol-style
   + native


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000704.html">[Openocd-svn] r1920 - in trunk/src: . helper server
</A></li>
	<LI>Next message: <A HREF="000706.html">[Openocd-svn] r1922 - trunk/doc/manual/primer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#705">[ date ]</a>
              <a href="thread.html#705">[ thread ]</a>
              <a href="subject.html#705">[ subject ]</a>
              <a href="author.html#705">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/openocd-svn">More information about the openocd-svn
mailing list</a><br>
</body></html>
